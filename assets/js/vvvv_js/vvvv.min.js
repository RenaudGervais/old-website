var VVVV_ENV="production";$.ajaxPrefilter(function(b,a,h){if("script"==b.dataType||"script"==a.dataType)b.cache=!0});window.console||(window.console={log:function(b){}});
VVVV={Nodes:{},PinTypes:{},Types:{},NodeLibrary:{},NodeNames:[],Patches:{},Editors:{},onNotImplemented:function(b){console.log("Warning: "+b+" is not implemented.")},loadCounter:0,loadScript:function(b,a){var h=document.getElementsByTagName("head")[0],e=document.createElement("script");e.async=!1;e.src=VVVV.Root+"/"+b;a&&e.addEventListener("load",a);VVVV.loadCounter++;h.appendChild(e)},init:function(b,a,h){function e(){var d=new VVVV.Core.Patch("");_(VVVV.Nodes).each(function(c){var g=new c(0,d);
"development"==VVVV_ENV&&console.log("Registering "+g.nodename);VVVV.NodeLibrary[g.nodename.toLowerCase()]=c;VVVV.NodeNames.push(g.nodename)});"development"==VVVV_ENV&&console.log("done ...");VVVV.MainLoops=[];$("script[language='VVVV']").each(function(c){var d=new VVVV.Core.Patch($(this).attr("src"),function(){var c=new VVVV.Core.MainLoop(this);VVVV.MainLoops.push(c)});VVVV.Patches[c]=d});"function"===typeof h&&h.call()}VVVV.Root=b||"./";"development"==VVVV_ENV&&console.log("loading vvvv.js ...");
if("development"==VVVV_ENV){document.getElementsByTagName("head");var f=function(d){d.target.removeEventListener("load",f);0>=--VVVV.loadCounter&&e()};0==$("script[src*=thirdparty]").length&&VVVV.loadScript("thirdparty.js",f);0==$("script[src*=underscore]").length&&VVVV.loadScript("lib/underscore/underscore-min.js",f);0!=$('script[src*="d3.js"]').length||"full"!=a&&"vvvviewer"!=a||VVVV.loadScript("lib/d3-v3/d3.v3.min.js",f);0!=$("script[src*=glMatrix]").length||"full"!=a&&"run"!=a||VVVV.loadScript("lib/glMatrix-0.9.5.min.js",
f);if(0==$('script[src*="vvvv.core.js"]').length){VVVV.loadScript("core/vvvv.core.js",f);if("run"==a||"full"==a)VVVV.loadScript("mainloop/vvvv.mainloop.js",f),VVVV.loadScript("mainloop/vvvv.dominterface.js",f),VVVV.loadScript("nodes/vvvv.nodes.value.js",f),VVVV.loadScript("nodes/vvvv.nodes.string.js",f),VVVV.loadScript("nodes/vvvv.nodes.boolean.js",f),VVVV.loadScript("nodes/vvvv.nodes.color.js",f),VVVV.loadScript("nodes/vvvv.nodes.spreads.js",f),VVVV.loadScript("nodes/vvvv.nodes.spectral.js",f),VVVV.loadScript("nodes/vvvv.nodes.animation.js",
f),VVVV.loadScript("nodes/vvvv.nodes.network.js",f),VVVV.loadScript("nodes/vvvv.nodes.system.js",f),VVVV.loadScript("nodes/vvvv.nodes.canvas.js",f),VVVV.loadScript("nodes/vvvv.nodes.html5.js",f),VVVV.loadScript("nodes/vvvv.nodes.transform.js",f),VVVV.loadScript("nodes/vvvv.nodes.vectors.js",f),VVVV.loadScript("nodes/vvvv.nodes.webgl.js",f),VVVV.loadScript("nodes/vvvv.nodes.complex.js",f),VVVV.loadScript("nodes/vvvv.nodes.enumerations.js",f),VVVV.loadScript("nodes/vvvv.nodes.2d.js",f),VVVV.loadScript("nodes/vvvv.nodes.3d.js",
f),VVVV.loadScript("nodes/vvvv.nodes.node.js",f),VVVV.loadScript("nodes/vvvv.nodes.astronomy.js",f),VVVV.loadScript("nodes/vvvv.nodes.xml.js",f);VVVV.loadScript("editors/vvvv.editors.browser_editor.js",f)}}"production"==VVVV_ENV&&e()}};VVVV.MousePositions={_all:{x:0,y:0,wheel:0,lb:0,mb:0,rb:0}};var PinDirection={Input:0,Output:1,Configuration:2};VVVV.PinTypes.Generic={typeName:"Generic",reset_on_disconnect:!0,defaultValue:function(){return"0"}};VVVV.PinTypes.Value={typeName:"Value",reset_on_disconnect:!1,defaultValue:function(){return 0},primitive:!0};VVVV.PinTypes.String={typeName:"String",reset_on_disconnect:!1,defaultValue:function(){return""},primitive:!0};
VVVV.PinTypes.Enum={typeName:"Enum",reset_on_disconnect:!1,defaultValue:function(){return""},primitive:!0};
VVVV.Helpers={translateOperators:function(b){b=b.replace("Add","+");b=b.replace("Subtract","-");b=b.replace("Multiply","*");b=b.replace("Divide","/");b=b.replace("EQ","=");b=b.replace("GT",">");b=b.replace("GTE",">=");b=b.replace("LT","<");return b=b.replace("LTE","<=")},prepareFilePath:function(b,a){b=b.replace(/\\/g,"/");return b.match(/^%VVVV%/)?b.replace("%VVVV%",VVVV.Root):b.match(/^%PAGE%/)?b.replace("%PAGE%",location.pathname):b.match(/^(\/|.+:\/\/)/)?b:a?a.getAbsolutePath()+b:b},dynamicPins:function(b,
a,h,e){for(var f=a.length;f<h;f++)a[f]=e.call(b,f);for(f=h;f<a.length;f++)b.removeInputPin(a[f].pinname);a.length=h;b.parentPatch.afterUpdate()}};
VVVV.Core={Pin:function(b,a,h,e,f){this.direction=a;this.pinname=b;this.links=[];this.values=[];this.node=e;this.changed=!0;this.reset_on_disconnect=this.active=!1;this.masterPin=this.slavePin=void 0;this.connectionChangedHandlers={};this.enumOptions=[];this.getValue=function(d,c){if(!c||1==c)return this.values[d%this.values.length];for(var g=[],f=0;f<c;f++)g.push(this.values[(d*c+f)%this.values.length]);return g};this.setValue=function(d,c,g){g=g||!1;this.values[d]=c;this.changed=!0;this.node.dirty=
!0;if(this.direction==PinDirection.Output)for(var f=this.links.length,e=0;e<f;e++)this.links[e].toPin.setValue(d,c);this.slavePin&&!g&&this.slavePin.setValue(d,c);this.direction==PinDirection.Input&&(this.masterPin&&!this.isConnected())&&this.masterPin.setValue(d,c,!0);this.node.isIOBox&&"Descriptive Name"==this.pinname&&(this.node.parentPatch.domInterface?this.node.parentPatch.domInterface.connect(this.node):this.node.parentPatch.parentPatch&&this.node.registerInterfacePin())};this.markPinAsChanged=
function(){this.changed=!0;this.node.dirty=!0;if(this.direction==PinDirection.Output)for(var d=this.links.length,c=0;c<d;c++)this.links[c].toPin.markPinAsChanged();this.slavePin&&this.slavePin.markPinAsChanged()};this.pinIsChanged=function(){var d=this.changed;this.changed=!1;return d};this.isConnected=function(){return 0<this.links.length||this.masterPin&&this.masterPin.isConnected()};this.getSliceCount=function(){return this.values.length};this.setSliceCount=function(d){if(this.values.length!=d){this.values.length=
d;this.changed=!0;this.node.dirty=!0;if(this.direction==PinDirection.Output)for(var c=this.links.length,g=0;g<c;g++)this.links[g].toPin.setSliceCount(d);this.slavePin&&this.slavePin.setSliceCount(d)}};this.setType=function(d){if(d.typeName!=this.typeName){var c=this;delete this.connectionChangedHandlers.nodepin;delete this.connectionChangedHandlers.webglresource;_(d.connectionChangedHandlers).each(function(g,f){c.connectionChangedHandlers[f]=d.connectionChangedHandlers[f]});this.typeName=d.typeName;
this.defaultValue=d.defaultValue;this.direction==PinDirection.Input&&this.defaultValue&&(this.setValue(0,this.defaultValue()),this.setSliceCount(1));void 0!=d.reset_on_disconnect&&(this.reset_on_disconnect=d.reset_on_disconnect)}};void 0==f&&(f=VVVV.PinTypes.Generic,this.unvalidated=!0);this.setType(f);h&&0<h.length&&(this.values=h.slice(0));this.reset=function(){this.defaultValue?(this.setValue(0,this.defaultValue()),this.setSliceCount(1)):this.values=h.slice(0);this.markPinAsChanged()};this.connectionChanged=
function(){var d=this;_(this.connectionChangedHandlers).each(function(c){d.f=c;d.f()})}},Node:function(b,a,h){this.nodename=a;this.id=b;this.height=this.width=this.y=this.x=0;this.isShader=this.isIOBox=!1;this.resourcesPending=0;this.auto_nil=!0;this.setupObject=function(){this.inputPins={};this.outputPins={};this.invisiblePins={};this.defaultPinValues={}};this.setupObject();this.delays_output=this.auto_evaluate=!1;this.dirty=!0;(this.parentPatch=h)&&(this.parentPatch.nodeMap[b]=this);this.addDefault=
function(e,f){this.defaultPinValues[e]=f};this.addInputPin=function(e,f,d){f=new VVVV.Core.Pin(e,PinDirection.Input,f,this,d);this.inputPins[e]=f;this.parentPatch&&(this.parentPatch.pinMap[this.id+"_in_"+e]=f);this.applyPinValuesFromXML(e);return f};this.addOutputPin=function(e,f,d){f=new VVVV.Core.Pin(e,PinDirection.Output,f,this,d);this.outputPins[e]=f;this.parentPatch&&(this.parentPatch.pinMap[this.id+"_out_"+e]=f);return f};this.removeInputPin=function(e){if(this.inputPins[e]){var f=this.inputPins[e].links[0];
f&&(f.fromPin.connectionChanged(),f.destroy());delete this.inputPins[e];this.dirty=!0}};this.removeOutputPin=function(e){if(this.outputPins[e]){for(var f=this.outputPins[e].links.length,d=0;d<f;d++){var c=this.outputPins[e].links[d];c.toPin.connectionChanged();c.destroy()}delete this.outputPins[e];this.dirty=!0}};this.addInvisiblePin=function(e,f,d){f=new VVVV.Core.Pin(e,PinDirection.Configuration,f,this,d);this.invisiblePins[e]=f;this.parentPatch.pinMap[this.id+"_inv_"+e]=f;void 0!=this.defaultPinValues[e]&&
(f.values=this.defaultPinValues[e]);return f};this.IOBoxType=function(){var e=/^IOBox \((.*)\)/.exec(this.nodename);return e&&1<e.length?e[1]:""};this.IOBoxInputPin=function(){switch(this.IOBoxType()){case "Value Advanced":return this.inputPins["Y Input Value"];case "String":return this.inputPins["Input String"];case "Color":return this.inputPins["Color Input"];case "Node":return this.inputPins["Input Node"]}};this.IOBoxOutputPin=function(){switch(this.IOBoxType()){case "Value Advanced":return this.outputPins["Y Output Value"];
case "String":return this.outputPins["Output String"];case "Color":return this.outputPins["Color Output"];case "Node":return this.outputPins["Output Node"]}};this.IOBoxRows=function(){return this.invisiblePins.Rows?this.invisiblePins.Rows.getValue(0):1};this.isComment=function(){return this.isIOBox&&0==_(this.outputPins).size()};this.label=function(){if(this.isIOBox)return this.IOBoxInputPin().getValue(0)?this.IOBoxInputPin().getValue(0).toString():"";if(this.isSubpatch)return"||"+this.nodename.match(/([^\/]+)\.v4p$/)[1];
var e=this.nodename.replace(/\s\(.+\)/,"");return e=VVVV.Helpers.translateOperators(e)};this.getWidth=function(){var e;e=100==this.width||0==this.width?this.isIOBox?60:Math.max(18,6*(this.label().length+2)):this.width/15;return e=Math.max(e,12*(_(this.inputPins).size()-1)+4)};this.getHeight=function(){return this.isIOBox&&100==this.height?18*this.IOBoxRows():100==this.height||this.isSubpatch?18:Math.max(18,this.height/15)};this.getUpstreamNodes=function(){var e=[];_(this.inputPins).each(function(f){0<
f.links.length&&e.push(f.links[0].fromPin.node)});return e};this.getDownstreamNodes=function(){var e=[];_(this.outputPins).each(function(f){for(var d=0;d<f.links.length;d++)e.push(f.links[d].toPin.node)});return e};this.findDownstreamNodes=function(e){var f=[];_(this.outputPins).each(function(d){for(var c=0;c<d.links.length;c++)d.links[c].toPin.node.nodename==e?f.push(d.links[c].toPin.node):f=d.links[c].toPin.slavePin?f.concat(d.links[c].toPin.slavePin.node.findDownstreamNodes(e)):d.links[c].toPin.node.isIOBox&&
d.links[c].toPin.node.IOBoxOutputPin().slavePin?f.concat(d.links[c].toPin.node.IOBoxOutputPin().slavePin.node.findDownstreamNodes(e)):f.concat(d.links[c].toPin.node.findDownstreamNodes(e))});return f};this.hasNilInputs=function(){var e=!1;_(this.inputPins).each(function(f){0==f.getSliceCount()&&(e=!0)});return e};this.getMaxInputSliceCount=function(){var e=0;_(this.inputPins).each(function(f){f.getSliceCount()>e&&(e=f.values.length)});return e};this.applyPinValuesFromXML=function(e){if(this.inputPins[e]){var f=
this.inputPins[e];e=this.defaultPinValues[e];if(void 0!=e&&(!f.reset_on_disconnect||1<e.length||""!=e[0])){for(var d=0;d<e.length;d++)f.values[d]!=e[d]&&f.setValue(d,e[d]);f.setSliceCount(e.length)}}};this.registerInterfacePin=function(){var e=this;if(this.isIOBox&&this.parentPatch.parentPatch&&""!=this.invisiblePins["Descriptive Name"].getValue(0)){var f=this.invisiblePins["Descriptive Name"].getValue(0);this.IOBoxInputPin().connectionChangedHandlers.subpatchpins=function(){if(0<this.links.length&&
this.masterPin){"development"==VVVV_ENV&&console.log("deleting "+f+" input pin because node has input connection...");for(var d=0;d<this.masterPin.links.length;d++)this.masterPin.links[d].destroy();e.parentPatch.removeInputPin(f);this.masterPin=void 0}0==e.IOBoxOutputPin().links.length&&(e.IOBoxOutputPin().slavePin?e.IOBoxOutputPin().slavePin.pinname!=f&&("development"==VVVV_ENV&&console.log("renaming "+e.IOBoxOutputPin().slavePin.pinname+" to "+f),e.parentPatch.outputPins[f]=e.parentPatch.outputPins[e.IOBoxOutputPin().slavePin.pinname],
e.parentPatch.removeOutputPin(e.IOBoxOutputPin().slavePin.pinname),e.IOBoxOutputPin().slavePin.pinname=f):("development"==VVVV_ENV&&console.log("interfacing output pin detected: "+f),d=e.parentPatch.outputPins[f],void 0==d&&(d=e.parentPatch.addOutputPin(f,e.IOBoxOutputPin().values)),d.setType(VVVV.PinTypes[e.IOBoxOutputPin().typeName]),e.IOBoxOutputPin().slavePin=d,d.masterPin=e.IOBoxOutputPin()));this.node.parentPatch.parentPatch.afterUpdate()};this.IOBoxInputPin().connectionChanged();this.IOBoxOutputPin().connectionChangedHandlers.subpatchpins=
function(){if(0<this.links.length&&this.slavePin){"development"==VVVV_ENV&&console.log("deleting "+f+" output pin because node "+e.id+" has output connection...");for(var d=0;d<this.slavePin.links.length;d++)this.slavePin.links[d].destroy();e.parentPatch.removeOutputPin(f);this.slavePin=void 0}if(0==e.IOBoxInputPin().links.length)if(e.IOBoxInputPin().masterPin)e.IOBoxInputPin().masterPin.pinname!=f&&(console.log("renaming "+e.IOBoxInputPin().masterPin.pinname+" to "+f),e.parentPatch.inputPins[f]=
e.parentPatch.inputPins[e.IOBoxInputPin().masterPin.pinname],e.parentPatch.removeInputPin(e.IOBoxInputPin().masterPin.pinname),e.IOBoxInputPin().masterPin.pinname=f);else{"development"==VVVV_ENV&&console.log("interfacing input pin detected: "+f);var c=e.parentPatch.inputPins[f];if(void 0==c)"development"==VVVV_ENV&&console.log("creating new input pin at parent patch, using IOBox values"),c=e.parentPatch.addInputPin(f,e.IOBoxInputPin().values);else{slicecount=c.getSliceCount();for(d=0;d<slicecount;d++)e.IOBoxInputPin().setValue(d,
c.getValue(d));0<slicecount&&e.IOBoxInputPin().setSliceCount(c.getSliceCount())}d=c.values.slice();c.setType(VVVV.PinTypes[e.IOBoxInputPin().typeName]);if(c.unvalidated&&VVVV.PinTypes[c.typeName].primitive||c.isConnected())c.values=d,c.unvalidated=!1;c.slavePin=e.IOBoxInputPin();e.IOBoxInputPin().masterPin=c}this.node.parentPatch.parentPatch.afterUpdate()};this.IOBoxOutputPin().connectionChanged()}};this.setup=function(){this.addInvisiblePin("Descriptive Name",[""],VVVV.PinTypes.String)};this.initialize=
function(){};this.evaluate=function(){_(this.outputPins).each(function(e){e.setValue(0,"not calculated")})};this.destroy=function(){this.isIOBox&&(this.IOBoxInputPin().masterPin&&(this.parentPatch.removeInputPin(this.IOBoxInputPin().masterPin.pinname),this.parentPatch.parentPatch.afterUpdate()),this.IOBoxOutputPin().slavePin&&(this.parentPatch.removeOutputPin(this.IOBoxOutputPin().slavePin.pinname),this.parentPatch.parentPatch.afterUpdate()))};this.serialize=function(){var e=$("<NODE>");e.attr("id",
this.id);e.attr("nodename",this.nodename);e.attr("systemname",this.nodename);this.shaderFile&&e.attr("filename",this.shaderFile.replace(".vvvvjs.fx",".fx").replace("%VVVV%/effects","%VVVV%/lib/nodes/effects"));this.isSubpatch&&(e.attr("filename",this.nodename),e.attr("systemname",this.nodename.match("(.*).v4p$")[1]));this.isIOBox?e.attr("componentmode","InABox"):e.attr("componentmode","Hidden");var f=$("<BOUNDS>");this.isIOBox?f.attr("type","Box"):f.attr("type","Node");f.attr("left",parseInt(15*this.x));
f.attr("top",parseInt(15*this.y));f.attr("width",parseInt(this.width));f.attr("height",parseInt(this.height));e.append(f);var d=this;_(this.inputPins).each(function(c){var g=$("<PIN>");g.attr("pinname",c.pinname);g.attr("visible","1");(!c.isConnected()||c.masterPin)&&(VVVV.PinTypes[c.typeName].primitive&&d.defaultPinValues[c.pinname])&&g.attr("values",_(d.defaultPinValues[c.pinname]).map(function(c){return"|"+c.toString().replace(/\|/g,"||")+"|"}).join(","));e.append(g)});_(this.invisiblePins).each(function(c){var d=
$("<PIN>");d.attr("pinname",c.pinname);d.attr("visible","0");VVVV.PinTypes[c.typeName].primitive&&d.attr("values",_(c.values).map(function(c){return"|"+c.toString().replace(/\|/g,"||")+"|"}).join(","));e.append(d)});return e}},Link:function(b,a){this.fromPin=b;this.toPin=a;this.fromPin.links.push(this);this.toPin.links.push(this);this.destroy=function(){this.toPin.reset_on_disconnect?this.toPin.reset():this.toPin.node.defaultPinValues[this.toPin.pinname]=this.toPin.values.slice(0);this.fromPin.links.splice(this.fromPin.links.indexOf(this),
1);this.toPin.links.splice(this.toPin.links.indexOf(this),1);this.fromPin.node.parentPatch.linkList.splice(this.fromPin.node.parentPatch.linkList.indexOf(this),1)};this.serialize=function(){var h=$("<LONK>");h.attr("srcnodeid",this.fromPin.node.id);h.attr("srcpinname",this.fromPin.pinname);h.attr("dstnodeid",this.toPin.node.id);h.attr("dstpinname",this.toPin.pinname);return h}},Patch:function(b,a,h,e,f){function d(c){if(void 0==c)return[];if("45_26">=this.vvvv_version)return separator=/\|/.test(c)?
"|":",",c.split(separator).filter(function(c,d){return""!=c});for(var d=[],g="",f=!1,e=c.length,m=0;m<e;m++)","!=c[m]||f?"|"==c[m]?"|"!=c[m+1]||m+1==c.length-1?f=!f:g+=c[++m]:g+=c[m]:(d.push(g),g="");d.push(g);return d}function c(){var c=window.location.hash.match("#([^/]+)/"+n.ressource+"$");c&&(console.log("launching editor ..."),(new VVVV.Editors[c[1]]).enable(n))}this.ressource=b;this.vvvv_version="45_26.1";this.boundingBox={width:0,height:0};this.windowHeight=this.windowWidth=500;this.pinMap=
{};this.nodeMap={};this.nodeList=[];this.linkList=[];this.mainloop=void 0;this.success=a;this.error=h;this.editor=void 0;this.setupObject();e&&(this.parentPatch=e);f&&(this.id=f);var g=!1;this.getAbsolutePath=function(){var c=this.getRelativePath();this.parentPatch&&(c=this.parentPatch.getAbsolutePath()+c);return c};this.getRelativePath=function(){return this.nodename.match(/(.*\/)?[^/]+\.v4p/)[1]||""};this.destroy=function(){for(var c=0;c<this.nodeList.length;c++)this.nodeList[c].destroy(),delete this.nodeMap[this.nodeList[c].id],
delete this.nodeList[c]};if("45_26">=this.vvvv_version)var m={},q={},k={},r={};var n=this;this.doLoad=function(c,g){function f(c){"complete"==h&&(q={});$(c).find('link[deleteme="pronto"]').each(function(){for(var c=!1,d=0;d<n.linkList.length;d++)n.linkList[d].fromPin.node.id==$(this).attr("srcnodeid")&&(n.linkList[d].fromPin.pinname==$(this).attr("srcpinname")&&n.linkList[d].toPin.node.id==$(this).attr("dstnodeid")&&n.linkList[d].toPin.pinname==$(this).attr("dstpinname"))&&(c=n.linkList[d]);if(c){"development"==
VVVV_ENV&&console.log("removing "+c.fromPin.pinname+" -> "+c.toPin.pinname);var d=c.fromPin,g=c.toPin;c.destroy();d.connectionChanged();g.connectionChanged();g.markPinAsChanged()}});$(c).find('link[deleteme!="pronto"]').each(function(){var c=n.pinMap[$(this).attr("srcnodeid")+"_out_"+$(this).attr("srcpinname")],d=n.pinMap[$(this).attr("dstnodeid")+"_in_"+$(this).attr("dstpinname")];void 0==c&&n.nodeMap[$(this).attr("srcnodeid")]&&(c=n.nodeMap[$(this).attr("srcnodeid")].addOutputPin($(this).attr("srcpinname"),
void 0));void 0==d&&n.nodeMap[$(this).attr("dstnodeid")]&&(d=n.nodeMap[$(this).attr("dstnodeid")].addInputPin($(this).attr("dstpinname"),void 0));if(c&&d){for(var g=!1,f=0;f<n.linkList.length;f++)n.linkList[f].fromPin.node.id==c.node.id&&(n.linkList[f].fromPin.pinname==c.pinname&&n.linkList[f].toPin.node.id==d.node.id&&n.linkList[f].toPin.pinname==d.pinname)&&(g=n.linkList[f]);if(!g){g=new VVVV.Core.Link(c,d);c.connectionChanged();d.connectionChanged();n.linkList.push(g);for(f=0;f<c.values.length;f++)d.setValue(f,
c.getValue(f));d.setSliceCount(c.getSliceCount())}"complete"==h&&(q[c.node.id+"_"+c.pinname+"-"+d.node.id+"_"+d.pinname]=g)}});"complete"==h&&(_(m).each(function(c,d){if(void 0==q[d]){"development"==VVVV_ENV&&console.log("removing "+c.fromPin.pinname+" -> "+c.toPin.pinname);var g=c.fromPin,f=c.toPin;c.destroy();g.connectionChanged();f.connectionChanged();f.markPinAsChanged();f.reset_on_disconnect&&f.reset()}}),m={},_(q).each(function(c,d){m[d]=c}))}var e=this;do e.dirty=!0;while(e=e.parentPatch);
if(e=/^<!DOCTYPE\s+PATCH\s+SYSTEM\s+"(.+)\\(.+)\.dtd/.exec(c))n.vvvv_version=e[2].replace(/[a-zA-Z]+/,"_");var h="diff";if(/\s<PATCH/.test(c)||"45_26">=n.vvvv_version)h="complete","development"==VVVV_ENV&&console.log("complete: "+this.nodename);e=$(c).find('bounds[type="Window"]').first();0<e.length&&(n.windowWidth=e.attr("width")/15,n.windowHeight=e.attr("height")/15);"complete"==h&&(r={});$(c).find("node").each(function(){if("pronto"==$(this).attr("createme")&&void 0!=n.nodeMap[$(this).attr("id")]){var e=
n.nodeMap[$(this).attr("id")];"development"==VVVV_ENV&&console.log("node renamed, so deleting node "+e.id+" / "+e.nodename);_(e.inputPins).each(function(c){_(c.links).each(function(c){c.destroy();c.fromPin.connectionChanged()})});_(e.outputPins).each(function(c){_(c.links).each(function(c){c.destroy();c.toPin.connectionChanged();c.toPin.markPinAsChanged()})});n.nodeList.splice(n.nodeList.indexOf(e),1);delete n.nodeMap[e.id]}var m;m="InABox"==$(this).attr("componentmode")?$(this).find('bounds[type="Box"]').first():
$(this).find('bounds[type="Node"]').first();var b=void 0!=n.nodeMap[$(this).attr("id")];if(b)e=n.nodeMap[$(this).attr("id")];else{var a=""!=$(this).attr("systemname")?$(this).attr("systemname"):$(this).attr("nodename");if(void 0==a)return;if(void 0!=VVVV.NodeLibrary[a.toLowerCase()])e=new (VVVV.NodeLibrary[a.toLowerCase()])($(this).attr("id"),n),VVVV.NodeLibrary[a.toLowerCase()].requirements&&(n.resourcesPending++,_(VVVV.NodeLibrary[a.toLowerCase()].requirements).each(function(c){void 0===VVVV.LoadedLibs[c]&&
VVVV.loadScript(VVVV.ThirdPartyLibs[c],function(){n.resourcesPending--})}));else if(/.fx$/.test($(this).attr("filename")))e=new VVVV.Nodes.GenericShader($(this).attr("id"),n),e.isShader=!0,e.shaderFile=$(this).attr("filename").replace(/\\/g,"/").replace(/\.fx$/,".vvvvjs.fx").replace("lib/nodes/",""),e.nodename=a;else if(/.v4p$/.test($(this).attr("filename"))){n.resourcesPending++;var k=this,e=new VVVV.Core.Patch($(this).attr("filename"),function(){n.resourcesPending--;"development"==VVVV_ENV&&console.log(this.nodename+
"invoking update links");f(c);n.editor&&n.editor.addPatch(this);if(this.auto_evaluate){var d=n;do d.auto_evaluate=!0;while(d=d.parentPatch)}this.setMainloop(n.mainloop);n.afterUpdate();0>=n.resourcesPending&&g&&(g(),g=void 0)},function(){n.resourcesPending--;this.not_implemented=!0;VVVV.onNotImplemented(a);f(c);n.afterUpdate();0>=n.resourcesPending&&g&&(g(),g=void 0)},n,$(k).attr("id"));e.isSubpatch=!0;n.editor&&!e.editor&&n.editor.addPatch(e);n.nodeMap[e.id]=e}else e=new VVVV.Core.Node($(this).attr("id"),
a,n),e.not_implemented=!0,"diff"==h&&!0==VVVV.Config.auto_undo&&n.editor.sendUndo(),VVVV.onNotImplemented(a);"development"==VVVV_ENV&&"complete"!=h&&console.log(n.nodename+": inserted new node "+e.nodename)}if(e.auto_evaluate){k=n;do k.auto_evaluate=!0;while(k=k.parentPatch)}if("pronto"==$(this).attr("deleteme")){"development"==VVVV_ENV&&console.log("removing node "+e.id);if(e.isSubpatch){e.editor&&e.editor.removePatch(e);k=e.getSubPatches();k.push(e);for(var q,p=0;p<k.length;p++)q=VVVV.Helpers.prepareFilePath(k[p].nodename,
k[p].parentPatch),VVVV.Patches[q].splice(VVVV.Patches[q].indexOf(e),1),0==VVVV.Patches[q].length&&delete VVVV.Patches[q]}n.nodeList.splice(n.nodeList.indexOf(e),1);e.destroy();delete n.nodeMap[e.id]}0<m.length&&(m.attr("left")&&(e.x=m.attr("left")/15,e.y=m.attr("top")/15,n.boundingBox.width=Math.max(n.boundingBox.width,e.x+100),n.boundingBox.height=Math.max(n.boundingBox.height,e.y+100)),m.attr("width")&&(e.width=m.attr("width"),e.height=m.attr("height")));/^iobox/.test(e.nodename.toLowerCase())&&
(e.isIOBox=!0);b||e.setup();k=this;$(this).find("pin").each(function(){var g=$(this).attr("pinname"),f=d($(this).attr("values"));void 0!=f&&0<f.length&&e.addDefault(g,f);if(void 0==e.outputPins[g])if(void 0!=e.inputPins[g])e.inputPins[g].isConnected()||e.applyPinValuesFromXML(g);else if(void 0!=e.invisiblePins[g]){if(void 0!=f){for(var m=0;m<f.length;m++)e.invisiblePins[g].values[m]!=f[m]&&e.invisiblePins[g].setValue(m,f[m]);e.invisiblePins[g].setSliceCount(f.length)}}else 1==$(this).attr("visible")&&
"Configuration"!=$(this).attr("pintype")||e.isSubpatch?"Output"==$(this).attr("pintype")||0<$(c).find("link[srcnodeid="+e.id+"]").filter("link[srcpinname='"+g.replace(/[\[\]]/,"")+"']").length?void 0==e.outputPins[g]&&e.addOutputPin(g,f):void 0==e.inputPins[g]&&void 0==e.invisiblePins[g]&&e.addInputPin(g,f):void 0==e.inputPins[g]&&void 0==e.invisiblePins[g]&&e.addInvisiblePin(g,f)});b||(e.initialize(),n.nodeList.push(e));"complete"==h&&(r[e.id]=e)});"complete"==h&&(_(k).each(function(c,d){void 0==
r[d]&&("development"==VVVV_ENV&&console.log("removing node "+c.id),n.nodeList.splice(n.nodeList.indexOf(c),1),delete n.nodeMap[c.id])}),k={},_(r).each(function(c,d){k[d]=c}));0===this.resourcesPending&&f(c);0>=this.resourcesPending&&g&&(g(),g=void 0)};this.getSubPatches=function(){for(var c=[],d=0;d<this.nodeList.length;d++)this.nodeList[d].isSubpatch&&(c.push(this.nodeList[d]),c=c.concat(this.nodeList[d].getSubPatches()));return c};this.setMainloop=function(c){this.mainloop=c;for(var d=0;d<this.nodeList.length;d++)this.nodeList[d].isSubpatch&&
this.nodeList[d].setMainloop(c)};this.afterEvaluate=function(){};this.afterUpdate=function(){};this.toXML=function(){var c=$("<PATCH>"),d=$("<BOUNDS>");d.attr("type","Window");d.attr("width",parseInt(15*this.windowWidth));d.attr("height",parseInt(15*this.windowHeight));c.append(d);for(d=0;d<this.nodeList.length;d++)c.append(this.nodeList[d].serialize());for(d=0;d<this.linkList.length;d++)c.append(this.linkList[d].serialize());c='<!DOCTYPE PATCH  SYSTEM "http://vvvv.org/versions/vvvv45beta28.1.dtd" >\r\n  '+
c.wrapAll("<d></d>").parent().html();c=c.replace(/<patch/g,"<PATCH");c=c.replace(/<\/patch>/g,"\n  </PATCH>");c=c.replace(/<node/g,"\n  <NODE");c=c.replace(/<\/node>/g,"\n  </NODE>");c=c.replace(/<bounds/g,"\n  <BOUNDS");c=c.replace(/<\/bounds>/g,"\n  </BOUNDS>");c=c.replace(/<pin/g,"\n  <PIN");c=c.replace(/<\/pin>/g,"\n  </PIN>");c=c.replace(/<lonk/g,"\n  <LINK");return c=c.replace(/<\/lonk>/g,"\n  </LINK>")};this.evaluate=function(){function c(f){var h=f.getUpstreamNodes();_(h).each(function(d){void 0==
m[d.id]||d.delays_output||c(d)});if(f.dirty||f.auto_evaluate||f.isSubpatch){if(g)var b=(new Date).getTime();if(f.auto_nil&&!f.isSubpatch&&f.hasNilInputs())_(f.outputPins).each(function(c){c.setSliceCount(0)});else{try{f.evaluate()}catch(a){console.log("VVVV.Js / Error evaluating "+f.nodename+": "+a.message)}f.dirty=!1;_(f.inputPins).each(function(c){c.changed=!1})}g&&(d[f.nodename]||(d[f.nodename]={count:0,dt:0}),e=(new Date).getTime()-b,d[f.nodename].count++,d[f.nodename].dt+=e,console.log(f.nodename+
" / "+f.id+": "+e+"ms"))}delete m[f.id];return!0}if(!(0<this.resourcesPending)){if(g)var d={},f=(new Date).getTime(),e=0;for(var m={},h={},b=0;b<this.nodeList.length;b++){if(0==this.nodeList[b].getDownstreamNodes().length||this.nodeList[b].auto_evaluate||this.nodeList[b].delays_output)h[this.nodeList[b].id]=this.nodeList[b];m[this.nodeList[b].id]=this.nodeList[b]}g&&console.log("building node maps: "+((new Date).getTime()-f)+"ms");_(h).each(function(d,g,f){void 0!=m[d.id]&&c(d)});g&&(_(d).each(function(c,
d){console.log(c.count+"x "+d+": "+c.dt+"ms")}),f=(new Date).getTime());this.afterEvaluate();g&&console.log("patch rendering: "+((new Date).getTime()-f)+"ms");g=!1}};$(window).keydown(function(c){84==c.which&&(c.altKey&&c.ctrlKey)&&(g=!0)});if(/\.v4p[^<>\s]*$/.test(b)){this.nodename=b;var p=this,s=b;this.parentPatch&&(s=VVVV.Helpers.prepareFilePath(b,this.parentPatch));VVVV.Patches[s]?p.doLoad(VVVV.Patches[s][0].toXML(),function(){VVVV.Patches[s].push(p);p.success&&p.success();p.afterUpdate()}):$.ajax({url:s,
type:"get",dataType:"text",success:function(c){p.doLoad(c,function(){VVVV.Patches[s]=VVVV.Patches[s]||[];VVVV.Patches[s].push(p);p.success&&p.success();p.afterUpdate()})},error:function(){p.error&&p.error()}})}else this.doLoad(b,function(){this.success&&this.success()});c();$(window).bind("hashchange",function(){c()})}};VVVV.Core.Patch.prototype=new VVVV.Core.Node;VVVV.Core.DOMInterface=function(b){function a(d){if("event"==d.property_class){var c=d.selector;"window"==c&&(c=window);"document"==c&&(c=document);$(c).each(function(c){d.values[c]=0;$(this).bind(d.property,function(){d.values[c]=1;return!1})})}}var h={},e={};b.domInterface=this;this.connect=function(d){_(h).each(function(c,g){c.node.id==d.id&&("event"==c.property_class&&$(c.selector).unbind(c.property),delete h[g])});_(e).each(function(c,g){c.node.id==d.id&&delete e[g]});var c=/([^\/]+)(\/(event|attribute|style)\/(.+))?/.exec(d.invisiblePins["Descriptive Name"].getValue(0));
if(null!=c){var g={selector:c[1],property_class:c[3],property:c[4],values:[],node:d};0!=$(g.selector).length&&(0==d.getUpstreamNodes().length?h[c[0]]=g:0==d.getDownstreamNodes().length&&(e[c[0]]=g),a(g))}};var f=this;_(b.nodeList).each(function(d){d.isIOBox&&void 0!=d.invisiblePins["Descriptive Name"]&&(f.connect(d),d.IOBoxInputPin().connectionChanged=function(){f.connect(d)})});this.populateInputConnectors=function(){var d=this;_(h).each(function(c){switch(c.property_class){case "event":c.values.length!=
c.node.IOBoxInputPin().values.length&&c.node.IOBoxInputPin().setSliceCount(c.values.length);for(var g=0;g<c.values.length;g++)void 0!=c.node.IOBoxInputPin().values[g]&&c.values[g]==c.node.IOBoxInputPin().values[g]||c.node.IOBoxInputPin().setValue(g,c.values[g]);break;default:for(d.fetchValuesFromDOM(c),c.values.length!=c.node.IOBoxInputPin().values.length&&c.node.IOBoxInputPin().setSliceCount(c.values.length),g=0;g<c.values.length;g++)c.node.IOBoxInputPin().getValue(g)!=c.values[g]&&c.node.IOBoxInputPin().setValue(g,
c.values[g])}})};this.processOutputConnectors=function(){var d=this;_(e).each(function(c){switch(c.property_class){default:d.setDOMByIOBox(c)}});_(h).each(function(c){if("event"==c.property_class)for(var d=0;d<c.values.length;d++)c.values[d]=0})};this.fetchValuesFromDOM=function(d){d.values.length=0;$(d.selector).each(function(c){var g;if(void 0==d.property_class)switch(this.nodeName){case "INPUT":"text"==$(this).attr("type")&&(g=$(this).val());"checkbox"==$(this).attr("type")&&(g=$(this).attr("checked")?
1:0);break;default:g=$(this).text()}"attribute"==d.property_class&&(g=$(this).attr(d.property));"style"==d.property_class&&(g=$(this).css(d.property));d.values[c]=g})};this.setDOMByIOBox=function(d){if(d.node.IOBoxOutputPin().pinIsChanged()){var c=d.node.IOBoxInputPin().values,g=$(d.selector).length;void 0==d.property_class&&($(d.selector).empty(),$(d.selector).val(""));for(var f=0;f<Math.max(c.length,g);f++){var e=f%g,h=f%c.length,b=$(d.selector).eq(e);if(0!=b.length){if(void 0==d.property_class)switch(b[0].nodeName){case "INPUT":b.val($(d.selector).eq(e).val()+
c[h]);break;default:b.html($(d.selector).eq(e).html()+c[h])}"attribute"==d.property_class&&b.attr(d.property,c[h]);"style"==d.property_class&&b.css(d.property,c[h])}}}}};VVVV.fps=60;
VVVV.Core.MainLoop=function(b,a){function h(){if(0==b.resourcesPending){e++;var a=(new Date).getTime();c&&(q.deltaT=a-c);c=a;f.populateInputConnectors();b.evaluate();f.processOutputConnectors();a=(new Date).getTime()-c;0==e%10&&(m&&(console.log(1/((c-g)/1E4)+"fps"),m=!1),g=c)}d&&window.setTimeout(h,Math.max(0,Math.round(1E3/VVVV.fps-a)))}VVVV.fps=a||60;var e=0,f=new VVVV.Core.DOMInterface(b),d=!0,c=void 0,g=0,m=!1;this.deltaT=1E3/VVVV.fps;b.setMainloop(this);var q=this;this.stop=function(){d=!1};
this.start=function(){d||(d=!0,h())};this.isRunning=function(){return d};h();$(window).keydown(function(c){(102==c.which||70==c.which)&&(c.altKey&&c.ctrlKey)&&(m=!0)})};VVVV.Nodes.Cross2d=function(b,a){this.constructor(b,"Cross (2d)",a);this.meta={authors:["Matthias Zauner"],original_authors:["VVVV Group"],credits:[],compatibility_issues:[]};this.auto_evaluate=!1;var h=this.addInputPin("X In",[0],VVVV.PinTypes.Value),e=this.addInputPin("Y In",[0],VVVV.PinTypes.Value),f=this.addInputPin("Include Upper",[1],VVVV.PinTypes.Value),d=this.addInputPin("Include Lower",[1],VVVV.PinTypes.Value),c=this.addInputPin("Include Equal",[1],VVVV.PinTypes.Value),g=this.addOutputPin("X Out",
[0],VVVV.PinTypes.Value),m=this.addOutputPin("Y Out",[0],VVVV.PinTypes.Value);this.evaluate=function(){for(var b=0,a=0;a<e.getSliceCount();a++)for(var r=0;r<h.getSliceCount();r++)0.5>f.getValue(0)&&a>r||(0.5>d.getValue(0)&&a<r||0.5>c.getValue(0)&&a==r)||(g.setValue(b,h.getValue(r)),m.setValue(b,e.getValue(a)),b++);g.setSliceCount(b);m.setSliceCount(b)}};VVVV.Nodes.Cross2d.prototype=new VVVV.Core.Node;
VVVV.Nodes.Polar2d=function(b,a){this.constructor(b,"Polar (2d)",a);this.meta={authors:["Matthias Zauner"],original_authors:["VVVV Group"],credits:[],compatibility_issues:[]};this.auto_evaluate=!1;var h=this.addInputPin("X",[1],VVVV.PinTypes.Value),e=this.addInputPin("Y",[0],VVVV.PinTypes.Value),f=this.addOutputPin("Angle",[0],VVVV.PinTypes.Value),d=this.addOutputPin("Length",[1],VVVV.PinTypes.Value);this.initialize=function(){};this.evaluate=function(){for(var c=this.getMaxInputSliceCount(),g=0;g<
c;g++){var m=h.getValue(g),b=e.getValue(g);f.setValue(g,Math.atan2(b,m)/(2*Math.PI));d.setValue(g,Math.sqrt(m*m+b*b))}f.setSliceCount(c);d.setSliceCount(c)}};VVVV.Nodes.Polar2d.prototype=new VVVV.Core.Node;
VVVV.Nodes.Cartesian2d=function(b,a){this.constructor(b,"Cartesian (2d)",a);this.meta={authors:["Matthias Zauner"],original_authors:["VVVV Group"],credits:[],compatibility_issues:[]};this.auto_evaluate=!1;var h=this.addInputPin("Angle",[0],VVVV.PinTypes.Value),e=this.addInputPin("Length",[1],VVVV.PinTypes.Value),f=this.addOutputPin("X",[1],VVVV.PinTypes.Value),d=this.addOutputPin("Y",[0],VVVV.PinTypes.Value);this.evaluate=function(){for(var c=this.getMaxInputSliceCount(),g=0;g<c;g++){var m=h.getValue(g),
b=e.getValue(g);f.setValue(g,b*Math.cos(2*m*Math.PI));d.setValue(g,b*Math.sin(2*m*Math.PI))}f.setSliceCount(c);d.setSliceCount(c)}};VVVV.Nodes.Cartesian2d.prototype=new VVVV.Core.Node;
VVVV.Nodes.Points2Vector2d=function(b,a){this.constructor(b,"Points2Vector (2d)",a);this.meta={authors:["Matthias Zauner"],original_authors:["VVVV Group"],credits:[],compatibility_issues:[]};this.auto_evaluate=!1;var h=this.addInputPin("X1",[0],VVVV.PinTypes.Value),e=this.addInputPin("Y1",[0],VVVV.PinTypes.Value),f=this.addInputPin("X2",[1],VVVV.PinTypes.Value),d=this.addInputPin("Y2",[0],VVVV.PinTypes.Value),c=this.addOutputPin("X",[0],VVVV.PinTypes.Value),g=this.addOutputPin("Y",[0],VVVV.PinTypes.Value),
m=this.addOutputPin("Length",[1],VVVV.PinTypes.Value),q=this.addOutputPin("Angle",[0],VVVV.PinTypes.Value);this.evaluate=function(){for(var b=this.getMaxInputSliceCount(),a=0;a<b;a++){var n=parseFloat(h.getValue(a)),p=parseFloat(e.getValue(a)),s=parseFloat(f.getValue(a)),v=parseFloat(d.getValue(a)),s=s-n,v=v-p;c.setValue(a,n+s/2);g.setValue(a,p+v/2);m.setValue(a,Math.sqrt(s*s+v*v));q.setValue(a,Math.atan2(v,s)/(2*Math.PI))}c.setSliceCount(b);g.setSliceCount(b);m.setSliceCount(b);q.setSliceCount(b)}};
VVVV.Nodes.Points2Vector2d.prototype=new VVVV.Core.Node;
VVVV.Nodes.Vector2Points2d=function(b,a){this.constructor(b,"Vector2Points (2d)",a);this.meta={authors:["Matthias Zauner"],original_authors:["VVVV Group"],credits:[],compatibility_issues:[]};this.auto_evaluate=!1;var h=this.addInputPin("X",[0],VVVV.PinTypes.Value),e=this.addInputPin("Y",[0],VVVV.PinTypes.Value),f=this.addInputPin("Length",[1],VVVV.PinTypes.Value),d=this.addInputPin("Angle",[0],VVVV.PinTypes.Value),c=this.addOutputPin("X1",[0],VVVV.PinTypes.Value),g=this.addOutputPin("Y1",[0],VVVV.PinTypes.Value),
m=this.addOutputPin("X2",[0],VVVV.PinTypes.Value),q=this.addOutputPin("Y2",[0],VVVV.PinTypes.Value);this.evaluate=function(){for(var b=this.getMaxInputSliceCount(),a=0;a<b;a++){var n=parseFloat(h.getValue(a)),p=parseFloat(e.getValue(a)),s=parseFloat(f.getValue(a)),v=2*parseFloat(d.getValue(a)-0.25)*Math.PI,t=s/2*Math.sin(v),s=-s/2*Math.cos(v);c.setValue(a,n+t);g.setValue(a,p+s);m.setValue(a,n-t);q.setValue(a,p-s)}c.setSliceCount(b);g.setSliceCount(b);m.setSliceCount(b);q.setSliceCount(b)}};
VVVV.Nodes.Vector2Points2d.prototype=new VVVV.Core.Node;
VVVV.Nodes.Attractor2d=function(b,a){this.constructor(b,"Attractor (2d)",a);this.meta={authors:["Matthias Zauner"],original_authors:["VVVV Group"],credits:[],compatibility_issues:[]};this.auto_evaluate=!1;var h=this.addInputPin("X",[0],VVVV.PinTypes.Value),e=this.addInputPin("Y",[0],VVVV.PinTypes.Value),f=this.addInputPin("Attractor X",[0],VVVV.PinTypes.Value),d=this.addInputPin("Attractor Y",[0],VVVV.PinTypes.Value),c=this.addInputPin("Attractor Strength",[1],VVVV.PinTypes.Value),g=this.addInputPin("Attractor Power",
[1],VVVV.PinTypes.Value),m=this.addInputPin("Attractor Radius",[0.1],VVVV.PinTypes.Value),q=this.addOutputPin("Output X",[0],VVVV.PinTypes.Value),k=this.addOutputPin("Output Y",[0],VVVV.PinTypes.Value);this.evaluate=function(){for(var b=Math.max(h.getSliceCount(),e.getSliceCount()),a=Math.max(f.getSliceCount(),d.getSliceCount()),p,s,v,t,u,w,l=0;l<b;l++){p=parseFloat(h.getValue(l));s=parseFloat(e.getValue(l));for(var z=0;z<a;z++)if(v=parseFloat(f.getValue(z)),t=parseFloat(d.getValue(z)),attractorstrength=
parseFloat(c.getValue(z)),u=parseFloat(g.getValue(z)),w=parseFloat(m.getValue(z)),v=p-v,t=s-t,0!=v||0!=t){var y=Math.sqrt(Math.pow(v,2)+Math.pow(t,2)),A=0;y<=w&&(w=y/w,A=attractorstrength*(Math.pow(w,u)*(0>w?-1:0<w?1:0)/w-1));p+=v*A;s+=t*A}q.setValue(l,p);k.setValue(l,s)}q.setSliceCount(b);k.setSliceCount(b)}};VVVV.Nodes.Attractor2d.prototype=new VVVV.Core.Node;VVVV.Nodes.Polar3d=function(b,a){this.constructor(b,"Polar (3d)",a);this.meta={authors:["Matthias Zauner"],original_authors:["VVVV Group"],credits:[],compatibility_issues:[]};this.auto_evaluate=!1;var h=this.addInputPin("X",[0],VVVV.PinTypes.Value),e=this.addInputPin("Y",[0],VVVV.PinTypes.Value),f=this.addInputPin("Z",[-1],VVVV.PinTypes.Value),d=this.addOutputPin("Pitch",[0],VVVV.PinTypes.Value),c=this.addOutputPin("Yaw",[0],VVVV.PinTypes.Value),g=this.addOutputPin("Length",[1],VVVV.PinTypes.Value);
this.evaluate=function(){for(var b=this.getMaxInputSliceCount(),a=0;a<b;a++){var k=h.getValue(a),r=e.getValue(a),n=f.getValue(a),p=Math.sqrt(k*k+r*r+n*n);c.setValue(a,Math.atan2(-k,-n)/(2*Math.PI));d.setValue(a,0==p?0:Math.acos(-r/p)/(2*Math.PI)-0.25);g.setValue(a,p)}c.setSliceCount(b);d.setSliceCount(b);g.setSliceCount(b)}};VVVV.Nodes.Polar3d.prototype=new VVVV.Core.Node;
VVVV.Nodes.Cartesian3d=function(b,a){this.constructor(b,"Cartesian (3d)",a);this.meta={authors:["Matthias Zauner"],original_authors:["VVVV Group"],credits:[],compatibility_issues:[]};this.auto_evaluate=!1;var h=this.addInputPin("Pitch",[0],VVVV.PinTypes.Value),e=this.addInputPin("Yaw",[0],VVVV.PinTypes.Value),f=this.addInputPin("Length",[1],VVVV.PinTypes.Value),d=this.addOutputPin("X",[0],VVVV.PinTypes.Value),c=this.addOutputPin("Y",[0],VVVV.PinTypes.Value),g=this.addOutputPin("Z",[1],VVVV.PinTypes.Value);
this.evaluate=function(){for(var b=this.getMaxInputSliceCount(),a=0;a<b;a++){var k=2*(h.getValue(a)+0.25)*Math.PI,r=2*e.getValue(a)*Math.PI,n=f.getValue(a);g.setValue(a,-n*Math.cos(r)*Math.sin(k));d.setValue(a,-n*Math.sin(r)*Math.sin(k));c.setValue(a,-n*Math.cos(k))}d.setSliceCount(b);c.setSliceCount(b);g.setSliceCount(b)}};VVVV.Nodes.Cartesian3d.prototype=new VVVV.Core.Node;
VVVV.Nodes.Normalize3d=function(b,a){this.constructor(b,"Normalize (3d)",a);this.meta={authors:["Matthias Zauner"],original_authors:["VVVV Group"],credits:[],compatibility_issues:[]};this.auto_evaluate=!1;var h=this.addInputPin("X",[1],VVVV.PinTypes.Value),e=this.addInputPin("Y",[0],VVVV.PinTypes.Value),f=this.addInputPin("Z",[0],VVVV.PinTypes.Value),d=this.addOutputPin("NormalizedX",[1],VVVV.PinTypes.Value),c=this.addOutputPin("NormalizedY",[0],VVVV.PinTypes.Value),g=this.addOutputPin("NormalizedZ",
[0],VVVV.PinTypes.Value),m=this.addOutputPin("Input Length",[0],VVVV.PinTypes.Value);this.evaluate=function(){for(var b=this.getMaxInputSliceCount(),a=0;a<b;a++){var r=h.getValue(a),n=e.getValue(a),p=f.getValue(a),s=Math.sqrt(r*r+n*n+p*p);d.setValue(a,0==s?0:r/s);c.setValue(a,0==s?0:n/s);g.setValue(a,0==s?0:p/s);m.setValue(a,s)}d.setSliceCount(b);c.setSliceCount(b);g.setSliceCount(b);m.setSliceCount(b)}};VVVV.Nodes.Normalize3d.prototype=new VVVV.Core.Node;
VVVV.Nodes.Normalize3dVector=function(b,a){this.constructor(b,"Normalize (3d Vector)",a);this.meta={authors:["Matthias Zauner"],original_authors:["VVVV Group"],credits:[],compatibility_issues:[]};this.auto_evaluate=!1;var h=this.addInputPin("XYZ",[],VVVV.PinTypes.Value),e=this.addOutputPin("NormalizedXYZ",[],VVVV.PinTypes.Value),f=this.addOutputPin("Input Length",[0],VVVV.PinTypes.Value);this.evaluate=function(){for(var d=this.getMaxInputSliceCount(),c=0;c<d/3;c++){var g=h.getValue(c,3),b=Math.sqrt(g[0]*
g[0]+g[1]*g[1]+g[2]*g[2]);e.setValue(3*c,0==b?0:g[0]/b);e.setValue(3*c+1,0==b?0:g[1]/b);e.setValue(3*c+2,0==b?0:g[2]/b);f.setValue(c,b)}e.setSliceCount(3*Math.ceil(d/3));f.setSliceCount(Math.ceil(d/3))}};VVVV.Nodes.Normalize3dVector.prototype=new VVVV.Core.Node;
VVVV.Nodes.Multiply3dCross=function(b,a){this.constructor(b,"Multiply (3d Cross)",a);this.meta={authors:["Matthias Zauner"],original_authors:["VVVV Group"],credits:[],compatibility_issues:[]};this.auto_evaluate=!1;var h=this.addInputPin("Input1 XYZ",[],VVVV.PinTypes.Value),e=this.addInputPin("Input2 XYZ",[],VVVV.PinTypes.Value),f=this.addOutputPin("Output XYZ",[],VVVV.PinTypes.Value);this.evaluate=function(){for(var d=this.getMaxInputSliceCount(),c=0;c<d/3;c++){var g=h.getValue(c,3),b=e.getValue(c,
3);f.setValue(3*c+0,g[1]*b[2]-g[2]*b[1]);f.setValue(3*c+1,-(g[0]*b[2]-g[2]*b[0]));f.setValue(3*c+2,g[0]*b[1]-g[1]*b[0])}f.setSliceCount(3*Math.ceil(d/3))}};VVVV.Nodes.Multiply3dCross.prototype=new VVVV.Core.Node;
VVVV.Nodes.Multiply3dDot=function(b,a){this.constructor(b,"Multiply (3d Dot)",a);this.meta={authors:["Matthias Zauner"],original_authors:["VVVV Group"],credits:[],compatibility_issues:[]};this.auto_evaluate=!1;var h=this.addInputPin("Input1 XYZ",[],VVVV.PinTypes.Value),e=this.addInputPin("Input2 XYZ",[],VVVV.PinTypes.Value),f=this.addOutputPin("Output",[0],VVVV.PinTypes.Value);this.evaluate=function(){for(var d=this.getMaxInputSliceCount(),c=0;c<d/3;c++){var g=h.getValue(c,3),b=e.getValue(c,3);f.setValue(c,
g[0]*b[0]+g[1]*b[1]+g[2]*b[2])}f.setSliceCount(Math.ceil(d/3))}};VVVV.Nodes.Multiply3dDot.prototype=new VVVV.Core.Node;
VVVV.Nodes.Multiply3dVector=function(b,a){this.constructor(b,"Multiply (3d Vector)",a);this.meta={authors:["Matthias Zauner"],original_authors:["VVVV Group"],credits:[],compatibility_issues:[]};this.auto_evaluate=!1;var h=this.addInputPin("Transform",[],VVVV.PinTypes.Transform),e=this.addInputPin("XYZ UnTransformed",[0,0,0],VVVV.PinTypes.Value),f=this.addOutputPin("XYZ Transformed",[0,0,0],VVVV.PinTypes.Value);this.evaluate=function(){for(var d=Math.max(h.getSliceCount(),e.getSliceCount()/3),c=0;c<
d;c++){var g=e.getValue(3*c,3),b=h.getValue(c);mat4.multiplyVec3(b,g);f.setValue(3*c+0,g[0]);f.setValue(3*c+1,g[1]);f.setValue(3*c+2,g[2])}f.setSliceCount(Math.ceil(3*d))}};VVVV.Nodes.Multiply3dVector.prototype=new VVVV.Core.Node;VVVV.Nodes.LFO=function(b,a){this.constructor(b,"LFO (Animation)",a);this.meta={authors:["Matthias Zauner, sebl"],original_authors:["VVVV Group"],credits:[],compatibility_issues:["Not spreadable yet"]};this.auto_evaluate=!0;var h=this.addInputPin("Period",[1],VVVV.PinTypes.Value),e=this.addInputPin("Pause",[0],VVVV.PinTypes.Value),f=this.addInputPin("Reverse",[0],VVVV.PinTypes.Value),d=this.addInputPin("Reset",[0],VVVV.PinTypes.Value),c=this.addInputPin("Phase",[0],VVVV.PinTypes.Value),g=this.addOutputPin("Output",
[0],VVVV.PinTypes.Value),m=this.addOutputPin("Cycles",[0],VVVV.PinTypes.Value),q=[],k=[],r=(new Date).getTime(),n=(new Date).getTime();this.evaluate=function(){var b=this.getMaxInputSliceCount();r=(new Date).getTime()-n;for(var a=0;a<b;a++){var v=h.getValue(a%h.values.length),t=e.getValue(a%e.values.length),u=f.getValue(a%f.values.length),w=d.getValue(a%d.values.length),l=c.getValue(a%c.values.length);void 0==q[a]&&(q[a]=0);void 0==k[a]&&(k[a]=0);0.5>t&&(0!=v&&isFinite(v))&&(dv=1/(1E3*v)*r,0<u&&(dv*=
-1),q[a]+=dv,0>q[a]&&(k[a]-=Math.ceil(-q[a]),q[a]=1+q[a]),1<q[a]&&(k[a]+=Math.floor(q[a])));n=(new Date).getTime();0.5<=w&&(q[a]=0,k[a]=0);if(0.5>t||0.5<=w)g.setValue(a,(q[a]+l)%1),m.setValue(a,k[a]);q[a]%=1}g.setSliceCount(b);m.setSliceCount(b);q.splice(b);k.splice(b)}};VVVV.Nodes.LFO.prototype=new VVVV.Core.Node;
VVVV.Nodes.LinearFilter=function(b,a){this.constructor(b,"LinearFilter (Animation)",a);this.meta={authors:["Matthias Zauner"],original_authors:["VVVV Group"],credits:[],compatibility_issues:["Cyclic Pin not implemented","Acceleration Out is not set yet"]};this.auto_evaluate=!0;var h=this.addInputPin("Go To Position",[0],VVVV.PinTypes.Value),e=this.addInputPin("FilterTime",[1],VVVV.PinTypes.Value),f=this.addOutputPin("Position Out",[0],VVVV.PinTypes.Value),d=this.addOutputPin("Velocity Out",[0],VVVV.PinTypes.Value);
this.addOutputPin("Acceleration Out",[0],VVVV.PinTypes.Value);var c=[],g=[],m=[],q=[],k=[],r=[];this.evaluate=function(){for(var b=this.getMaxInputSliceCount(),a=h.pinIsChanged()||e.pinIsChanged(),s=0;s<b;s++){void 0==c[s]&&(c[s]=(new Date).getTime());var v=this.parentPatch.mainloop.deltaT,t=parseFloat(h.getValue(s)),u=parseFloat(e.getValue(s));void 0==q[s]&&(q[s]=t);if(t!=g[s]||u!=m[s])r[s]=void 0,g[s]=t,m[s]=u,k[s]=0<m[s]?(g[s]-q[s])/(1E3*m[s]):0;Math.abs(k[s]*v)>Math.abs(g[s]-q[s])?q[s]=g[s]:q[s]+=
k[s]*v;0!=r[s]&&(f.setValue(s,q[s]),d.setValue(s,k[s]));r[s]=g[s]-q[s];c[s]=(new Date).getTime()}a&&f.getSliceCount()!=b&&(g.splice(b),m.splice(b),c.splice(b),q.splice(b),k.splice(b),r.splice(b),f.setSliceCount(b))}};VVVV.Nodes.LinearFilter.prototype=new VVVV.Core.Node;
VVVV.Nodes.Damper=function(b,a){this.constructor(b,"Damper (Animation)",a);this.meta={authors:["Matthias Zauner"],original_authors:["VVVV Group"],credits:[],compatibility_issues:["Cyclic Pin not implemented","Acceleration Out is not set yet"]};this.auto_evaluate=!0;var h=this.addInputPin("Go To Position",[0],VVVV.PinTypes.Value),e=this.addInputPin("FilterTime",[1],VVVV.PinTypes.Value),f=this.addOutputPin("Position Out",[0],VVVV.PinTypes.Value),d=this.addOutputPin("Velocity Out",[0],VVVV.PinTypes.Value);
this.addOutputPin("Acceleration Out",[0],VVVV.PinTypes.Value);var c=[],g=[],m=[],q=[];this.evaluate=function(){for(var b=this.getMaxInputSliceCount(),a=h.pinIsChanged()||e.pinIsChanged(),n=0;n<b;n++){void 0==c[n]&&(c[n]=(new Date).getTime());var p=this.parentPatch.mainloop.deltaT,s=parseFloat(h.getValue(n)),v=parseFloat(e.getValue(n));void 0==g[n]&&(g[n]=s);m[n]=0<v?(s-g[n])/(1E3*v):0;Math.abs(m[n]*p)>Math.abs(s-g[n])?g[n]=s:g[n]+=m[n]*p;0!=q[n]&&(f.setValue(n,g[n]),d.setValue(n,m[n]));q[n]=s-g[n];
c[n]=(new Date).getTime()}a&&f.getSliceCount()!=b&&(c.splice(b),g.splice(b),m.splice(b),q.splice(b),f.setSliceCount(b))}};VVVV.Nodes.Damper.prototype=new VVVV.Core.Node;
VVVV.Nodes.Delay=function(b,a){this.constructor(b,"Delay (Animation)",a);this.meta={authors:["Matthias Zauner"],original_authors:["VVVV Group"],credits:[],compatibility_issues:["Reset not implemented","Linear Mode not implemented"]};this.auto_evaluate=!0;var h=this.addInputPin("Input",[0],VVVV.PinTypes.Value),e=this.addInputPin("Time",[1],VVVV.PinTypes.Value),f=this.addInputPin("Insert",[1],VVVV.PinTypes.Value),d=this.addOutputPin("Output",[0],VVVV.PinTypes.Value),c=[],g=Array(1024);this.evaluate=
function(){var b=this.getMaxInputSliceCount();now=(new Date).getTime();var a=h.pinIsChanged();if(void 0==h.getValue(0))a&&d.setValue(0,void 0);else{if(1==f.getValue(0)&&(a||e.pinIsChanged()))for(g.pop(),g.unshift(now),a=0;a<b;a++){if(void 0==c[a]){c[a]=Array(1024);for(var k=1024;k--;)c[a][k]=0}1024<=c[a].length&&c[a].pop();c[a].unshift(h.getValue(a))}for(a=0;a<b;a++){for(var r=now-1E3*e.getValue(a),n=!1,k=0;1024>k;k++)if(g[k]<=r){d.values[a]!=c[a][k]&&d.setValue(a,c[a][k]);n=!0;break}n||0==d.values[a]||
d.setValue(a,0)}d.setSliceCount(b);c.splice(b)}}};VVVV.Nodes.Delay.prototype=new VVVV.Core.Node;
VVVV.Nodes.Change=function(b,a){this.constructor(b,"Change (Animation)",a);this.meta={authors:["Matthias Zauner"],original_authors:["VVVV Group"],credits:[],compatibility_issues:[]};this.auto_evaluate=!0;var h=this.addInputPin("Input",[0],VVVV.PinTypes.Value),e=this.addOutputPin("OnChange",[0],VVVV.PinTypes.Value),f=[];this.evaluate=function(){var d=this.getMaxInputSliceCount();if(h.pinIsChanged()){for(var c=0;c<d;c++)f[c]!=h.getValue(c)?e.setValue(c,1):1==e.getValue(c)&&e.setValue(c,0),f[c]=h.getValue(c);
e.setSliceCount(d)}else{for(c=0;c<d;c++)1==e.getValue(c)&&(e.setValue(c,0),e.setSliceCount(d));f[c]=h.getValue(c)}}};VVVV.Nodes.Change.prototype=new VVVV.Core.Node;
VVVV.Nodes.TogEdge=function(b,a){this.constructor(b,"TogEdge (Animation)",a);this.meta={authors:["Matthias Zauner"],original_authors:["VVVV Group"],credits:[],compatibility_issues:[]};this.auto_evaluate=!0;var h=this.addInputPin("Input",[0],VVVV.PinTypes.Value),e=this.addOutputPin("Up Edge",[0],VVVV.PinTypes.Value),f=this.addOutputPin("Down Edge",[0],VVVV.PinTypes.Value),d=[];this.evaluate=function(){for(var c=this.getMaxInputSliceCount(),g=0;g<c;g++)(0>=Math.round(d[g])||void 0==d[g])&&1<=Math.round(h.getValue(g))?
e.setValue(g,1):0!=e.values[g]&&e.setValue(g,0),1<=Math.round(d[g])&&0>=Math.round(h.getValue(g))?f.setValue(g,1):0!=f.values[g]&&f.setValue(g,0),d[g]=h.getValue(g);e.setSliceCount(c);f.setSliceCount(c)}};VVVV.Nodes.TogEdge.prototype=new VVVV.Core.Node;
VVVV.Nodes.FlipFlop=function(b,a){this.constructor(b,"FlipFlop (Animation)",a);this.meta={authors:["Matthias Zauner"],original_authors:["VVVV Group"],credits:[],compatibility_issues:[]};var h=this.addInputPin("Set",[0],VVVV.PinTypes.Value),e=this.addInputPin("Reset",[0],VVVV.PinTypes.Value),f=this.addOutputPin("Output",[0],VVVV.PinTypes.Value),d=this.addOutputPin("Inverse Output",[1],VVVV.PinTypes.Value),c=!1;this.evaluate=function(){var g=this.getMaxInputSliceCount(),b=f.getSliceCount();if(g>b)for(;b<
g;b++)f.setValue(b,0),d.setValue(b,1);for(b=0;b<g;b++){var a=void 0;1<=Math.round(e.getValue(b))&&(a=0);1<=Math.round(h.getValue(b))&&(a=1);void 0!=a?(f.setValue(b,a),d.setValue(b,1-a)):c||(f.setValue(b,0),d.setValue(b,1))}f.setSliceCount(g);d.setSliceCount(g);c=!0}};VVVV.Nodes.FlipFlop.prototype=new VVVV.Core.Node;
VVVV.Nodes.SampleAndHold=function(b,a){this.constructor(b,"S+H (Animation)",a);this.meta={authors:["Matthias Zauner"],original_authors:["VVVV Group"],credits:[],compatibility_issues:["different output slice count in pure VVVV, if Set pin has only one slice"]};var h=this.addInputPin("Input",[0],VVVV.PinTypes.Value),e=this.addInputPin("Set",[0],VVVV.PinTypes.Value),f=this.addOutputPin("Output",[0],VVVV.PinTypes.Value);this.evaluate=function(){var d=this.getMaxInputSliceCount();if(e.pinIsChanged()||
h.pinIsChanged()){for(var c=0;c<d;c++)void 0==f.values[c]&&f.setValue(c,0),1<=Math.round(e.getValue(c))&&f.setValue(c,h.getValue(c));f.setSliceCount(d)}}};VVVV.Nodes.SampleAndHold.prototype=new VVVV.Core.Node;
VVVV.Nodes.FrameDelay=function(b,a){this.constructor(b,"FrameDelay (Animation)",a);this.meta={authors:["Matthias Zauner"],original_authors:["VVVV Group"],credits:[],compatibility_issues:["no dynamice pin count"]};this.delays_output=!0;var h=this.addInputPin("Input 1",[0],VVVV.PinTypes.Value),e=this.addInputPin("Default 1",[0],VVVV.PinTypes.Value),f=this.addInputPin("Initialize",[0],VVVV.PinTypes.Value),d=this.addOutputPin("Output 1",[0],VVVV.PinTypes.Value);this.evaluate=function(){for(var c=this.getMaxInputSliceCount(),
g=0;g<c;g++)0.5<f.getValue(g)?d.setValue(g,e.getValue(g)):d.setValue(g,h.getValue(g));d.setSliceCount(c)}};VVVV.Nodes.FrameDelay.prototype=new VVVV.Core.Node;
VVVV.Nodes.Toggle=function(b,a){this.constructor(b,"Toggle (Animation)",a);this.meta={authors:["David M\u00f3r\u00e1sz (micro.D)"],original_authors:["VVVV Group"],credits:["Matthias Zauner"],compatibility_issues:[]};this.auto_evaluate=!0;var h=this.addInputPin("Input",[0],VVVV.PinTypes.Value),e=this.addInputPin("Reset",[0],VVVV.PinTypes.Value),f=this.addOutputPin("Output",[0],VVVV.PinTypes.Value),d=this.addOutputPin("Inverse Output",[1],VVVV.PinTypes.Value),c=!1;this.evaluate=function(){var g=this.getMaxInputSliceCount(),
b=f.getSliceCount();if(g>b)for(;b<g;b++)f.setValue(b,0),d.setValue(b,1);for(b=0;b<g;b++){var a=void 0;1<=Math.round(e.getValue(b))&&(a=0);1<=Math.round(h.getValue(b))&&(a=1-parseFloat(f.getValue(b)));void 0!=a&&f.getValue(b)!=a?(f.setValue(b,a),d.setValue(b,1-a)):c||(f.setValue(b,0),d.setValue(b,1))}f.setSliceCount(g);d.setSliceCount(g);c=!0}};VVVV.Nodes.Toggle.prototype=new VVVV.Core.Node;
VVVV.Nodes.Counter=function(b,a){this.constructor(b,"Counter (Animation)",a);this.meta={authors:["David M\u00f3r\u00e1sz (micro.D)","Matthias Zauner"],original_authors:["VVVV Group"],credits:[],compatibility_issues:[]};this.auto_evaluate=!0;var h=this.addInputPin("Up",[0],VVVV.PinTypes.Value),e=this.addInputPin("Down",[0],VVVV.PinTypes.Value),f=this.addInputPin("Minimum",[0],VVVV.PinTypes.Value),d=this.addInputPin("Maximum",[15],VVVV.PinTypes.Value),c=this.addInputPin("Increment",[1],VVVV.PinTypes.Value),
g=this.addInputPin("Default",[0],VVVV.PinTypes.Value),m=this.addInputPin("Reset",[0],VVVV.PinTypes.Value),q=this.addInputPin("Mode",["Wrap"],VVVV.PinTypes.Enum);q.enumOptions=["Wrap","Unlimited","Clamp"];var k=this.addOutputPin("Output",[0],VVVV.PinTypes.Value),r=this.addOutputPin("Underflow",[0],VVVV.PinTypes.Value),n=this.addOutputPin("Overflow",[0],VVVV.PinTypes.Value),p=!1;this.evaluate=function(){for(var b=this.getMaxInputSliceCount(),a=f.pinIsChanged()||d.pinIsChanged()||g.pinIsChanged()||m.pinIsChanged()||
q.pinIsChanged(),t=0;t<b;t++)1!=n.getValue(t)&&p||n.setValue(t,0),1!=r.getValue(t)&&p||r.setValue(t,0),p||k.setValue(t,0),a=a||0.5<=h.getValue(t)||0.5<=e.getValue(t);if(a){for(t=0;t<b;t++){var a=parseFloat(c.getValue(t)),u=t>=k.getSliceCount()?0:parseFloat(k.getValue(t)),w=parseFloat(d.getValue(t)),l=parseFloat(f.getValue(t)),z=0;"Unlimited"==q.getValue(t)&&(z=1);"Clamp"==q.getValue(t)&&(z=2);switch(z){case 1:0.5<=h.getValue(t)&&(u+=a);0.5<=e.getValue(t)&&(u-=a);break;case 2:0.5<=h.getValue(t)&&(u+=
a);0.5<=e.getValue(t)&&(u-=a);u>w&&(u=w,n.setValue(t,1));u<l&&(u=l,r.setValue(t,1));break;default:0.5<=h.getValue(t)&&(u+=a),0.5<=e.getValue(t)&&(u-=a),u>w&&(u=l,n.setValue(t,1)),u<l&&(u=w,r.setValue(t,1))}k.getValue(t)!=u&&k.setValue(t,u);0.5<=m.getValue(t)&&k.setValue(t,g.getValue(t))}k.setSliceCount(b);r.setSliceCount(b);n.setSliceCount(b)}p=!0}};VVVV.Nodes.Counter.prototype=new VVVV.Core.Node;VVVV.Nodes.CurrentTimeAstronomy=function(b,a){this.constructor(b,"CurrentTime (Astronomy)",a);this.meta={authors:["Zauner"],original_authors:["VVVV Group"],credits:["http://javascript.about.com/library/bldst.htm"],compatibility_issues:["Time Zone index differs from classic VVVV","Time Zone Name does not work in Firefox"]};this.auto_evaluate=!0;var h=new Date,e=this.addOutputPin("GMT",[],VVVV.PinTypes.Value),f=this.addOutputPin("Time Zone",[0],VVVV.PinTypes.Value),d=this.addOutputPin("Time Zone Name",
[""],VVVV.PinTypes.String);this.addOutputPin("Daylight Saving Time",[h.getTimezoneOffset()<function(c){var d=new Date(c.getFullYear(),0,1);c=new Date(c.getFullYear(),6,1);return Math.max(d.getTimezoneOffset(),c.getTimezoneOffset())}(h)?1:0],VVVV.PinTypes.Value);var c=this.addOutputPin("Current Time",[],VVVV.PinTypes.Value);this.evaluate=function(){var g=new Date,b=36E5*g.getTimezoneOffset(),a=g.getTime();e.setValue(0,a/1E3/60/60/24+25569);f.setValue(0,b/1E3/60/60);g.toString().match(/\((.+)\)$/)?
d.setValue(0,g.toString().match(/\((.+)\)$/)[1]):d.setValue(0,"n/a");c.setValue(0,(a-b)/1E3/60/60/24+25569)}};VVVV.Nodes.CurrentTimeAstronomy.prototype=new VVVV.Core.Node;
VVVV.Nodes.GregorianAstronomySplit=function(b,a){this.constructor(b,"Gregorian (Astronomy Split)",a);this.meta={authors:["Zauner"],original_authors:["VVVV Group"],credits:[],compatibility_issues:[]};this.auto_evaluate=!1;var h=this.addInputPin("Time",[41491.4301],VVVV.PinTypes.Value),e=this.addOutputPin("Millisecond",[0],VVVV.PinTypes.Value),f=this.addOutputPin("Second",[0],VVVV.PinTypes.Value),d=this.addOutputPin("Minute",[0],VVVV.PinTypes.Value),c=this.addOutputPin("Hour",[0],VVVV.PinTypes.Value),
g=this.addOutputPin("DayOfWeek",[0],VVVV.PinTypes.Value),m=this.addOutputPin("Day",[1],VVVV.PinTypes.Value),q=this.addOutputPin("Month",[1],VVVV.PinTypes.Value),k=this.addOutputPin("Year",[2E3],VVVV.PinTypes.Value);this.evaluate=function(){for(var b=this.getMaxInputSliceCount(),a=0;a<b;a++){var p=864E5*(h.getValue(a)-25569),p=new Date(p);x=p.getMilliseconds();x!=e.values[a]&&e.setValue(a,x);x=p.getSeconds();x!=f.values[a]&&f.setValue(a,x);x=p.getMinutes();x!=d.values[a]&&d.setValue(a,x);x=p.getHours();
x!=c.values[a]&&c.setValue(a,x);x=p.getDay();x!=g.values[a]&&g.setValue(a,x);x=p.getDate();x!=m.values[a]&&m.setValue(a,x);x=p.getMonth()+1;x!=q.values[a]&&q.setValue(a,x);x=p.getYear()+1900;x!=k.values[a]&&k.setValue(a,x)}e.setSliceCount(b);f.setSliceCount(b);d.setSliceCount(b);c.setSliceCount(b);g.setSliceCount(b);m.setSliceCount(b);q.setSliceCount(b);k.setSliceCount(b)}};VVVV.Nodes.GregorianAstronomySplit.prototype=new VVVV.Core.Node;VVVV.Nodes.And=function(b,a){this.constructor(b,"AND (Boolean)",a);this.meta={authors:["Matthias Zauner"],original_authors:["VVVV Group"],credits:[],compatibility_issues:[]};var h=this.addInvisiblePin("Input Count",[2],VVVV.PinTypes.Value),e=[],f=this.addOutputPin("Output",[1],VVVV.PinTypes.Value);this.initialize=function(){var d=Math.max(2,h.getValue(0));VVVV.Helpers.dynamicPins(this,e,d,function(c){return this.addInputPin("Input "+(c+1),[1],VVVV.PinTypes.Value)})};this.evaluate=function(){h.pinIsChanged()&&
this.initialize();for(var d=this.getMaxInputSliceCount(),c=e.length,g,b=0;b<d;b++){g=!0;for(var a=0;a<c;a++)g=g&&0.5<=e[a].getValue(b);f.setValue(b,g?1:0)}f.setSliceCount(d)}};VVVV.Nodes.And.prototype=new VVVV.Core.Node;
VVVV.Nodes.Or=function(b,a){this.constructor(b,"OR (Boolean)",a);this.meta={authors:["Matthias Zauner"],original_authors:["VVVV Group"],credits:[],compatibility_issues:[]};var h=this.addInvisiblePin("Input Count",[2],VVVV.PinTypes.Value),e=[],f=this.addOutputPin("Output",[1],VVVV.PinTypes.Value);this.initialize=function(){var d=Math.max(2,h.getValue(0));VVVV.Helpers.dynamicPins(this,e,d,function(c){return this.addInputPin("Input "+(c+1),[1],VVVV.PinTypes.Value)})};this.evaluate=function(){h.pinIsChanged()&&
this.initialize();for(var d=this.getMaxInputSliceCount(),c=e.length,g,b=0;b<d;b++){g=!1;for(var a=0;a<c;a++)g=g||0.5<=e[a].getValue(b);f.setValue(b,g?1:0)}f.setSliceCount(d)}};VVVV.Nodes.Or.prototype=new VVVV.Core.Node;
VVVV.Nodes.Not=function(b,a){this.constructor(b,"NOT (Boolean)",a);this.meta={authors:["Matthias Zauner"],original_authors:["VVVV Group"],credits:[],compatibility_issues:[]};var h=this.addInputPin("Input",[1],VVVV.PinTypes.Value),e=this.addOutputPin("Output",[1],VVVV.PinTypes.Value);this.evaluate=function(){for(var f=this.getMaxInputSliceCount(),d=0;d<f;d++)e.setValue(d,1-Math.round(parseFloat(h.getValue(d))));e.setSliceCount(this.getMaxInputSliceCount())}};VVVV.Nodes.Not.prototype=new VVVV.Core.Node;
VVVV.Nodes.OrSpectral=function(b,a){this.constructor(b,"OR (Boolean Spectral)",a);this.meta={authors:["Matthias Zauner"],original_authors:["VVVV Group"],credits:[],compatibility_issues:[]};var h=this.addInputPin("Input",[0],VVVV.PinTypes.Value),e=this.addInputPin("Bin Size",[-1],VVVV.PinTypes.Value),f=this.addOutputPin("Output",[0],VVVV.PinTypes.Value);this.evaluate=function(){for(var d=this.getMaxInputSliceCount(),c=0,g=0,b=!1,a=0;a<d||0<e.getValue(0)&&(0<g||0!=c%e.values.length);a++)0==g&&(b=!1),
b=b||0.5<=h.getValue(a),g++,0<e.getValue(0)?g>=e.getValue(c)&&(f.setValue(c,b?1:0),c++,g=0):f.setValue(0,b?1:0);f.setSliceCount(c+(0<g))}};VVVV.Nodes.OrSpectral.prototype=new VVVV.Core.Node;
VVVV.Nodes.AndSpectral=function(b,a){this.constructor(b,"AND (Boolean Spectral)",a);this.meta={authors:["Matthias Zauner"],original_authors:["VVVV Group"],credits:[],compatibility_issues:[]};var h=this.addInputPin("Input",[0],VVVV.PinTypes.Value),e=this.addInputPin("Bin Size",[-1],VVVV.PinTypes.Value),f=this.addOutputPin("Output",[0],VVVV.PinTypes.Value);this.evaluate=function(){for(var d=this.getMaxInputSliceCount(),c=0,g=0,b=!1,a=0;a<d||0<e.getValue(0)&&(0<g||0!=c%e.values.length);a++)0==g&&(b=
!0),b=b&&0.5<=h.getValue(a),g++,0<e.getValue(0)?g>=e.getValue(c)&&(f.setValue(c,b?1:0),c++,g=0):f.setValue(0,b?1:0);f.setSliceCount(c+(0<g))}};VVVV.Nodes.AndSpectral.prototype=new VVVV.Core.Node;VVVV.Types.CanvasTexture={imageObject:void 0,loaded:!1};
VVVV.Types.CanvasRenderState=function(){this.fillColor=[1,1,1,1];this.strokeColor=[0,0,0,0];this.lineWidth=1;this.capStyle="butt";this.joinStyle="miter";this.gradient={type:"none"};this.shadowBlur=this.shadowOffsetY=this.shadowOffsetX=0;this.shadowColor=[0,0,0,1];this.blendMode="source-over";this.copy_attributes=function(b){this.fillColor=b.fillColor;this.strokeColor=b.strokeColor;this.lineWidth=b.lineWidth;this.capStyle=b.capStyle;this.joinStyle=b.joinStyle;this.gradient=b.gradient;this.shadowOffsetX=
b.shadowOffsetX;this.shadowOffsetY=b.shadowOffsetY;this.shadowBlur=b.shadowBlur;this.shadowColor=b.shadowColor;this.blendMode=b.blendMode};this.apply=function(b){if("none"!=this.gradient.type){if("linear"==this.gradient.type)var a=b.createLinearGradient(this.gradient.startX,this.gradient.startY,this.gradient.endX,this.gradient.endY);for(var h=Math.max(this.gradient.colors.length,this.gradient.colorPositions.length),e=0;e<h;e++){var f=this.gradient.colors[e];a.addColorStop(this.gradient.colorPositions[e],
"rgba("+parseInt(255*f[0])+","+parseInt(255*f[1])+","+parseInt(255*f[2])+","+f[3]+")")}b.fillStyle=a}else b.fillStyle="rgba("+parseInt(255*this.fillColor[0])+","+parseInt(255*this.fillColor[1])+","+parseInt(255*this.fillColor[2])+","+this.fillColor[3]+")";b.strokeStyle="rgba("+parseInt(255*this.strokeColor[0])+","+parseInt(255*this.strokeColor[1])+","+parseInt(255*this.strokeColor[2])+","+this.strokeColor[3]+")";b.lineWidth=this.lineWidth/b.canvas.height;b.lineCap=this.capStyle;b.lineJoin=this.joinStyle;
b.shadowOffsetX=this.shadowOffsetX;b.shadowOffsetY=this.shadowOffsetY;b.shadowBlur=this.shadowBlur;b.shadowColor="rgba("+parseInt(255*this.shadowColor[0])+","+parseInt(255*this.shadowColor[1])+","+parseInt(255*this.shadowColor[2])+","+this.shadowColor[3]+")";b.globalCompositeOperation=this.blendMode}};var defaultRenderState=new VVVV.Types.CanvasRenderState,invisibleRenderState=new VVVV.Types.CanvasRenderState;invisibleRenderState.fillColor=[0,0,0,0];
VVVV.PinTypes.CanvasRenderState={typeName:"CanvasRenderState",reset_on_disconnect:!0,defaultValue:function(){return defaultRenderState}};var defaultCanvasLayer=function(){this.draw=function(){}};VVVV.PinTypes.CanvasLayer={typeName:"CanvasLayer",reset_on_disconnect:!0,defaultValue:defaultCanvasLayer};
VVVV.Nodes.FillCanvas=function(b,a){this.constructor(b,"Fill (Canvas VVVVjs RenderState)",a);this.meta={authors:["Matthias Zauner"],original_authors:[],credits:[],compatibility_issues:[]};var h=this.addInputPin("Render State In",[],VVVV.PinTypes.CanvasRenderState),e=this.addInputPin("Color",["1.0, 1.0, 1.0, 1.0"],VVVV.PinTypes.Color),f=this.addOutputPin("Render State Out",[],VVVV.PinTypes.CanvasRenderState),d=[];this.evaluate=function(){for(var c=this.getMaxInputSliceCount(),g=0;g<c;g++)void 0==d[g]&&
(d[g]=new VVVV.Types.CanvasRenderState),d[g].copy_attributes(h.getValue(g)),d[g].fillColor=e.getValue(g).split(","),f.setValue(g,d[g]);f.setSliceCount(c)}};VVVV.Nodes.FillCanvas.prototype=new VVVV.Core.Node;
VVVV.Nodes.StrokeCanvas=function(b,a){this.constructor(b,"Stroke (Canvas VVVVjs RenderState)",a);this.meta={authors:["Matthias Zauner"],original_authors:[],credits:[],compatibility_issues:[]};var h=this.addInputPin("Render State In",[],VVVV.PinTypes.CanvasRenderState),e=this.addInputPin("Color",["1.0, 1.0, 1.0, 1.0"],VVVV.PinTypes.Color),f=this.addInputPin("Width",[1],VVVV.PinTypes.Value),d=this.addInputPin("Cap Style",["butt"],VVVV.PinTypes.Enum);d.enumOptions=["butt","round","square"];var c=this.addInputPin("Join Style",
["miter"],VVVV.PinTypes.Enum);c.enumOptions=["miter","round","bevel"];var g=this.addOutputPin("Render State Out",[],VVVV.PinTypes.CanvasRenderState),m=[];this.evaluate=function(){for(var b=this.getMaxInputSliceCount(),a=0;a<b;a++)void 0==m[a]&&(m[a]=new VVVV.Types.CanvasRenderState),m[a].copy_attributes(h.getValue(a)),m[a].strokeColor=e.getValue(a).split(","),m[a].lineWidth=f.getValue(a),m[a].capStyle=d.getValue(a),m[a].joinStyle=c.getValue(a),g.setValue(a,m[a]);g.setSliceCount(b)}};
VVVV.Nodes.StrokeCanvas.prototype=new VVVV.Core.Node;
VVVV.Nodes.ShadowCanvas=function(b,a){this.constructor(b,"Shadow (Canvas VVVVjs RenderState)",a);this.meta={authors:["Matthias Zauner"],original_authors:[],credits:[],compatibility_issues:[]};var h=this.addInputPin("Render State In",[],VVVV.PinTypes.CanvasRenderState),e=this.addInputPin("Color",["0.0, 0.0, 0.0, 1.0"],VVVV.PinTypes.Color),f=this.addInputPin("Offset X",[0],VVVV.PinTypes.Value),d=this.addInputPin("Offset Y",[0],VVVV.PinTypes.Value),c=this.addInputPin("Blur",[0],VVVV.PinTypes.Value),
g=this.addOutputPin("Render State Out",[],VVVV.PinTypes.CanvasRenderState),m=[];this.evaluate=function(){for(var b=this.getMaxInputSliceCount(),a=0;a<b;a++)void 0==m[a]&&(m[a]=new VVVV.Types.CanvasRenderState),m[a].copy_attributes(h.getValue(a)),m[a].shadowOffsetX=f.getValue(a),m[a].shadowOffsetY=d.getValue(a),m[a].shadowBlur=c.getValue(a),m[a].shadowColor=e.getValue(a).split(","),g.setValue(a,m[a]);g.setSliceCount(b)}};VVVV.Nodes.ShadowCanvas.prototype=new VVVV.Core.Node;
VVVV.Nodes.BlendCanvas=function(b,a){this.constructor(b,"Blend (Canvas VVVVjs RenderState)",a);this.meta={authors:["Matthias Zauner"],original_authors:[],credits:[],compatibility_issues:[]};var h=this.addInputPin("Render State In",[],VVVV.PinTypes.CanvasRenderState),e=this.addInputPin("Mode",["source-over"],VVVV.PinTypes.Enum);e.enumOptions="source-over source-out source-in source-atop destination-over destination-out destination-in destination-atop copy lighter xor".split(" ");var f=this.addOutputPin("Render State Out",
[],VVVV.PinTypes.CanvasRenderState),d=[];this.evaluate=function(){for(var c=this.getMaxInputSliceCount(),g=0;g<c;g++)void 0==d[g]&&(d[g]=new VVVV.Types.CanvasRenderState),d[g].copy_attributes(h.getValue(g)),d[g].blendMode=e.getValue(g),f.setValue(g,d[g]);f.setSliceCount(c)}};VVVV.Nodes.BlendCanvas.prototype=new VVVV.Core.Node;
VVVV.Nodes.LinearGradientCanvas=function(b,a){this.constructor(b,"LinearGradient (Canvas VVVVjs RenderState)",a);this.meta={authors:["Matthias Zauner"],original_authors:[],credits:[],compatibility_issues:[]};var h=this.addInputPin("Render State In",[],VVVV.PinTypes.CanvasRenderState),e=this.addInputPin("Start X",[0],VVVV.PinTypes.Value),f=this.addInputPin("Start Y",[0],VVVV.PinTypes.Value),d=this.addInputPin("End X",[0],VVVV.PinTypes.Value),c=this.addInputPin("End Y",[0],VVVV.PinTypes.Value),g=this.addInputPin("Colors",
["1.0, 1.0, 1.0, 1.0","0.0, 0.0, 0.0, 1.0"],VVVV.PinTypes.Color),m=this.addInputPin("Color Positions",[0,1],VVVV.PinTypes.Value),q=this.addOutputPin("Render State Out",[],VVVV.PinTypes.CanvasRenderState),k=[];this.evaluate=function(){for(var a=Math.max(h.values.length,e.values.length),a=Math.max(a,f.values.length),a=Math.max(a,d.values.length),a=Math.max(a,c.values.length),b=0;b<a;b++){void 0==k[b]&&(k[b]=new VVVV.Types.CanvasRenderState);k[b].copy_attributes(h.getValue(b));k[b].gradient={type:"linear"};
k[b].gradient.startX=e.getValue(b);k[b].gradient.startY=f.getValue(b);k[b].gradient.endX=d.getValue(b);k[b].gradient.endY=c.getValue(b);k[b].gradient.colors=[];k[b].gradient.colorPositions=[];for(var p=Math.max(g.values.length,m.values.length),s=0;s<p;s++)k[b].gradient.colors.push(g.getValue(s).split(",")),k[b].gradient.colorPositions.push(m.getValue(s));q.setValue(b,k[b])}q.setSliceCount(a)}};VVVV.Nodes.LinearGradientCanvas.prototype=new VVVV.Core.Node;
VVVV.Nodes.ArcCanvas=function(b,a){this.constructor(b,"Arc (Canvas VVVVjs)",a);this.meta={authors:["Matthias Zauner"],original_authors:[],credits:[],compatibility_issues:[]};var h=this.addInputPin("Render State",[],VVVV.PinTypes.CanvasRenderState),e=this.addInputPin("Transform",[],VVVV.PinTypes.Transform),f=this.addInputPin("Clipping Layer",[],VVVV.PinTypes.CanvasLayer),d=this.addInputPin("Radius",[1],VVVV.PinTypes.Value),c=this.addInputPin("Start Angle",[0],VVVV.PinTypes.Value),g=this.addInputPin("End Angle",
[0.5],VVVV.PinTypes.Value),m=this.addInputPin("Draw Segment",[0],VVVV.PinTypes.Value),q=this.addOutputPin("Layer",[],VVVV.PinTypes.CanvasLayer),k=[],r=function(){this.transform=mat4.create();mat4.identity(this.transform);this.startAngle=0;this.endAngle=0.5;this.strokeColor=[1,1,1,1];this.lineWidth=1;this.renderState=defaultRenderState;this.clippingLayer=void 0;this.drawSegment=!1;this.draw=function(c,d){c.save();this.clippingLayer&&(this.clippingLayer.draw(c,!0),c.clip());c.save();this.transform&&
c.transform(this.transform[0],this.transform[1],this.transform[4],this.transform[5],this.transform[12],this.transform[13]);c.beginPath();d?invisibleRenderState.apply(c):this.renderState.apply(c);this.drawSegment&&(c.moveTo(0,0),c.lineTo(Math.cos(this.startAngle)*this.radius,Math.sin(this.startAngle)*this.radius));c.arc(0,0,this.radius,this.startAngle,this.endAngle,!1);this.drawSegment&&(c.moveTo(Math.cos(this.endAngle)*this.radius,Math.sin(this.endAngle)*this.radius),c.lineTo(0,0));0<this.renderState.fillColor[3]&&
c.fill();0<this.renderState.strokeColor[3]&&c.stroke();c.restore();c.restore()}};this.evaluate=function(){for(var b=this.getMaxInputSliceCount(),a=0;a<b;a++)void 0==k[a]&&(k[a]=new r),k[a].transform=e.getValue(a),k[a].radius=parseFloat(d.getValue(a)),k[a].startAngle=2*parseFloat(c.getValue(a))*Math.PI,k[a].endAngle=2*parseFloat(g.getValue(a))*Math.PI,k[a].renderState=h.getValue(a),k[a].drawSegment=1==m.getValue(a),f.isConnected()&&(k[a].clippingLayer=f.getValue(a));for(a=0;a<k.length;a++)q.setValue(a,
k[a]);q.setSliceCount(b)}};VVVV.Nodes.ArcCanvas.prototype=new VVVV.Core.Node;
VVVV.Nodes.RectangleCanvas=function(b,a){this.constructor(b,"Rectangle (Canvas VVVVjs)",a);this.meta={authors:["Matthias Zauner"],original_authors:[],credits:[],compatibility_issues:[]};var h=this.addInputPin("Render State",[],VVVV.PinTypes.CanvasRenderState),e=this.addInputPin("Transform",[],VVVV.PinTypes.Transform),f=this.addInputPin("Clipping Layer",[],VVVV.PinTypes.CanvasLayer),d=this.addInputPin("Width",[1],VVVV.PinTypes.Value),c=this.addInputPin("Height",[1],VVVV.PinTypes.Value),g=this.addInputPin("Corner Radius",
[0],VVVV.PinTypes.Value),m=this.addOutputPin("Layer",[],VVVV.PinTypes.CanvasLayer),q=[],k=function(){this.transform=mat4.create();mat4.identity(this.transform);this.renderState=defaultRenderState;this.clippingLayer=void 0;this.draw=function(c,d){c.save();this.clippingLayer&&(this.clippingLayer.draw(c,!0),c.clip());c.save();this.transform&&c.transform(this.transform[0],this.transform[1],this.transform[4],this.transform[5],this.transform[12],this.transform[13]);c.beginPath();d?invisibleRenderState.apply(c):
this.renderState.apply(c);var g=this.width/2,f=g-this.cornerRadius,e=this.height/2,a=e-this.cornerRadius,b=-g,h=-f,m=-e,k=-a;c.moveTo(h,m);c.lineTo(f,m);c.arc(f,k,this.cornerRadius,1.5*Math.PI,0,!1);c.lineTo(g,a);c.arc(f,a,this.cornerRadius,0,0.5*Math.PI,!1);c.lineTo(h,e);c.arc(h,a,this.cornerRadius,0.5*Math.PI,Math.PI,!1);c.lineTo(b,k);c.arc(h,k,this.cornerRadius,Math.PI,1.5*Math.PI,!1);c.closePath();0<this.renderState.fillColor[3]&&c.fill();0<this.renderState.strokeColor[3]&&c.stroke();c.restore();
c.restore()}};this.evaluate=function(){for(var a=this.getMaxInputSliceCount(),b=0;b<a;b++)void 0==q[b]&&(q[b]=new k),q[b].transform=e.getValue(b),q[b].width=d.getValue(b),q[b].height=c.getValue(b),q[b].cornerRadius=g.getValue(b),q[b].renderState=h.getValue(b),f.isConnected()&&(q[b].clippingLayer=f.getValue(b));for(b=0;b<q.length;b++)m.setValue(b,q[b]);m.setSliceCount(a)}};VVVV.Nodes.RectangleCanvas.prototype=new VVVV.Core.Node;
VVVV.Nodes.TextCanvas=function(b,a){this.constructor(b,"Text (Canvas VVVVjs)",a);this.meta={authors:["Matthias Zauner"],original_authors:[],credits:[],compatibility_issues:[]};var h=this.addInputPin("Render State",[],VVVV.PinTypes.CanvasRenderState),e=this.addInputPin("Transform",[],VVVV.PinTypes.Transform),f=this.addInputPin("Clipping Layer",[],VVVV.PinTypes.CanvasLayer),d=this.addInputPin("Text",["VVVV.js"],VVVV.PinTypes.String),c=this.addInputPin("Font",["10px sans-serif"],VVVV.PinTypes.String),
g=this.addInputPin("Align",["start"],VVVV.PinTypes.Enum);g.enumOptions=["start","left","end","right","center"];var m=this.addInputPin("Baseline",["alphabetic"],VVVV.PinTypes.Enum);m.enumOptions="top hanging middle alphabetic ideographic bottom".split(" ");var q=this.addOutputPin("Layer",[],VVVV.PinTypes.CanvasLayer),k=[],r=function(){this.transform=mat4.create();mat4.identity(this.transform);this.text="VVVV.js";this.font="sans-serif";this.align="start";this.baseline="top";this.renderState=defaultRenderState;
this.clippingLayer=void 0;this.draw=function(c,d){c.save();this.clippingLayer&&(this.clippingLayer.draw(c,!0),c.clip());c.save();this.transform&&c.transform(this.transform[0],this.transform[1],this.transform[4],this.transform[5],this.transform[12],this.transform[13]);c.scale(0.01,-0.01);c.font="100px "+this.font;c.textAlign=this.align;c.textBaseline=this.baseline;d?invisibleRenderState.apply(c):this.renderState.apply(c);0<this.renderState.fillColor[3]&&c.fillText(this.text,0,0);0<this.renderState.strokeColor[3]&&
c.strokeText(this.text,0,0);c.restore();c.restore()}};this.evaluate=function(){for(var a=this.getMaxInputSliceCount(),b=0;b<a;b++)void 0==k[b]&&(k[b]=new r),k[b].transform=e.getValue(b),k[b].text=d.getValue(b),k[b].font=c.getValue(b),k[b].align=g.getValue(b),k[b].baseline=m.getValue(b),k[b].renderState=h.getValue(b),k[b].clippingLayer=f.getValue(b);for(b=0;b<k.length;b++)q.setValue(b,k[b]);q.setSliceCount(a)}};VVVV.Nodes.TextCanvas.prototype=new VVVV.Core.Node;
VVVV.Nodes.BezierCurveCanvas=function(b,a){function h(c,d){c.x.splice(d);c.y.splice(d);c.c1x.splice(d);c.c1y.splice(d);c.c2x.splice(d);c.c2y.splice(d)}this.constructor(b,"BezierCurve (Canvas VVVVjs)",a);this.meta={authors:["Matthias Zauner"],original_authors:[],credits:[],compatibility_issues:[]};var e=this.addInputPin("Render State",[],VVVV.PinTypes.CanvasRenderState),f=this.addInputPin("Transform",[],VVVV.PinTypes.Transform),d=this.addInputPin("Clipping Layer",[],VVVV.PinTypes.CanvasLayer),c=this.addInputPin("X",
[0],VVVV.PinTypes.Value),g=this.addInputPin("Y",[0],VVVV.PinTypes.Value),m=this.addInputPin("Control 1 X",[0],VVVV.PinTypes.Value),q=this.addInputPin("Control 1 Y",[0],VVVV.PinTypes.Value),k=this.addInputPin("Control 2 X",[0],VVVV.PinTypes.Value),r=this.addInputPin("Control 2 Y",[0],VVVV.PinTypes.Value),n=this.addInputPin("BinSize",[-1],VVVV.PinTypes.Value),p=this.addOutputPin("Layer",[],VVVV.PinTypes.CanvasLayer),s=[],v=function(){this.transform=mat4.create();mat4.identity(this.transform);this.x=
[];this.y=[];this.c1x=[];this.c1y=[];this.c2x=[];this.c2y=[];this.strokeColor=[1,1,1,1];this.lineWidth=1;this.fillColor=[1,1,1,1];this.renderState=defaultRenderState;this.clippingLayer=void 0;this.draw=function(c,d){if(!(1>this.x.length)){c.save();this.clippingLayer&&(this.clippingLayer.draw(c,!0),c.clip());d?invisibleRenderState.apply(c):this.renderState.apply(c);c.save();this.transform&&c.transform(this.transform[0],this.transform[1],this.transform[4],this.transform[5],this.transform[12],this.transform[13]);
c.beginPath();c.moveTo(this.x[0],this.y[0]);for(var g=1;g<this.x.length;g++)c.bezierCurveTo(this.c1x[g-1]+this.x[g-1],this.c1y[g-1]+this.y[g-1],this.c2x[g]+this.x[g],this.c2y[g]+this.y[g],this.x[g],this.y[g]);0<this.renderState.fillColor[3]&&c.fill();0<this.renderState.strokeColor[3]&&c.stroke();c.restore();c.restore()}}};this.evaluate=function(){for(var b=this.getMaxInputSliceCount(),a=0,w=0,l=0;l<b||0<n.getValue(0)&&(0<w||0<a%f.getSliceCount());l++)void 0==s[a]&&(s[a]=new v),0==w&&(s[a].renderState=
e.getValue(a),s[a].transform=f.getValue(a),d.isConnected()&&(s[a].clippingLayer=d.getValue(a))),s[a].x[w]=parseFloat(c.getValue(l)),s[a].y[w]=parseFloat(g.getValue(l)),s[a].c1x[w]=parseFloat(m.getValue(l)),s[a].c1y[w]=parseFloat(q.getValue(l)),s[a].c2x[w]=parseFloat(k.getValue(l)),s[a].c2y[w]=parseFloat(r.getValue(l)),w++,0<n.getValue(0)&&w>=n.getValue(a)&&(w<s[a].x.length&&h(s[a],w),a++,w=0);0>n.getValue(0)?w<s[a].x.length&&(h(s[a],w),s.splice(1)):s.splice(a);for(b=0;b<s.length;b++)p.setValue(b,
s[b]);p.setSliceCount(s.length)}};VVVV.Nodes.BezierCurveCanvas.prototype=new VVVV.Core.Node;
VVVV.Nodes.QuadCanvas=function(b,a){this.constructor(b,"Quad (Canvas VVVVjs)",a);this.meta={authors:["Matthias Zauner"],original_authors:[],credits:[],compatibility_issues:[]};var h=this.addInputPin("Transform",[],VVVV.PinTypes.Transform),e=this.addInputPin("Clipping Layer",[],VVVV.PinTypes.CanvasLayer),f=this.addInputPin("Texture",[],VVVV.PinTypes.HTML5Texture),d=this.addInputPin("Color",["1.0, 1.0, 1.0, 1.0"],VVVV.PinTypes.Color),c=this.addOutputPin("Layer",[],VVVV.PinTypes.CanvasLayer),g=[],m=
function(){this.transform=mat4.create();this.clippingLayer=void 0;mat4.identity(this.transform);this.texture=VVVV.PinTypes.HTML5Texture.defaultValue();this.color=[1,1,1,1];this.draw=function(c,d){c.save();this.clippingLayer&&(this.clippingLayer.draw(c,!0),c.clip());c.save();this.transform&&c.transform(this.transform[0],this.transform[1],this.transform[4],this.transform[5],this.transform[12],this.transform[13]);"Empty Texture"!=this.texture?this.texture.loaded&&(c.globalAlpha=this.color[3],c.save(),
c.translate(-0.5,0.5),this.texture.videoWidth?c.scale(1/this.texture.videoWidth,-1/this.texture.videoHeight):c.scale(1/this.texture.width,-1/this.texture.height),c.drawImage(this.texture,0,0),c.restore(),c.fillStyle="rgba(0, 0, 0, .001)",c.fillRect(-0.5,-0.5,1,1),c.globalAlpha=1):(c.fillStyle="rgba("+parseInt(255*this.color[0])+", "+parseInt(255*this.color[1])+", "+parseInt(255*this.color[2])+", "+this.color[3]+")",c.fillRect(-0.5,-0.5,1,1));c.restore();c.restore()}};this.evaluate=function(){for(var b=
this.getMaxInputSliceCount(),a=0;a<b;a++)void 0==g[a]&&(g[a]=new m),g[a].transform=h.getValue(a),g[a].texture=f.getValue(a),g[a].color=d.getValue(a).split(","),e.isConnected()&&(g[a].clippingLayer=e.getValue(a));for(a=0;a<g.length;a++)c.setValue(a,g[a]);c.setSliceCount(b)}};VVVV.Nodes.QuadCanvas.prototype=new VVVV.Core.Node;
VVVV.Nodes.GroupCanvas=function(b,a){this.constructor(b,"Group (Canvas VVVVjs)",a);this.meta={authors:["Matthias Zauner"],original_authors:[],credits:[],compatibility_issues:[]};var h=this.addInvisiblePin("Layer Count",[2],VVVV.PinTypes.Value),e=[],f=this.addOutputPin("Layer",[],VVVV.PinTypes.CanvasLayer);this.initialize=function(){var d=Math.max(2,h.getValue(0));VVVV.Helpers.dynamicPins(this,e,d,function(c){return this.addInputPin("Layer "+(c+1),[],VVVV.PinTypes.CanvasLayer)})};this.evaluate=function(){h.pinIsChanged()&&
this.initialize();for(var d=0,c=e.length,g,a=0;a<c;a++)if(e[a].isConnected()){g=e[a].getSliceCount();for(var b=0;b<g;b++)f.setValue(d++,e[a].getValue(b))}f.setSliceCount(d)}};VVVV.Nodes.GroupCanvas.prototype=new VVVV.Core.Node;
VVVV.Nodes.RendererCanvas=function(b,a){function h(c){$(c).detach("mousemove");$(c).detach("mousedown");$(c).detach("mouseup");VVVV.MousePositions[c.id]={x:0,y:0,wheel:0,lb:0,mb:0,rb:0};$(c).mousemove(function(d){var g=2*(d.pageX-$(this).offset().left)/$(this).width()-1;d=-(2*(d.pageY-$(this).offset().top)/$(this).height()-1);VVVV.MousePositions._all.x=g;VVVV.MousePositions._all.y=d;VVVV.MousePositions[c.id].x=g;VVVV.MousePositions[c.id].y=d});$(c).bind("mousewheel",function(d){d=d.originalEvent.wheelDelta/
120;VVVV.MousePositions[c.id].wheel+=d;VVVV.MousePositions._all.wheel+=d});$(c).bind("DOMMouseScroll",function(d){d=-d.originalEvent.detail/3;VVVV.MousePositions[c.id].wheel+=d;VVVV.MousePositions._all.wheel+=d});$(c).mousedown(function(d){switch(d.which){case 1:VVVV.MousePositions._all.lb=1;VVVV.MousePositions[c.id].lb=1;break;case 2:VVVV.MousePositions._all.mb=1;VVVV.MousePositions[c.id].mb=1;break;case 3:VVVV.MousePositions._all.rb=1,VVVV.MousePositions[c.id].rb=1}});$(c).mouseup(function(d){switch(d.which){case 1:VVVV.MousePositions._all.lb=
0;VVVV.MousePositions[c.id].lb=0;break;case 2:VVVV.MousePositions._all.mb=0;VVVV.MousePositions[c.id].mb=0;break;case 3:VVVV.MousePositions._all.rb=0,VVVV.MousePositions[c.id].rb=0}})}this.constructor(b,"Renderer (Canvas VVVVjs)",a);this.meta={authors:["Matthias Zauner"],original_authors:["VVVV Group"],credits:[],compatibility_issues:[]};var e=this.addInputPin("Layers",[],VVVV.PinTypes.CanvasLayer);this.addInputPin("Clear",[1],VVVV.PinTypes.Value);var f=this.addInputPin("Background Color",["0.0, 0.0, 0.0, 1.0"],
VVVV.PinTypes.Color),d=this.addInputPin("Backbuffer Width",[0],VVVV.PinTypes.Value),c=this.addInputPin("Backbuffer Height",[0],VVVV.PinTypes.Value),g=this.addInputPin("View",[],VVVV.PinTypes.Transform),m=this.addOutputPin("Canvas Out",[],this),q,k,r,n=[0,0,0,1],p;this.getContext=function(){var g=this.invisiblePins["Descriptive Name"].getValue(0);if((g=$(g).get(0))&&"CANVAS"==g.nodeName)p=g;else{var a=parseInt(d.getValue(0)),f=parseInt(c.getValue(0));p=$('<canvas width="'+(0<a?a:512)+'" height="'+
(0<f?f:512)+'" id="vvvv-js-generated-renderer-'+(new Date).getTime()+'" class="vvvv-js-generated-renderer"></canvas>');g||(g="body");$(g).append(p);p=p.get(0)}k=p.width;r=p.height;p&&p.getContext&&(h(p),q=p.getContext("2d"),p.ctx=q)};this.destroy=function(){$(p).remove()};this.evaluate=function(){this.invisiblePins["Descriptive Name"].pinIsChanged()&&($(p).hasClass("vvvv-js-generated-renderer")&&$(p).remove(),this.getContext());if(q){if(d.pinIsChanged()){var a=parseInt(d.getValue(0));0<a&&(k=a,$(p).attr("width",
k))}c.pinIsChanged()&&(a=parseInt(c.getValue(0)),0<a&&(r=a,$(p).attr("height",r)));f.pinIsChanged()&&(n=f.getValue(0).split(","),n[0]=parseInt(255*n[0]),n[1]=parseInt(255*n[1]),n[2]=parseInt(255*n[2]));defaultRenderState.apply(q);q.clearRect(0,0,k,r);q.save();q.translate(k/2,r/2);q.scale(k/2,-r/2);g.isConnected()&&(a=g.getValue(0),q.transform(a[0],a[1],a[4],a[5],a[12],a[13]));if(e.isConnected())for(a=0;a<e.values.length;a++)e.getValue(a).draw(q);q.restore();defaultRenderState.apply(q);q.globalCompositeOperation=
"destination-over";q.fillStyle="rgba("+n[0]+","+n[1]+","+n[2]+","+n[3]+")";q.fillRect(0,0,k,r);m.setValue(0,p);p.loaded=!0}}};VVVV.Nodes.RendererCanvas.prototype=new VVVV.Core.Node;VVVV.PinTypes.Color={typeName:"Color",reset_on_disconnect:!1,defaultValue:function(){return"1.0, 1.0, 1.0, 1.0"},primitive:!0,hsvToRgb:function(b,a,h){b=360*((b%1+1)%1);var e=Math.floor(b/60),f=b/60-e;b=h*(1-a);var d=h*(1-a*f);a=h*(1-a*(1-f));switch(e){case 1:return[d,h,b];case 2:return[b,h,a];case 3:return[b,d,h];case 4:return[a,b,h];case 5:return[h,b,d];default:return[h,a,b]}},rgbToHsv:function(b,a,h){var e=Math.max(b,Math.max(a,h)),f=Math.min(b,Math.min(a,h)),d;e==f?d=0:e==b?d=60*(0+(a-h)/(e-f)):
e==a?d=60*(2+(h-b)/(e-f)):e==h&&(d=60*(4+(b-a)/(e-f)));0>d&&(d+=360);b=0;0!=e&&(b=(e-f)/e);return[d/360,b,e]}};
VVVV.Nodes.RGBJoin=function(b,a){this.constructor(b,"RGB (Color Join)",a);this.meta={authors:["Matthias Zauner"],original_authors:["VVVV Group"],credits:[],compatibility_issues:[]};var h=this.addInputPin("Red",[1],VVVV.PinTypes.Value),e=this.addInputPin("Green",[1],VVVV.PinTypes.Value),f=this.addInputPin("Blue",[1],VVVV.PinTypes.Value),d=this.addInputPin("Alpha",[1],VVVV.PinTypes.Value),c=this.addOutputPin("Output",["1.0,1.0,1.0,1.0"],VVVV.PinTypes.Color);this.evaluate=function(){if(h.pinIsChanged()||
e.pinIsChanged||f.pinIsChanged()||d.pinIsChanged()){for(var g=this.getMaxInputSliceCount(),a=0;a<g;a++){var b=h.getValue(a)||0,k=e.getValue(a)||0,r=f.getValue(a)||0,n=d.getValue(a)||0;c.setValue(a,b+","+k+","+r+","+n)}c.setSliceCount(g)}}};VVVV.Nodes.RGBJoin.prototype=new VVVV.Core.Node;
VVVV.Nodes.HSVJoin=function(b,a){this.constructor(b,"HSV (Color Join)",a);this.meta={authors:["Matthias Zauner"],original_authors:["VVVV Group"],credits:[],compatibility_issues:[]};var h=this.addInputPin("Hue",[0.33],VVVV.PinTypes.Value),e=this.addInputPin("Saturation",[0],VVVV.PinTypes.Value),f=this.addInputPin("Value",[1],VVVV.PinTypes.Value),d=this.addInputPin("Alpha",[1],VVVV.PinTypes.Value),c=this.addOutputPin("Output",["1.0,1.0,1.0,1.0"],VVVV.PinTypes.Color);this.evaluate=function(){for(var g=
this.getMaxInputSliceCount(),a=0;a<g;a++){var b=h.getValue(a),k=e.getValue(a),r=f.getValue(a),n=d.getValue(a),b=VVVV.PinTypes.Color.hsvToRgb(b,k,r);c.setValue(a,b[0]+","+b[1]+","+b[2]+","+n)}c.setSliceCount(g)}};VVVV.Nodes.HSVJoin.prototype=new VVVV.Core.Node;
VVVV.Nodes.IOBoxColor=function(b,a){this.constructor(b,"IOBox (Color)",a);this.meta={authors:["Matthias Zauner"],original_authors:["VVVV Group"],credits:[],compatibility_issues:[]};this.auto_evaluate=!1;var h=this.addInputPin("Color Input",["0.0, 1.0, 0.0, 1.0"],VVVV.PinTypes.Color),e=this.addOutputPin("Color Output",["0.0, 1.0, 0.0, 1.0"],VVVV.PinTypes.Color);this.addInvisiblePin("Rows",[1],VVVV.PinTypes.Value);this.evaluate=function(){for(var a=this.getMaxInputSliceCount(),d=0;d<a;d++)e.setValue(d,
h.getValue(d));e.setSliceCount(a)}};VVVV.Nodes.IOBoxColor.prototype=new VVVV.Core.Node;
VVVV.Nodes.SetAlphaColor=function(b,a){this.constructor(b,"SetAlpha (Color)",a);this.meta={authors:["Zauner"],original_authors:["VVVV Group"],credits:[],compatibility_issues:[]};this.auto_evaluate=!1;var h=this.addInputPin("Input",["0.0, 0.0, 0.0, 0.0"],VVVV.PinTypes.Color),e=this.addInputPin("Alpha",[1],VVVV.PinTypes.Value),f=this.addOutputPin("Output",["0.0, 0.0, 0.0, 1.0"],VVVV.PinTypes.Color);this.evaluate=function(){for(var d=this.getMaxInputSliceCount(),c=0;c<d;c++){var g=h.getValue(c),a=e.getValue(c);
f.setValue(c,g.replace(/[^, ]+$/,a))}f.setSliceCount(d)}};VVVV.Nodes.SetAlphaColor.prototype=new VVVV.Core.Node;
VVVV.Nodes.SwitchColorInput=function(b,a){this.constructor(b,"Switch (Color Input)",a);this.meta={authors:["Zauner"],original_authors:["VVVV Group"],credits:[],compatibility_issues:[]};this.auto_evaluate=!1;var h=this.addInputPin("Switch",[0],VVVV.PinTypes.Value),e=[];e[0]=this.addInputPin("Input 1",["1.0, 1.0, 1.0, 1.0"],VVVV.PinTypes.Color);e[1]=this.addInputPin("Input 2",["1.0, 1.0, 1.0, 1.0"],VVVV.PinTypes.Color);var f=this.addOutputPin("Output",["1.0, 1.0, 1.0, 1.0"],VVVV.PinTypes.Color);this.addInvisiblePin("Input Count",
[2],VVVV.PinTypes.Value);this.evaluate=function(){var d=this.getMaxInputSliceCount();if(this.hasNilInputs())f.setSliceCount(0);else{for(var c=0;c<d;c++)f.setValue(c,e[Math.round(Math.abs(h.getValue(c)))%e.length].getValue(c));f.setSliceCount(d)}}};VVVV.Nodes.SwitchColorInput.prototype=new VVVV.Core.Node;VVVV.Nodes.Abs=function(b,a){this.constructor(b,"Abs (Complex)",a);this.meta={authors:["Matthias Zauner"],original_authors:["VVVV Group"],credits:[],compatibility_issues:[]};var h=this.addInputPin("Input Real",[0],VVVV.PinTypes.Value),e=this.addInputPin("Input Imagiary",[0],VVVV.PinTypes.Value),f=this.addOutputPin("Output",[0.5],VVVV.PinTypes.Value);this.evaluate=function(){for(var d=this.getMaxInputSliceCount(),c=0;c<d;c++)f.setValue(c,Math.sqrt(Math.pow(parseFloat(h.getValue(c)),2)+Math.pow(parseFloat(e.getValue(c)),
2)));f.setSliceCount(d)}};VVVV.Nodes.Abs.prototype=new VVVV.Core.Node;VVVV.Nodes.String2Enum=function(b,a){this.constructor(b,"String2Enum (Enumerations)",a);this.meta={authors:["Matthias Zauner"],original_authors:["VVVV Group"],credits:[],compatibility_issues:["Validation check does not work"]};var h=this.addInputPin("String Value",[],VVVV.PinTypes.String),e=this.addOutputPin("Enum",[],VVVV.PinTypes.Enum);this.evaluate=function(){for(var a=this.getMaxInputSliceCount(),d=0;d<a;d++)e.setValue(d,h.getValue(d));e.setSliceCount(a)}};VVVV.Nodes.String2Enum.prototype=new VVVV.Core.Node;VVVV.PinTypes.HTML5Texture={typeName:"HTML5Texture",reset_on_disconnect:!0,defaultValue:function(){return"Empty Texture"}};
VVVV.Nodes.FileTextureCanvas=function(b,a){this.constructor(b,"FileTexture (HTML5 VVVVjs)",a);this.meta={authors:["Matthias Zauner"],original_authors:[],credits:[],compatibility_issues:[]};this.auto_evaluate=!0;var h=this.addInputPin("Filename",[],VVVV.PinTypes.String),e=this.addOutputPin("Texture Out",[],VVVV.PinTypes.HTML5Texture),f=this.addOutputPin("Width",[0],VVVV.PinTypes.Value),d=this.addOutputPin("Height",[0],VVVV.PinTypes.Value),c=this.addOutputPin("Up and Running",[0],VVVV.PinTypes.Value),
g=[],m=!1;this.evaluate=function(){var a=this.getMaxInputSliceCount();if(h.pinIsChanged()){for(var b=0;b<a;b++){var r=VVVV.Helpers.prepareFilePath(h.getValue(b),this.parentPatch);0===r.indexOf("http://")&&void 0!==VVVV.ImageProxyPrefix&&(r=VVVV.ImageProxyPrefix+encodeURI(r));if(void 0==g[b]||g[b].origSrc!=r)g[b]=new Image,g[b].loaded=!1,g[b].origSrc=r,g[b].onload=function(c){return function(){m=g[c].loaded=!0}}(b),g[b].src=r,c.setValue(b,0),e.setValue(b,g[b])}g.length=a;e.setSliceCount(a);f.setSliceCount(a);
d.setSliceCount(a);c.setSliceCount(a)}if(m){for(b=0;b<a;b++)e.setValue(b,g[b]),f.setValue(b,g[b].width),d.setValue(b,g[b].height),c.setValue(b,g[b].loaded?1:0);m=!1}}};VVVV.Nodes.FileTextureCanvas.prototype=new VVVV.Core.Node;
VVVV.Nodes.FileStreamCanvas=function(b,a){this.constructor(b,"FileStream (HTML5 VVVVjs)",a);this.meta={authors:["Matthias Zauner"],original_authors:[],credits:[],compatibility_issues:[]};this.auto_evaluate=!0;var h=["NETWORK_EMPTY","NETWORK_IDLE","NETWORK_LOADING","NETWORK_NO_SOURCE"],e=["HAVE_NOTHING","HAVE_METADATA","HAVE_FUTURE_DATA","HAVE_ENOUGH_DATA","HAVE_CURRENT_DATA"],f=this.addInputPin("Play",[1],VVVV.PinTypes.Value),d=this.addInputPin("Loop",[0],VVVV.PinTypes.Value),c=this.addInputPin("Start Time",
[0],VVVV.PinTypes.Value),g=this.addInputPin("End Time",[-1],VVVV.PinTypes.Value),m=this.addInputPin("Do Seek",[0],VVVV.PinTypes.Value),q=this.addInputPin("Seek Position",[0],VVVV.PinTypes.Value),k=this.addInputPin("Filename",["http://html5doctor.com/demos/video-canvas-magic/video.ogg"],VVVV.PinTypes.String),r=this.addOutputPin("Video",[],this),n=this.addOutputPin("Audio",[],this),p=this.addOutputPin("Duration",[0],VVVV.PinTypes.Value),s=this.addOutputPin("Position",[0],VVVV.PinTypes.Value),v=this.addOutputPin("Video Width",
[0],VVVV.PinTypes.Value),t=this.addOutputPin("Video Height",[0],VVVV.PinTypes.Value),u=this.addOutputPin("Network Status",[""],VVVV.PinTypes.String),w=this.addOutputPin("Ready Status",[""],VVVV.PinTypes.String),l=[];this.evaluate=function(){var a=this.getMaxInputSliceCount();if(k.pinIsChanged())for(var b=0;b<a;b++){filename=VVVV.Helpers.prepareFilePath(k.getValue(b),this.parentPatch);if(void 0==l[b]){var A=$('<video style="display:none"><source src="" type=video/ogg></video>');$("body").append(A);
l[b]=A[0];l[b].volume=0;A=function(c){return function(){}}(b);l[b].onprogress=A;l[b].oncanplay=A;l[b].oncanplaythrough=A}filename!=l[b].currentSrc&&($(l[b]).find("source").first().attr("src",filename),l[b].load(),0.5<f.getValue(b)?l[b].play():l[b].pause(),l[b].loaded=!0,r.setValue(b,l[b]),n.setValue(b,l[b]))}if(f.pinIsChanged())for(b=0;b<a;b++)0.5<f.getValue(b)?l[b].play():l[b].pause();if(m.pinIsChanged())for(b=0;b<a;b++)l[b%l.length].loaded&&0.5<=m.getValue(b)&&(l[b%l.length].currentTime=parseFloat(q.getValue(b)),
0.5<f.getValue(b)&&l[b].play());for(b=0;b<a;b++){if(!l[b].paused){r.setValue(b,l[b]);n.setValue(b,l[b]);p.getValue(b)!=l[b].duration&&p.setValue(b,l[b].duration);s.setValue(b,l[b].currentTime);var A=parseFloat(g.getValue(b)),F=parseFloat(c.getValue(b));l[b].currentTime<F&&(l[b].currentTime=F);if(l[b].currentTime>=l[b].duration||0<=A&&l[b].currentTime>=A)0.5<=d.getValue(b)?l[b].currentTime=F:l[b].pause()}if(l[b].videoWidth!=v.getValue(b)||l[b].videoHeight!=t.getValue(b))v.setValue(b,l[b].videoWidth),
t.setValue(b,l[b].videoHeight);u.getValue(b)!=h[l[b].networkState]&&u.setValue(b,h[l[b].networkState]);w.getValue(b)!=e[l[b].readyState]&&w.setValue(b,e[l[b].readyState])}r.setSliceCount(a);n.setSliceCount(a)}};VVVV.Nodes.FileStreamCanvas.prototype=new VVVV.Core.Node;
VVVV.Nodes.AudioOutHTML5=function(b,a){this.constructor(b,"AudioOut (HTML5 VVVVjs)",a);this.meta={authors:["Matthias Zauner"],original_authors:[],credits:[],compatibility_issues:[]};var h=this.addInputPin("Audio",[],this),e=this.addInputPin("Volume",[0.5],VVVV.PinTypes.Value);this.evaluate=function(){var b=this.getMaxInputSliceCount();if(e.pinIsChanged())for(var d=0;d<b;d++)h.getValue(d).volume=Math.max(0,Math.min(1,parseFloat(e.getValue(d))))}};VVVV.Nodes.AudioOutHTML5.prototype=new VVVV.Core.Node;VVVV.Nodes.HTTPGet=function(b,a){this.constructor(b,"HTTP (Network Get)",a);this.meta={authors:["Matthias Zauner"],original_authors:["VVVV Group"],credits:[],compatibility_issues:["Doesnt handle get variables yet","Doesnt support proxies","No header output pin yet"]};this.auto_evaluate=!0;var h=this.addInputPin("URL",["http://localhost"],VVVV.PinTypes.String),e=this.addInputPin("Name",[""],VVVV.PinTypes.String),f=this.addInputPin("Value",[""],VVVV.PinTypes.String),d=this.addInputPin("Refresh",[0],
VVVV.PinTypes.Value),c=this.addOutputPin("Status",[""],VVVV.PinTypes.String),g=this.addOutputPin("Body",[""],VVVV.PinTypes.String),m=this.addOutputPin("Fail",[0],VVVV.PinTypes.Value),q=this.addOutputPin("Success",[0],VVVV.PinTypes.Value),k,r,n,p=!1;this.evaluate=function(){this.getMaxInputSliceCount();var b=h.pinIsChanged()||e.pinIsChanged()||f.pinIsChanged()||d.pinIsChanged()&&1==d.getValue(0);1==q.getValue(0)&&q.setValue(0,0);1==m.getValue(0)&&m.setValue(0,0);p&&(g.setValue(0,k),c.setValue(0,void 0),
q.setValue(0,r),m.setValue(0,n),p=!1);b&&(void 0==h.getValue(0)?(g.setValue(0,""),c.setValue(0,"")):$.ajax({url:h.getValue(0),type:"get",success:function(c,d,b){k=c;r=1;p=!0},error:function(c,d){k="";n=1;p=!0}}))}};VVVV.Nodes.HTTPGet.prototype=new VVVV.Core.Node;VVVV.PinTypes.Node={typeName:"Node"};
VVVV.Nodes.IOBoxNode=function(b,a){this.constructor(b,"IOBox (Node)",a);this.meta={authors:["Matthias Zauner"],original_authors:["VVVV Group"],credits:[],compatibility_issues:[]};this.auto_evaluate=!1;var h=this.addInputPin("Input Node",[],VVVV.PinTypes.Node),e=this.addOutputPin("Output Node",[],VVVV.PinTypes.Node);this.initialize=function(){h.connectionChangedHandlers.nodepin=function(){if(this.isConnected()){var b;0<this.links.length?b=this.links[0].fromPin:this.masterPin&&(b=this.masterPin);this.setType(VVVV.PinTypes[b.typeName]);
e.setType(VVVV.PinTypes[b.typeName]);e.slavePin&&e.slavePin.setType(VVVV.PinTypes[b.typeName])}else e.isConnected()||(this.setType(VVVV.PinTypes.Node),e.setType(VVVV.PinTypes.Node),e.slavePin&&e.slavePin.setType(VVVV.PinTypes.Node))};e.connectionChangedHandlers.nodepin=function(){if(this.isConnected()){var b;0<this.links.length?b=this.links[0].toPin:this.slavePin&&(b=this.slavePin);this.setType(VVVV.PinTypes[b.typeName]);h.setType(VVVV.PinTypes[b.typeName]);h.masterPin&&h.masterPin.setType(VVVV.PinTypes[b.typeName])}else h.isConnected()||
(this.setType(VVVV.PinTypes.Node),h.setType(VVVV.PinTypes.Node),h.masterPin&&h.masterPin.setType(VVVV.PinTypes.Node))}};this.evaluate=function(){for(var b=this.getMaxInputSliceCount(),d=0;d<b;d++)e.setValue(d,h.getValue(d));e.setSliceCount(b)}};VVVV.Nodes.IOBoxNode.prototype=new VVVV.Core.Node;
VVVV.Nodes.SwitchNodeInput=function(b,a){this.constructor(b,"Switch (Node Input)",a);this.meta={authors:["Matthias Zauner"],original_authors:["VVVV Group"],credits:[],compatibility_issues:["No dynamic pin count yet"]};var h=this.addInputPin("Switch",[0],VVVV.PinTypes.Value),e=this.addInvisiblePin("Input Count",[2],VVVV.PinTypes.Value),f=[],d=this.addOutputPin("Output",[0],VVVV.PinTypes.Node);this.initialize=function(){for(var c=e.getValue(0),d=f.length;d<c;d++)f[d]=this.addInputPin("Input "+(d+1),
[],VVVV.PinTypes.Node);f.length=c};this.evaluate=function(){e.pinIsChanged()&&this.initialize();if(void 0==h.getValue(0))d.setValue(0,void 0);else{for(var c=f[Math.round(Math.abs(h.getValue(0)))%f.length],b=c.getSliceCount(),a=0;a<b;a++)d.setValue(a,c.getValue(a));d.setSliceCount(b)}}};VVVV.Nodes.SwitchNodeInput.prototype=new VVVV.Core.Node;VVVV.Nodes.BoundsSpectral=function(b,a){this.constructor(b,"Bounds (Spectral)",a);this.meta={authors:["Matthias Zauner"],original_authors:["VVVV Group"],credits:[],compatibility_issues:[]};this.auto_evaluate=!1;var h=this.addInputPin("Input",[0],VVVV.PinTypes.Value),e=this.addInputPin("Bin Size",[-1],VVVV.PinTypes.Value),f=this.addOutputPin("Center",[0],VVVV.PinTypes.Value),d=this.addOutputPin("Width",[0],VVVV.PinTypes.Value),c=this.addOutputPin("Minimum",[0],VVVV.PinTypes.Value),g=this.addOutputPin("Maximum",
[0],VVVV.PinTypes.Value);this.evaluate=function(){for(var b=this.getMaxInputSliceCount(),a=0,k=0,r,n,p,s=0;s<b||0<e.getValue(0)&&(0<k||0!=a%e.values.length);s++)r=h.getValue(s),0==k&&(center=n=p=r,width=0),n=Math.min(r,n),p=Math.max(r,p),k++,0<e.getValue(0)&&k>=e.getValue(a)&&(c.setValue(a,n),g.setValue(a,p),f.setValue(a,n+(p-n)/2),d.setValue(a,Math.abs(p-n)),a++,k=0);-1==e.getValue(0)&&(c.setValue(a,n),g.setValue(a,p),f.setValue(a,n+(p-n)/2),d.setValue(a,Math.abs(p-n)));f.setSliceCount(a+(0<k));
d.setSliceCount(a+(0<k));c.setSliceCount(a+(0<k));g.setSliceCount(a+(0<k))}};VVVV.Nodes.BoundsSpectral.prototype=new VVVV.Core.Node;VVVV.Nodes.GetSliceSpreads=function(b,a){this.constructor(b,"GetSlice (Spreads)",a);this.meta={authors:["Matthias Zauner"],original_authors:["VVVV Group"],credits:[],compatibility_issues:[]};var h=this.addInputPin("Input",[0],VVVV.PinTypes.Value),e=this.addInputPin("Bin Size",[1],VVVV.PinTypes.Value),f=this.addInputPin("Index",[0],VVVV.PinTypes.Value),d=this.addOutputPin("Output",[0],VVVV.PinTypes.Value);this.evaluate=function(){for(var c=f.getSliceCount(),b,a,q=0,k=0;k<c;k++)if(a=e.getValue(k),b=
h.getValue(Math.round(f.getValue(k)),a),1<a)for(a=0;a<b.length;a++)d.setValue(q,parseFloat(b[a])),q++;else d.setValue(k,parseFloat(b)),q++;d.setSliceCount(q)}};VVVV.Nodes.GetSliceSpreads.prototype=new VVVV.Core.Node;
VVVV.Nodes.SetSliceSpreads=function(b,a){this.constructor(b,"SetSlice (Spreads)",a);this.meta={authors:["Matthias Zauner"],original_authors:["VVVV Group"],credits:[],compatibility_issues:[]};this.auto_evaluate=!1;var h=this.addInputPin("Spread",[0],VVVV.PinTypes.Value),e=this.addInputPin("Input",[0],VVVV.PinTypes.Value),f=this.addInputPin("Index",[0],VVVV.PinTypes.Value),d=this.addOutputPin("Output",[0],VVVV.PinTypes.Value);this.evaluate=function(){for(var c=h.getSliceCount(),b=0;b<c;b++)d.setValue(b,
h.getValue(b));size=Math.max(e.getSliceCount(),f.getSliceCount());for(b=0;b<size;b++)d.setValue(f.getValue(b)%c,e.getValue(b));d.setSliceCount(c)}};VVVV.Nodes.SetSliceSpreads.prototype=new VVVV.Core.Node;
VVVV.Nodes.RandomSpread=function(b,a){function h(b){var a=[],d=0,c=0;(function(c){for(var d=0;256>d;d++)a[d]=d;for(var b=0,d=0;256>d;d++){var b=(b+a[d]+c.charCodeAt(d%c.length))%256,e=a[d];a[d]=a[b];a[b]=e}})(b);this.getRandomNumber=function(){for(var b=0,e=1,h=0;8>h;h++){d=(d+1)%256;c=(c+a[d])%256;var k=a[d];a[d]=a[c];a[c]=k;b+=a[(a[d]+a[c])%256]*e;e*=256}return b/1.8446744073709552E19}}this.constructor(b,"RandomSpread (Spreads)",a);this.meta={authors:["Matthias Zauner"],original_authors:["VVVV Group"],
credits:["http://www.webdeveloper.com/forum/showthread.php?t=140572"],compatibility_issues:["Doesnt handle spreaded inputs","random result will differ from original vvvv node because of different algorithm"]};this.addInputPin("Input",[0],VVVV.PinTypes.Value);this.addInputPin("Width",[1],VVVV.PinTypes.Value);this.addInputPin("Random Seed",[0],VVVV.PinTypes.Value);this.addInputPin("Spread Count",[1],VVVV.PinTypes.Value);this.addOutputPin("Output",[0],VVVV.PinTypes.Value);this.evaluate=function(){var b=
parseInt(this.inputPins["Spread Count"].getValue(0)),a=parseFloat(this.inputPins.Input.getValue(0)),d=parseFloat(this.inputPins.Width.getValue(0)),c=parseInt(this.inputPins["Random Seed"].getValue(0));rng=new h(c.toString());this.outputPins.Output.setSliceCount(b);for(c=0;c<b;c++)this.outputPins.Output.setValue(c,rng.getRandomNumber()*d-d/2+a)}};VVVV.Nodes.RandomSpread.prototype=new VVVV.Core.Node;
VVVV.Nodes.SortSpreads=function(b,a){this.constructor(b,"Sort (Spreads)",a);this.meta={authors:["Matthias Zauner"],original_authors:["VVVV Group"],credits:[],compatibility_issues:[]};this.addInputPin("Input",[0],VVVV.PinTypes.Value);this.addOutputPin("Output",[0],VVVV.PinTypes.Value);this.addOutputPin("Former Index",[0],VVVV.PinTypes.Value);this.evaluate=function(){for(var b=_(this.inputPins.Input.values).map(function(b,d){return[b,d]}),b=_(b).sortBy(function(b){return b[0]}),a=0;a<b.length;a++)this.outputPins.Output.setValue(a,
b[a][0]),this.outputPins["Former Index"].setValue(a,b[a][1]);this.outputPins.Output.setSliceCount(b.length);this.outputPins["Former Index"].setSliceCount(b.length)}};VVVV.Nodes.SortSpreads.prototype=new VVVV.Core.Node;
VVVV.Nodes.LinearSpread=function(b,a){this.constructor(b,"LinearSpread (Spreads)",a);this.meta={authors:["Matthias Zauner"],original_authors:["VVVV Group"],credits:[],compatibility_issues:["phase does not work with Block alignment"]};var h=this.addInputPin("Input",[0],VVVV.PinTypes.Value),e=this.addInputPin("Width",[1],VVVV.PinTypes.Value),f=this.addInputPin("Alignment",["Centered"],VVVV.PinTypes.Enum);f.enumOptions=["Centered","Block","LeftJustified","RightJustified"];var d=this.addInputPin("Phase",
[0],VVVV.PinTypes.Value),c=this.addInputPin("Spread Count",[1],VVVV.PinTypes.Value),g=this.addOutputPin("Output",[0],VVVV.PinTypes.Value);this.evaluate=function(){var b=parseInt(c.getValue(0)),a=parseFloat(e.getValue(0)),k=parseFloat(d.getValue(0)),r=parseFloat(h.getValue(0)),n=f.getValue(0);""==n&&(n="Centered");var p=a/b;"Block"==n&&(p=a/(b-1));var s=p/2;if("Block"==n||"LeftJustified"==n)s=0;"RightJustified"==n&&(s=p);for(var v,t=0;t<b;t++)v=t*p+s,"Block"!=n&&0!=a&&(v=(v+k*a)%a),v=r-a/2+v,g.setValue(t,
v.toFixed(4));g.setSliceCount(b)}};VVVV.Nodes.LinearSpread.prototype=new VVVV.Core.Node;
VVVV.Nodes.AvoidNil=function(b,a){this.constructor(b,"AvoidNIL (Spreads)",a);this.auto_nil=!1;this.meta={authors:["Matthias Zauner"],original_authors:["Kalle"],credits:[],compatibility_issues:[]};var h=this.addInputPin("Input",[0],VVVV.PinTypes.Value),e=this.addInputPin("Default",[0],VVVV.PinTypes.Value),f=this.addOutputPin("Output",[0],VVVV.PinTypes.Value);this.evaluate=function(){if(h.pinIsChanged()||e.pinIsChanged()){var d=h;void 0==h.values[0]&&(d=e);for(var c=0;c<d.values.length;c++)f.setValue(c,
d.getValue(c));f.setSliceCount(d.getSliceCount())}}};VVVV.Nodes.AvoidNil.prototype=new VVVV.Core.Node;
VVVV.Nodes.SwapDim=function(b,a){this.constructor(b,"SwapDim (Spreads)",a);this.meta={authors:["Matthias Zauner"],original_authors:["VVVV Group"],credits:[],compatibility_issues:["BinSize not implemented"]};var h=this.addInputPin("Input",[0],VVVV.PinTypes.Value),e=this.addInputPin("Column Count",[0],VVVV.PinTypes.Value),f=this.addInputPin("Row Count",[0],VVVV.PinTypes.Value),d=this.addOutputPin("Output",[0],VVVV.PinTypes.Value);this.evaluate=function(){for(var c=parseInt(e.getValue(0)),b=parseInt(f.getValue(0)),
a=c*b,q=0;q<a;q++)d.setValue(q%c*b+parseInt(q/c),h.getValue(q));d.setSliceCount(a)}};VVVV.Nodes.SwapDim.prototype=new VVVV.Core.Node;
VVVV.Nodes.I=function(b,a){this.constructor(b,"I (Spreads)",a);this.meta={authors:["M\u00f3r\u00e1sz D\u00e1vid (micro.D)"],original_authors:["VVVV Group"],credits:["Matthias Zauner"],compatibility_issues:["This has no phase pin.",'Smaller "from" than "to" isn\'t working yet']};var h=this.addInputPin("[ From ..",[0],VVVV.PinTypes.Value),e=this.addInputPin(".. To [",[1],VVVV.PinTypes.Value),f=this.addOutputPin("Output",[0],VVVV.PinTypes.Value);this.evaluate=function(){var d=Math.round(h.getValue(0)),
c=Math.round(e.getValue(0)),b=0;if(d<=c){for(var a=d;a<c;a++,b++)f.setValue(b,a);f.setSliceCount(c-d)}else{for(a=d;a>c;a--,b++)f.setValue(b,a);f.setSliceCount(d-c)}}};VVVV.Nodes.I.prototype=new VVVV.Core.Node;
VVVV.Nodes.CircularSpread=function(b,a){this.constructor(b,"CircularSpread (Spreads)",a);this.meta={authors:["Matija Miloslavich"],original_authors:["VVVV Group"],credits:[],compatibility_issues:["only x and y inputs are spreadable"]};this.inpxin=this.addInputPin("Input X",[0],VVVV.PinTypes.Value);this.inpyin=this.addInputPin("Input Y",[0],VVVV.PinTypes.Value);this.widhin=this.addInputPin("Width",[1],VVVV.PinTypes.Value);this.heightin=this.addInputPin("Height",[1],VVVV.PinTypes.Value);this.factorin=
this.addInputPin("Factor",[1],VVVV.PinTypes.Value);this.phasein=this.addInputPin("Phase",[0],VVVV.PinTypes.Value);this.sprcntin=this.addInputPin("Spread Count",[1],VVVV.PinTypes.Value);this.xout=this.addOutputPin("Output X",[0],VVVV.PinTypes.Value);this.yout=this.addOutputPin("Output Y",[0],VVVV.PinTypes.Value);this.evaluate=function(){for(var b=0.5*parseFloat(this.widhin.getValue(0)),a=0.5*parseFloat(this.heightin.getValue(0)),f=parseFloat(this.factorin.getValue(0)),d=parseFloat(this.phasein.getValue(0)),
c=parseInt(this.sprcntin.getValue(0)),g=2*Math.PI,d=g*d,m=0,q=Math.max(this.inpyin.getSliceCount(),this.inpxin.getSliceCount()),k=0;k<q*c;k++)for(var r=parseFloat(this.inpxin.getValue(k)),n=parseFloat(this.inpyin.getValue(k)),p=0;p<c;p++){var s=d+g*(p/c)*f,v=r+Math.cos(s)*b,s=n+Math.sin(s)*a;this.xout.setValue(m,v);this.yout.setValue(m,s);m++}this.xout.setSliceCount(c*q);this.yout.setSliceCount(c*q)}};VVVV.Nodes.CircularSpread.prototype=new VVVV.Core.Node;
VVVV.Nodes.ReverseSpreads=function(b,a){this.constructor(b,"Reverse (Spreads)",a);this.meta={authors:["Matthias Zauner"],original_authors:["VVVV Group"],credits:[],compatibility_issues:[]};this.auto_evaluate=!1;var h=this.addInputPin("Input",[0],VVVV.PinTypes.Value),e=this.addOutputPin("Output",[0],VVVV.PinTypes.Value);this.evaluate=function(){for(var b=h.getSliceCount(),d=0;d<b;d++){var c=h.getValue(d);e.setValue(b-d-1,c)}e.setSliceCount(b)}};VVVV.Nodes.ReverseSpreads.prototype=new VVVV.Core.Node;
VVVV.Nodes.IntegralSpreads=function(b,a){this.constructor(b,"Integral (Spreads)",a);this.meta={authors:["Matthias Zauner"],original_authors:["VVVV Group"],credits:[],compatibility_issues:[]};this.auto_evaluate=!1;var h=this.addInputPin("Input",[0],VVVV.PinTypes.Value),e=this.addInputPin("Offset",[0],VVVV.PinTypes.Value),f=this.addOutputPin("Output",[0],VVVV.PinTypes.Value);this.evaluate=function(){var d=h.getSliceCount(),c=parseFloat(e.getValue(0));f.setValue(0,c);for(var b=0;b<d;b++){var a=parseFloat(h.getValue(b)),
c=c+a;f.setValue(b+1,c)}f.setSliceCount(d+1)}};VVVV.Nodes.IntegralSpreads.prototype=new VVVV.Core.Node;
VVVV.Nodes.ConsSpreads=function(b,a){this.constructor(b,"Cons (Spreads)",a);this.meta={authors:["Matthias Zauner"],original_authors:["VVVV Group"],credits:[],compatibility_issues:[]};this.auto_evaluate=!1;var h=[],e=this.addOutputPin("Output",[0],VVVV.PinTypes.Value),f=this.addInvisiblePin("Input Count",[2],VVVV.PinTypes.Value);this.initialize=function(){var d=Math.max(2,f.getValue(0));VVVV.Helpers.dynamicPins(this,h,d,function(c){return this.addInputPin("Input "+(c+1),[0],VVVV.PinTypes.Value)})};
this.evaluate=function(){f.pinIsChanged()&&this.initialize();for(var d=0,c=0;c<h.length;c++)for(var b=0;b<h[c].getSliceCount();b++)e.setValue(d++,h[c].getValue(b));e.setSliceCount(d)}};VVVV.Nodes.ConsSpreads.prototype=new VVVV.Core.Node;
VVVV.Nodes.IntervalSpreads=function(b,a){this.constructor(b,"Interval (Spreads)",a);this.meta={authors:["Matthias Zauner"],original_authors:["VVVV Group"],credits:[],compatibility_issues:[]};this.auto_evaluate=!1;var h=this.addInputPin("Input",[0.5],VVVV.PinTypes.Value),e=this.addInputPin("Intervals",[0],VVVV.PinTypes.Value),f=this.addOutputPin("Index",[0],VVVV.PinTypes.Value),d=0;this.evaluate=function(){var c=h.getSliceCount(),b=e.getSliceCount();if(e.pinIsChanged()){d=void 0;for(var a=0;a<b;a++)if(e.getValue(a)<
d||void 0==d)d=e.getValue(a)}for(a=0;a<c;a++){var q=h.getValue(a);if(q<d)f.setValue(a,-1);else{for(var k=0;k<b-1&&!(q>=e.getValue(k)&&q<e.getValue(k+1));k++);f.setValue(a,k)}}f.setSliceCount(c)}};VVVV.Nodes.IntervalSpreads.prototype=new VVVV.Core.Node;
VVVV.Nodes.QueueSpreads=function(b,a){this.constructor(b,"Queue (Spreads)",a);this.meta={authors:["Zauner"],original_authors:["VVVV Group"],credits:[],compatibility_issues:[]};this.auto_evaluate=!1;var h=this.addInputPin("Input",[0],VVVV.PinTypes.Value),e=this.addInputPin("Insert",[0],VVVV.PinTypes.Value),f=this.addInputPin("Frame Count",[1],VVVV.PinTypes.Value),d=this.addInputPin("Reset",[0],VVVV.PinTypes.Value),c=this.addOutputPin("Output",[],VVVV.PinTypes.Value),g=this.addOutputPin("Output Bin Size",
[],VVVV.PinTypes.Value);this.evaluate=function(){var b=e.getValue(0),a=f.getValue(0),k=d.getValue(0),r=!1;if(0.5<=b&&0.5>k){b=h.getSliceCount();for(r=b-1;0<=r;r--)c.values.unshift(h.getValue(r));g.values.unshift(b);r=!0}if(f.pinIsChanged()||r){for(r=currFrameCount=g.values.length;r>a;r--)c.values.splice(-g.values[r-1]);g.values.splice(a);r=!0}if(r){for(r=0;r<c.values.length;r++)c.setValue(r,c.values[r]);for(r=0;r<g.values.length;r++)g.setValue(r,g.values[r])}0.5<=k&&(c.setSliceCount(0),g.setSliceCount(0))}};
VVVV.Nodes.QueueSpreads.prototype=new VVVV.Core.Node;VVVV.Nodes.IOBoxString=function(b,a){this.constructor(b,"IOBox (String)",a);this.meta={authors:["Matthias Zauner"],original_authors:["VVVV Group"],credits:[],compatibility_issues:[]};this.addInvisiblePin("Rows",[1],VVVV.PinTypes.Value);this.addInputPin("SliceOffset",[0],VVVV.PinTypes.Value);this.addInputPin("Input String",[""],VVVV.PinTypes.String);this.addOutputPin("Output String",[""],VVVV.PinTypes.String);this.evaluate=function(){this.outputPins["Output String"].setSliceCount(this.inputPins["Input String"].getSliceCount());
for(var b=0;b<this.inputPins["Input String"].getSliceCount();b++)this.outputPins["Output String"].setValue(b,this.inputPins["Input String"].values[b])}};VVVV.Nodes.IOBoxString.prototype=new VVVV.Core.Node;
VVVV.Nodes.SwitchStringInput=function(b,a){this.constructor(b,"Switch (String Input)",a);this.meta={authors:["Matthias Zauner"],original_authors:["VVVV Group"],credits:[],compatibility_issues:[]};var h=this.addInvisiblePin("Input Count",[2],VVVV.PinTypes.Value),e=this.addInputPin("Switch",[0],VVVV.PinTypes.Value),f=[],d=this.addOutputPin("Output",["text"],VVVV.PinTypes.String);this.initialize=function(){var c=Math.max(2,h.getValue(0));VVVV.Helpers.dynamicPins(this,f,c,function(c){return this.addInputPin("Input "+
(c+1),["text"],VVVV.PinTypes.String)})};this.evaluate=function(){h.pinIsChanged()&&this.initialize();for(var c=this.getMaxInputSliceCount(),b=0;b<c;b++)d.setValue(b,f[Math.round(Math.abs(e.getValue(b)))%f.length].getValue(b));d.setSliceCount(c)}};VVVV.Nodes.SwitchStringInput.prototype=new VVVV.Core.Node;
VVVV.Nodes.AddString=function(b,a){this.constructor(b,"Add (String)",a);this.meta={authors:["Matthias Zauner"],original_authors:["VVVV Group"],credits:[],compatibility_issues:["No dynamic pin count yet","Intersperse *Enum* not implemented"]};var h=this.addInvisiblePin("Input Count",[2],VVVV.PinTypes.Value),e=[],f=this.addInputPin("Intersperse String",[""],VVVV.PinTypes.String),d=this.addOutputPin("Output",["texttext"],VVVV.PinTypes.String);this.initialize=function(){var c=Math.max(2,h.getValue(0));
VVVV.Helpers.dynamicPins(this,e,c,function(c){return this.addInputPin("Input "+(c+1),["text"],VVVV.PinTypes.String)})};this.evaluate=function(){h.pinIsChanged()&&this.initialize();for(var c=this.getMaxInputSliceCount(),b=0;b<c;b++){var a=[],q=f.getValue(b);void 0==q&&(q="");for(var k=0;k<e.length;k++)a.push(e[k].getValue(b));d.setValue(b,a.join(q))}d.setSliceCount(c)}};VVVV.Nodes.AddString.prototype=new VVVV.Core.Node;
VVVV.Nodes.GetSliceString=function(b,a){this.constructor(b,"GetSlice (String)",a);this.meta={authors:["Matthias Zauner"],original_authors:["VVVV Group"],credits:[],compatibility_issues:["Bin Size not implemented"]};var h=this.addInputPin("Input",["text"],VVVV.PinTypes.String);this.addInputPin("Bin Size",[1],VVVV.PinTypes.Value);var e=this.addInputPin("Index",[0],VVVV.PinTypes.Value),f=this.addOutputPin("Output",["text"],VVVV.PinTypes.String);this.evaluate=function(){for(var b=0;b<e.values.length;b++)f.setValue(b,
h.getValue(Math.round(e.getValue(b))));f.setSliceCount(e.getSliceCount())}};VVVV.Nodes.GetSliceString.prototype=new VVVV.Core.Node;
VVVV.Nodes.AsValue=function(b,a){this.constructor(b,"AsValue (String)",a);this.meta={authors:["Matthias Zauner"],original_authors:["VVVV Group"],credits:[],compatibility_issues:[]};var h=this.addInputPin("Input",[],VVVV.PinTypes.String),e=this.addInputPin("Default",[0],VVVV.PinTypes.Value),f=this.addOutputPin("Output",[0],VVVV.PinTypes.Value);this.evaluate=function(){for(var b=this.getMaxInputSliceCount(),c=0;c<b;c++){var a=h.getValue(c);/^\s*-?[0-9.e]+\s*$/.test(a)?f.setValue(c,parseFloat(a)):f.setValue(c,
parseFloat(e.getValue(c)))}f.setSliceCount(b)}};VVVV.Nodes.AsValue.prototype=new VVVV.Core.Node;
VVVV.Nodes.SortString=function(b,a){this.constructor(b,"Sort (String)",a);this.meta={authors:["Matthias Zauner"],original_authors:["VVVV Group"],credits:[],compatibility_issues:[]};this.auto_evaluate=!1;var h=this.addInputPin("Input",["text"],VVVV.PinTypes.String);this.addInputPin("Reverse Sorting",[0],VVVV.PinTypes.Value);var e=this.addOutputPin("Output",["text"],VVVV.PinTypes.String),f=this.addOutputPin("Former Index",[0],VVVV.PinTypes.Value);this.initialize=function(){};this.evaluate=function(){xxx=
h.values;for(var b=_(h.values).map(function(c,b){return[c,b]}),b=_(b).sortBy(function(c){return c[0]}),c=0;c<b.length;c++)e.setValue(c,b[c][0]),f.setValue(c,b[c][1]);e.setSliceCount(b.length);f.setSliceCount(b.length)}};VVVV.Nodes.SortString.prototype=new VVVV.Core.Node;
VVVV.Nodes.LengthString=function(b,a){this.constructor(b,"Length (String)",a);this.meta={authors:["Matthias Zauner"],original_authors:["VVVV Group"],credits:[],compatibility_issues:[]};this.auto_evaluate=!1;var h=this.addInputPin("Input",["text"],VVVV.PinTypes.String),e=this.addOutputPin("Count",[0],VVVV.PinTypes.Value);this.evaluate=function(){for(var b=this.getMaxInputSliceCount(),d=0;d<b;d++){var c=h.getValue(d);e.setValue(d,c.length)}e.setSliceCount(b)}};VVVV.Nodes.LengthString.prototype=new VVVV.Core.Node;
VVVV.Nodes.SiftString=function(b,a){this.constructor(b,"Sift (String)",a);this.meta={authors:["Matthias Zauner"],original_authors:["VVVV Group"],credits:[],compatibility_issues:[]};this.auto_evaluate=!1;var h=this.addInputPin("Input",["text"],VVVV.PinTypes.String),e=this.addInputPin("Filter",["text"],VVVV.PinTypes.String),f=this.addInputPin("Comparison",["Matches"],VVVV.PinTypes.Enum);f.enumOptions=["Matches","Contains","MatchesAny","ContainsAny"];var d=this.addInputPin("Case Sensitive",[0],VVVV.PinTypes.Value),
c=this.addOutputPin("Hits",[0],VVVV.PinTypes.Value),g=this.addOutputPin("Input Index",[0],VVVV.PinTypes.Value),m=this.addOutputPin("Filter Index",[0],VVVV.PinTypes.Value),q=this.addOutputPin("Found At Position",[0],VVVV.PinTypes.Value);this.evaluate=function(){var b=this.getMaxInputSliceCount();c.setSliceCount(b);var a=f.getValue(0);d.getValue(0);for(var n=0,p=0;p<b;p++){var s=h.getValue(p),v=1;if("MatchesAny"==a||"ContainsAny"==a)v=e.getSliceCount();for(var t=0,u=0;u<v;u++){var w=e.getValue(u+p),
l=[];if("Matches"==a||"MatchesAny"==a)w==s&&l.push(-1);else for(var w=RegExp(w,"gi"),z;z=w.exec(s);)l.push(z.index);for(w=0;w<l.length;w++)g.setValue(n,p%h.getSliceCount()),m.setValue(n,(p+u)%e.getSliceCount()),q.setValue(n,l[w]+1),n++,t++}c.setValue(p,t)}g.setSliceCount(n);m.setSliceCount(n);q.setSliceCount(n)}};VVVV.Nodes.SiftString.prototype=new VVVV.Core.Node;
VVVV.Nodes.SeparateString=function(b,a){this.constructor(b,"Separate (String)",a);this.meta={authors:["Matthias Zauner"],original_authors:["VVVV Group"],credits:[],compatibility_issues:["Quotes don't work"]};this.auto_evaluate=!1;var h=this.addInputPin("Input",["text"],VVVV.PinTypes.String),e=this.addInputPin("Intersperse",["None"],VVVV.PinTypes.Enum);e.enumOptions="None Space Comma CommaPlusSpace Semicolon Colon Pipe UnixPath DosPath Dash NewLineAutoDetection Dot UnderScore Minus".split(" ");var f=
this.addInputPin("Intersperse String",[""],VVVV.PinTypes.String),d=this.addInputPin("Ignore between",["Double"],VVVV.PinTypes.Enum);d.enumOptions=["Single","Double"];var c=this.addInputPin("Keep Quotes",[0],VVVV.PinTypes.Value),g=this.addOutputPin("Output",["text"],VVVV.PinTypes.String),m=this.addOutputPin("Former Index",[0],VVVV.PinTypes.Value),q={None:"",Space:" ",Comma:",",CommaPlusSpace:", ",Semicolon:";",Colon:":",Pipe:"|",UnixPath:"/",DosPath:"\\",Dash:"-",NewLineAutoDetection:"\n",Dot:".",
UnderScore:"_",Minus:"-"},k={Single:"'",Double:'"'};this.evaluate=function(){for(var b=this.getMaxInputSliceCount(),a=0,p=0;p<b;p++){var s=h.getValue(p),v=q[e.getValue(p)],t=f.getValue(p),u=k[d.getValue(p)],w=c.getValue(p);""==v&&(v=t);""==v&&(v=void 0);s=s.split(v);v=s.length;u=RegExp("[^"+u+"]*","g");for(t=0;t<v;t++)1==w?g.setValue(a,s[t]):g.setValue(a,s[t].match(u).join("")),m.setValue(a,p),a++}g.setSliceCount(a);m.setSliceCount(a)}};VVVV.Nodes.SeparateString.prototype=new VVVV.Core.Node;
VVVV.Nodes.EQString=function(b,a){this.constructor(b,"EQ (String)",a);this.meta={authors:["Matthias Zauner"],original_authors:["VVVV Group"],credits:[],compatibility_issues:[]};this.auto_evaluate=!1;var h=this.addInputPin("Input 1",[""],VVVV.PinTypes.String),e=this.addInputPin("Input 2",[""],VVVV.PinTypes.String),f=this.addInputPin("Case Sensitive",[1],VVVV.PinTypes.Value),d=this.addOutputPin("Output",[0],VVVV.PinTypes.Value),c=this.addOutputPin("Inverse Output",[0],VVVV.PinTypes.Value);this.evaluate=
function(){for(var b=this.getMaxInputSliceCount(),a=0;a<b;a++){var q=h.getValue(a),k=e.getValue(a),r=f.getValue(a),q=q==k||0==r&&q.toLowerCase()==k.toLowerCase()?1:0;d.setValue(a,q);c.setValue(a,1-q)}d.setSliceCount(b);c.setSliceCount(b)}};VVVV.Nodes.EQString.prototype=new VVVV.Core.Node;
VVVV.Nodes.SelectString=function(b,a){this.constructor(b,"Select (String)",a);this.meta={authors:["Matthias Zauner"],original_authors:["VVVV Group"],credits:[],compatibility_issues:[]};var h=this.addInputPin("Input",[""],VVVV.PinTypes.String),e=this.addInputPin("Select",[1],VVVV.PinTypes.Value),f=this.addOutputPin("Output",[""],VVVV.PinTypes.String),d=this.addOutputPin("Former Slice",[0],VVVV.PinTypes.Value);this.evaluate=function(){for(var c=this.getMaxInputSliceCount(),b=0,a=0;a<c;a++)for(var q=
0;q<e.getValue(a);q++)f.setValue(b,h.getValue(a)),d.setValue(b,a),b++;f.setSliceCount(b);d.setSliceCount(b)}};VVVV.Nodes.SelectString.prototype=new VVVV.Core.Node;
VVVV.Nodes.CountString=function(b,a){this.constructor(b,"Count (String)",a);this.auto_nil=!1;this.meta={authors:["Matthias Zauner"],original_authors:["VVVV Group"],credits:[],compatibility_issues:[]};this.addInputPin("Input",[""],VVVV.PinTypes.String);this.addOutputPin("Count",[1],VVVV.PinTypes.Value);this.addOutputPin("High",[0],VVVV.PinTypes.Value);this.evaluate=function(){this.inputPins.Input.pinIsChanged()&&(this.outputPins.Count.setValue(0,this.inputPins.Input.values.length),this.outputPins.High.setValue(0,
this.inputPins.Input.values.length-1))}};VVVV.Nodes.CountString.prototype=new VVVV.Core.Node;
VVVV.Nodes.CleanString=function(b,a){this.constructor(b,"Clean (String)",a);this.meta={authors:["Matthias Zauner"],original_authors:["VVVV Group"],credits:[],compatibility_issues:[]};this.auto_evaluate=!1;var h=this.addInputPin("Input",["text"],VVVV.PinTypes.String),e=this.addOutputPin("Output",["text"],VVVV.PinTypes.String);this.evaluate=function(){for(var b=this.getMaxInputSliceCount(),d=0;d<b;d++)h.getValue(d)?e.setValue(d,h.getValue(d).trim()):e.setValue(d,void 0);e.setSliceCount(b)}};
VVVV.Nodes.CleanString.prototype=new VVVV.Core.Node;
VVVV.Nodes.AvoidNilString=function(b,a){this.constructor(b,"AvoidNIL (String)",a);this.auto_nil=!1;this.meta={authors:["Matthias Zauner"],original_authors:["Kalle"],credits:[],compatibility_issues:[]};var h=this.addInputPin("Input",["text"],VVVV.PinTypes.String),e=this.addInputPin("Default",["text"],VVVV.PinTypes.String),f=this.addOutputPin("Output",["text"],VVVV.PinTypes.String);this.evaluate=function(){if(h.pinIsChanged()||e.pinIsChanged()){var b=h;void 0==h.values[0]&&(b=e);for(var c=0;c<b.values.length;c++)f.setValue(c,
b.getValue(c));f.setSliceCount(b.getSliceCount())}}};VVVV.Nodes.AvoidNilString.prototype=new VVVV.Core.Node;
VVVV.Nodes.FormatValueString=function(b,a){this.constructor(b,"FormatValue (String)",a);this.meta={authors:["Matthias Zauner"],original_authors:["VVVV Group"],credits:["pad function: http://stackoverflow.com/a/10073788","thousands separator regex: http://stackoverflow.com/a/2901298"],compatibility_issues:[]};this.auto_evaluate=!1;var h=this.addInputPin("Input",[0],VVVV.PinTypes.Value),e=this.addInputPin("Characters before Comma",[1],VVVV.PinTypes.Value),f=this.addInputPin("Characters after Comma",
[0],VVVV.PinTypes.Value),d=this.addInputPin("Thousands Symbol",["None"],VVVV.PinTypes.Enum);d.enumOptions=["None","Dot","Comma","Space"];var c=this.addInputPin("Comma Symbol",["Dot"],VVVV.PinTypes.Enum);c.enumOptions=["Dot","Comma"];var g=this.addInputPin("Leading Zeroes",[0],VVVV.PinTypes.Value),m=this.addOutputPin("Output",["0"],VVVV.PinTypes.String),q={Dot:".",Comma:",",None:"",Space:" "};this.evaluate=function(){for(var b=this.getMaxInputSliceCount(),a=0;a<b;a++){var n=h.getValue(a),p=parseInt(e.getValue(a)),
s=parseInt(f.getValue(a)),v=d.getValue(a),t=c.getValue(a),u=g.getValue(a),p=p+s+(0<s),n=parseFloat(n).toFixed(s),u=u=0.5<=u?"0":" ",n=n+"",n=n.length>=p?n:Array(p-n.length+1).join(u)+n,n=n.replace(".",q[t]).replace(/\B(?=(\d{3})+(?!\d))/g,q[v]);m.setValue(a,n)}m.setSliceCount(b)}};VVVV.Nodes.FormatValueString.prototype=new VVVV.Core.Node;VVVV.Nodes.MouseGlobal=function(b,a){this.constructor(b,"Mouse (System Global)",a);this.meta={authors:["Matthias Zauner"],original_authors:["VVVV Group"],credits:[],compatibility_issues:["Cyclic mode not supported","No Mouse Wheel pin","No Left Button Pin","No Right Button Pin","No Middle Button Pin"]};this.auto_evaluate=!0;var h=this.addOutputPin("X",[0],VVVV.PinTypes.Value),e=this.addOutputPin("Y",[0],VVVV.PinTypes.Value),f=this.addOutputPin("Mouse Wheel",[0],VVVV.PinTypes.Value),d=this.addOutputPin("Left Button",
[0],VVVV.PinTypes.Value),c=this.addOutputPin("Middle Button",[0],VVVV.PinTypes.Value),g=this.addOutputPin("Right Button",[0],VVVV.PinTypes.Value),m=0,q=0,k=0,r=0,n=0,p=0;$(document).mousemove(function(c){m=2*c.pageX/parseInt($("body").css("width"))-1;q=-(2*c.pageY/parseInt($("body").css("height"))-1)});$(document).bind("mousewheel",function(c){k+=c.originalEvent.wheelDelta/120});$(document).bind("DOMMouseScroll",function(c){k+=-c.originalEvent.detail/3});$(document).mousedown(function(c){switch(c.which){case 1:r=
1;break;case 2:n=1;break;case 3:p=1}});$(document).mouseup(function(c){switch(c.which){case 1:r=0;break;case 2:n=0;break;case 3:p=0}});this.evaluate=function(){h.getValue(0)!=m&&h.setValue(0,m);e.getValue(0)!=q&&e.setValue(0,q);f.getValue(0)!=k&&f.setValue(0,k);d.getValue(0)!=r&&d.setValue(0,r);c.getValue(0)!=n&&c.setValue(0,n);g.getValue(0)!=p&&g.setValue(0,p)}};VVVV.Nodes.MouseGlobal.prototype=new VVVV.Core.Node;
VVVV.Nodes.MouseWindow=function(b,a){this.constructor(b,"Mouse (System Window)",a);this.meta={authors:["Matthias Zauner"],original_authors:["VVVV Group"],credits:[],compatibility_issues:["Cyclic mode not supported","No Mouse Wheel pin","No Left Button Pin","No Right Button Pin","No Middle Button Pin"]};this.auto_evaluate=!0;var h=this.addOutputPin("X",[0],VVVV.PinTypes.Value),e=this.addOutputPin("Y",[0],VVVV.PinTypes.Value),f=this.addOutputPin("Mouse Wheel",[0],VVVV.PinTypes.Value),d=this.addOutputPin("Left Button",
[0],VVVV.PinTypes.Value),c=this.addOutputPin("Middle Button",[0],VVVV.PinTypes.Value),g=this.addOutputPin("Right Button",[0],VVVV.PinTypes.Value);this.evaluate=function(){h.getValue(0)!=VVVV.MousePositions._all.x&&h.setValue(0,VVVV.MousePositions._all.x);e.getValue(0)!=VVVV.MousePositions._all.y&&e.setValue(0,VVVV.MousePositions._all.y);f.getValue(0)!=VVVV.MousePositions._all.wheel&&f.setValue(0,VVVV.MousePositions._all.wheel);d.getValue(0)!=VVVV.MousePositions._all.lb&&d.setValue(0,VVVV.MousePositions._all.lb);
c.getValue(0)!=VVVV.MousePositions._all.mb&&c.setValue(0,VVVV.MousePositions._all.mb);g.getValue(0)!=VVVV.MousePositions._all.rb&&g.setValue(0,VVVV.MousePositions._all.rb)}};VVVV.Nodes.MouseWindow.prototype=new VVVV.Core.Node;
VVVV.Nodes.ShellExecute=function(b,a){this.constructor(b,"ShellExecute (Windows)",a);this.meta={authors:["Matthias Zauner"],original_authors:["VVVV Group"],credits:[],compatibility_issues:["This actually does something completely different from the original node: the origin node executes a shell command, this node evals javascript code"]};var h=this.addInputPin("File",[0],VVVV.PinTypes.String),e=this.addInputPin("Do Execute",[0],VVVV.PinTypes.Value),f=this.addOutputPin("Result",[""],VVVV.PinTypes.String);
this.evaluate=function(){if(1<=Math.round(e.getValue(0))){var b=eval(h.getValue(0));b instanceof Array||b instanceof Object||(b=[b]);if(void 0!=b)for(var c=0;c<b.length;c++)f.setValue(c,b[c])}}};VVVV.Nodes.ShellExecute.prototype=new VVVV.Core.Node;
VVVV.Nodes.ScreenInfo=function(b,a){this.constructor(b,"ScreenInfo (Windows)",a);this.meta={authors:["David M\u00f3r\u00e1sz (micro.D)"],original_authors:["VVVV Group"],credits:["Matthias Zauner"],compatibility_issues:["Outputs the window size (ResolutionXY) and the document size (Working AreaXY) only","no Bits per pixel"]};var h=this.addOutputPin("ResolutionXY",[0],VVVV.PinTypes.Value),e=this.addOutputPin("Working AreaXY",[0],VVVV.PinTypes.Value),f=0,d=0,c=0,g=0;$(document).ready(function(){d=$(window).height();
f=$(window).width();g=$(document).height();c=$(document).width()});$(window).resize(function(){d=$(window).height();f=$(window).width();g=$(document).height();c=$(document).width()});this.evaluate=function(){if(h.getValue(0)!=f||h.getValue(1)!=d)h.setValue(0,f),h.setValue(1,d);if(e.getValue(0)!=c||e.getValue(1)!=g)e.setValue(0,c),e.setValue(1,g)}};VVVV.Nodes.ScreenInfo.prototype=new VVVV.Core.Node;VVVV.PinTypes.Transform={typeName:"Transform",reset_on_disconnect:!0,defaultValue:function(){return mat4.identity(mat4.create())}};
VVVV.Nodes.Rotate=function(b,a){this.constructor(b,"Rotate (Transform)",a);this.meta={authors:["Matthias Zauner"],original_authors:["VVVV Group"],credits:[],compatibility_issues:[]};mat4.identity(mat4.create());this.trIn=this.addInputPin("Transform In",[],VVVV.PinTypes.Transform);this.xIn=this.addInputPin("X",[0],VVVV.PinTypes.Value);this.yIn=this.addInputPin("Y",[0],VVVV.PinTypes.Value);this.zIn=this.addInputPin("Z",[0],VVVV.PinTypes.Value);this.trOut=this.addOutputPin("Transform Out",[],VVVV.PinTypes.Transform);
this.evaluate=function(){for(var b=this.trIn.isConnected()?this.getMaxInputSliceCount():Math.max(this.xIn.getSliceCount(),this.yIn.getSliceCount(),this.zIn.getSliceCount()),a=0;a<b;a++){var f=this.inputPins["Transform In"].getValue(a),d=parseFloat(this.inputPins.X.getValue(a)),c=parseFloat(this.inputPins.Y.getValue(a)),g=parseFloat(this.inputPins.Z.getValue(a)),m=mat4.create();mat4.identity(m);mat4.rotate(m,2*c*Math.PI,[0,1,0]);mat4.rotate(m,2*d*Math.PI,[1,0,0]);mat4.rotate(m,2*g*Math.PI,[0,0,1]);
this.trIn.isConnected()&&mat4.multiply(f,m,m);this.trOut.setValue(a,m)}this.trOut.setSliceCount(b)}};VVVV.Nodes.Rotate.prototype=new VVVV.Core.Node;
VVVV.Nodes.Translate=function(b,a){this.constructor(b,"Translate (Transform)",a);this.meta={authors:["Matthias Zauner"],original_authors:["VVVV Group"],credits:[],compatibility_issues:[]};mat4.identity(mat4.create());this.trIn=this.addInputPin("Transform In",[],VVVV.PinTypes.Transform);this.xIn=this.addInputPin("X",[0],VVVV.PinTypes.Value);this.yIn=this.addInputPin("Y",[0],VVVV.PinTypes.Value);this.zIn=this.addInputPin("Z",[0],VVVV.PinTypes.Value);this.trOut=this.addOutputPin("Transform Out",[],VVVV.PinTypes.Transform);
this.evaluate=function(){for(var b=this.trIn.isConnected()?this.getMaxInputSliceCount():Math.max(this.xIn.getSliceCount(),this.yIn.getSliceCount(),this.zIn.getSliceCount()),a=0;a<b;a++){var f=parseFloat(this.xIn.getValue(a)),d=parseFloat(this.yIn.getValue(a)),c=parseFloat(this.zIn.getValue(a)),g=mat4.create();mat4.identity(g);mat4.translate(g,[f,d,c]);this.trIn.isConnected()&&(f=this.trIn.getValue(a),mat4.multiply(f,g,g));this.trOut.setValue(a,g)}this.trOut.setSliceCount(b)}};
VVVV.Nodes.Translate.prototype=new VVVV.Core.Node;
VVVV.Nodes.Scale=function(b,a){this.constructor(b,"Scale (Transform)",a);this.meta={authors:["Matthias Zauner"],original_authors:["VVVV Group"],credits:[],compatibility_issues:[]};mat4.identity(mat4.create());this.trIn=this.addInputPin("Transform In",[],VVVV.PinTypes.Transform);this.xIn=this.addInputPin("X",[1],VVVV.PinTypes.Value);this.yIn=this.addInputPin("Y",[1],VVVV.PinTypes.Value);this.zIn=this.addInputPin("Z",[1],VVVV.PinTypes.Value);this.trOut=this.addOutputPin("Transform Out",[],VVVV.PinTypes.Transform);
this.evaluate=function(){for(var b=this.trIn.isConnected()?this.getMaxInputSliceCount():Math.max(this.xIn.getSliceCount(),this.yIn.getSliceCount(),this.zIn.getSliceCount()),a=0;a<b;a++){var f=parseFloat(this.inputPins.X.getValue(a)),d=parseFloat(this.inputPins.Y.getValue(a)),c=parseFloat(this.inputPins.Z.getValue(a)),g=mat4.create();mat4.identity(g);mat4.scale(g,[f,d,c]);this.inputPins["Transform In"].isConnected()&&(f=this.inputPins["Transform In"].getValue(a),mat4.multiply(f,g,g));this.trOut.setValue(a,
g)}this.trOut.setSliceCount(b)}};VVVV.Nodes.Scale.prototype=new VVVV.Core.Node;
VVVV.Nodes.Perspective=function(b,a){this.constructor(b,"Perspective (Transform)",a);this.meta={authors:["Matthias Zauner"],original_authors:["VVVV Group"],credits:[],compatibility_issues:["Not spreadable"]};mat4.identity(mat4.create());this.addInputPin("Transform In",[],VVVV.PinTypes.Transform);this.addInputPin("FOV",[0.25],VVVV.PinTypes.Value);this.addInputPin("Near Plane",[0.05],VVVV.PinTypes.Value);this.addInputPin("Far Plane",[100],VVVV.PinTypes.Value);this.addOutputPin("Transform Out",[],VVVV.PinTypes.Transform);
this.evaluate=function(){var b=parseFloat(this.inputPins.FOV.getValue(0)),a=parseFloat(this.inputPins["Near Plane"].getValue(0)),f=parseFloat(this.inputPins["Far Plane"].getValue(0)),d=mat4.create();mat4.identity(d);mat4.perspective(360*b,1,a,f,d);this.inputPins["Transform In"].isConnected()&&(b=this.inputPins["Transform In"].getValue(0),mat4.multiply(b,d,d));this.outputPins["Transform Out"].setValue(0,d)}};VVVV.Nodes.Perspective.prototype=new VVVV.Core.Node;
VVVV.Nodes.InverseTransform=function(b,a){this.constructor(b,"Inverse (Transform)",a);this.meta={authors:["Matthias Zauner"],original_authors:["VVVV Group"],credits:[],compatibility_issues:[]};var h=this.addInputPin("Transform In",[],VVVV.PinTypes.Transform),e=this.addInputPin("Source",[],VVVV.PinTypes.Transform),f=this.addOutputPin("Transform Out",[],VVVV.PinTypes.Transform);this.evaluate=function(){for(var b=this.getMaxInputSliceCount(),c=0;c<b;c++){var a=mat4.create();mat4.set(e.getValue(c),a);
mat4.multiply(h.getValue(c),mat4.inverse(a,a),a);f.setValue(c,a)}f.setSliceCount(b)}};VVVV.Nodes.InverseTransform.prototype=new VVVV.Core.Node;
VVVV.Nodes.LookAtTransformVector=function(b,a){this.constructor(b,"LookAt (Transform Vector)",a);this.meta={authors:["Matthias Zauner"],original_authors:["VVVV Group"],credits:[],compatibility_issues:[]};this.auto_evaluate=!1;var h=this.addInputPin("Transform In",[],VVVV.PinTypes.Transform),e=this.addInputPin("Position XYZ",[0,0,0],VVVV.PinTypes.Value),f=this.addInputPin("LookAt XYZ",[0,0,1],VVVV.PinTypes.Value),d=this.addInputPin("UpVector XYZ",[0,1,0],VVVV.PinTypes.Value),c=this.addOutputPin("Transform Out",
[],VVVV.PinTypes.Transform),g=mat4.create();mat4.identity(g);mat4.scale(g,[-1,1,-1]);this.evaluate=function(){for(var b=Math.max(h.getSliceCount(),Math.max(e.getSliceCount()/3,Math.max(f.getSliceCount()/3,d.getSliceCount()/3))),b=Math.ceil(b),a=0;a<b;a++){var k=e.getValue(a,3),r=f.getValue(a,3),n=d.getValue(a,3),p=mat4.create();mat4.identity(p);mat4.lookAt(vec3.create(k),vec3.create(r),vec3.create(n),p);mat4.multiply(g,p,p);h.isConnected()&&mat4.multiply(h.getValue(a),p,p);c.setValue(a,p)}c.setSliceCount(b)}};
VVVV.Nodes.LookAtTransformVector.prototype=new VVVV.Core.Node;
VVVV.Nodes.LookAtTransform=function(b,a){this.constructor(b,"LookAt (Transform)",a);this.meta={authors:["Matthias Zauner"],original_authors:["VVVV Group"],credits:[],compatibility_issues:[]};this.auto_evaluate=!1;var h=this.addInputPin("Transform In",[],VVVV.PinTypes.Transform),e=this.addInputPin("Position X",[0],VVVV.PinTypes.Value),f=this.addInputPin("Position Y",[0],VVVV.PinTypes.Value),d=this.addInputPin("Position Z",[0],VVVV.PinTypes.Value),c=this.addInputPin("LookAt X",[0],VVVV.PinTypes.Value),
g=this.addInputPin("LookAt Y",[0],VVVV.PinTypes.Value),m=this.addInputPin("LookAt Z",[1],VVVV.PinTypes.Value),q=this.addInputPin("UpVector X",[0],VVVV.PinTypes.Value),k=this.addInputPin("UpVector Y",[1],VVVV.PinTypes.Value),r=this.addInputPin("UpVector Z",[0],VVVV.PinTypes.Value),n=this.addOutputPin("Transform Out",[],VVVV.PinTypes.Transform),p=mat4.create();mat4.identity(p);mat4.scale(p,[-1,1,-1]);this.evaluate=function(){for(var b=this.getMaxInputSliceCount(),a=0;a<b;a++){var t=mat4.create();mat4.identity(t);
mat4.lookAt(vec3.create([e.getValue(a),f.getValue(a),d.getValue(a)]),vec3.create([c.getValue(a),g.getValue(a),m.getValue(a)]),vec3.create([q.getValue(a),k.getValue(a),r.getValue(a)]),t);mat4.multiply(p,t,t);h.isConnected()&&mat4.multiply(h.getValue(a),t,t);n.setValue(a,t)}n.setSliceCount(b)}};VVVV.Nodes.LookAtTransform.prototype=new VVVV.Core.Node;VVVV.Nodes.AddValue=function(b,a){this.constructor(b,"Add (Value)",a);this.meta={authors:["Matthias Zauner"],original_authors:["VVVV Group"],credits:[],compatibility_issues:[""]};var h=this.addInvisiblePin("Input Count",[2],VVVV.PinTypes.Value),e=[],f=this.addOutputPin("Output",[0],VVVV.PinTypes.Value);this.initialize=function(){var b=Math.max(2,h.getValue(0));VVVV.Helpers.dynamicPins(this,e,b,function(c){return this.addInputPin("Input "+(c+1),[0],VVVV.PinTypes.Value)})};this.evaluate=function(){h.pinIsChanged()&&
this.initialize();var b=this.getMaxInputSliceCount();f.setSliceCount(b);for(var c=0;c<b;c++){for(var a=parseFloat(e[0].getValue(c)),m=1;m<e.length;m++)a+=parseFloat(e[m].getValue(c));f.setValue(c,a)}}};VVVV.Nodes.AddValue.prototype=new VVVV.Core.Node;
VVVV.Nodes.SubtractValue=function(b,a){this.constructor(b,"Subtract (Value)",a);this.meta={authors:["Matthias Zauner"],original_authors:["VVVV Group"],credits:[],compatibility_issues:[""]};var h=this.addInvisiblePin("Input Count",[2],VVVV.PinTypes.Value),e=[],f=this.addOutputPin("Output",[0],VVVV.PinTypes.Value);this.initialize=function(){var b=Math.max(2,h.getValue(0));VVVV.Helpers.dynamicPins(this,e,b,function(c){return this.addInputPin("Input "+(c+1),[0],VVVV.PinTypes.Value)})};this.evaluate=function(){h.pinIsChanged()&&
this.initialize();var b=this.getMaxInputSliceCount();f.setSliceCount(b);for(var c=0;c<b;c++){for(var a=parseFloat(e[0].getValue(c)),m=1;m<e.length;m++)a-=parseFloat(e[m].getValue(c));f.setValue(c,a)}}};VVVV.Nodes.SubtractValue.prototype=new VVVV.Core.Node;
VVVV.Nodes.EqValue=function(b,a){this.constructor(b,"EQ (Value)",a);this.meta={authors:["Matthias Zauner","Fibo"],original_authors:["VVVV Group"],credits:[],compatibility_issues:[]};var h=this.addInputPin("Input 1",[0],VVVV.PinTypes.Value),e=this.addInputPin("Input 2",[0],VVVV.PinTypes.Value),f=this.addInputPin("Epsilon",[0],VVVV.PinTypes.Value),d=this.addOutputPin("Output",[0],VVVV.PinTypes.Value),c=this.addOutputPin("Inverse Output",[0],VVVV.PinTypes.Value);this.evaluate=function(){for(var b=this.getMaxInputSliceCount(),
a=0;a<b;a++){var q=0;Math.abs(h.getValue(a)-e.getValue(a))<=Math.abs(f.getValue(a))&&(q=1);d.setValue(a,q);c.setValue(a,1-q)}d.setSliceCount(b);c.setSliceCount(b)}};VVVV.Nodes.EqValue.prototype=new VVVV.Core.Node;
VVVV.Nodes.GtValue=function(b,a){this.constructor(b,"GT (Value)",a);this.meta={authors:["Matthias Zauner"],original_authors:["VVVV Group"],credits:[],compatibility_issues:["No dynamic pin count yet"]};var h=this.addInputPin("Input 1",[0],VVVV.PinTypes.Value),e=this.addInputPin("Input 2",[0],VVVV.PinTypes.Value),f=this.addOutputPin("Output",[0],VVVV.PinTypes.Value);this.evaluate=function(){for(var b=this.getMaxInputSliceCount(),c=0;c<b;c++){var a=0;parseFloat(h.getValue(c))>parseFloat(e.getValue(c))&&
(a=1);f.setValue(c,a)}f.setSliceCount(b)}};VVVV.Nodes.GtValue.prototype=new VVVV.Core.Node;
VVVV.Nodes.LtValue=function(b,a){this.constructor(b,"LT (Value)",a);this.meta={authors:["Matthias Zauner"],original_authors:["VVVV Group"],credits:[],compatibility_issues:["No dynamic pin count yet"]};var h=this.addInputPin("Input 1",[0],VVVV.PinTypes.Value),e=this.addInputPin("Input 2",[0],VVVV.PinTypes.Value),f=this.addOutputPin("Output",[0],VVVV.PinTypes.Value);this.evaluate=function(){for(var b=this.getMaxInputSliceCount(),c=0;c<b;c++){var a=0;parseFloat(h.getValue(c))<parseFloat(e.getValue(c))&&
(a=1);f.setValue(c,a)}f.setSliceCount(b)}};VVVV.Nodes.LtValue.prototype=new VVVV.Core.Node;
VVVV.Nodes.MultiplyValue=function(b,a){this.constructor(b,"Multiply (Value)",a);this.meta={authors:["Matthias Zauner"],original_authors:["VVVV Group"],credits:[],compatibility_issues:[""]};var h=this.addInvisiblePin("Input Count",[2],VVVV.PinTypes.Value),e=[],f=this.addOutputPin("Output",[0],VVVV.PinTypes.Value);this.initialize=function(){var b=Math.max(2,h.getValue(0));VVVV.Helpers.dynamicPins(this,e,b,function(c){return this.addInputPin("Input "+(c+1),[1],VVVV.PinTypes.Value)})};this.evaluate=function(){h.pinIsChanged()&&
this.initialize();var b=this.getMaxInputSliceCount();f.setSliceCount(b);for(var c=0;c<b;c++){for(var a=parseFloat(e[0].getValue(c)),m=1;m<e.length;m++)a*=parseFloat(e[m].getValue(c));f.setValue(c,a)}}};VVVV.Nodes.MultiplyValue.prototype=new VVVV.Core.Node;
VVVV.Nodes.DivideValue=function(b,a){this.constructor(b,"Divide (Value)",a);this.meta={authors:["Matthias Zauner"],original_authors:["VVVV Group"],credits:[],compatibility_issues:[]};this.addInvisiblePin("Inputs Count",[2],VVVV.PinTypes.Value);var h=this.addInputPin("Input",[0],VVVV.PinTypes.Value),e=this.addInputPin("Input 2",[0],VVVV.PinTypes.Value),f=this.addOutputPin("Output",[0],VVVV.PinTypes.Value);this.initialize=function(){};this.evaluate=function(){for(var b=this.getMaxInputSliceCount(),
c=0;c<b;c++)0==e.getValue(c)?f.setValue(c,1):f.setValue(c,h.getValue(c)/e.getValue(c));f.setSliceCount(b)}};VVVV.Nodes.DivideValue.prototype=new VVVV.Core.Node;
VVVV.Nodes.IOBoxValueAdvanced=function(b,a){this.constructor(b,"IOBox (Value Advanced)",a);this.meta={authors:["Matthias Zauner"],original_authors:["VVVV Group"],credits:[],compatibility_issues:[]};this.addInputPin("Y Input Value",[0],VVVV.PinTypes.Value);this.addInvisiblePin("Rows",[1],VVVV.PinTypes.Value);this.addOutputPin("Y Output Value",[0],VVVV.PinTypes.Value);this.evaluate=function(){for(var b=this.inputPins["Y Input Value"].getSliceCount(),a,f=0;f<b;f++)a=parseFloat(this.inputPins["Y Input Value"].getValue(f)),
isFinite(a)||(a=0),this.outputPins["Y Output Value"].setValue(f,a);this.outputPins["Y Output Value"].setSliceCount(this.inputPins["Y Input Value"].getSliceCount())}};VVVV.Nodes.IOBoxValueAdvanced.prototype=new VVVV.Core.Node;
VVVV.Nodes.CountValue=function(b,a){this.constructor(b,"Count (Value)",a);this.auto_nil=!1;this.meta={authors:["Matthias Zauner"],original_authors:["VVVV Group"],credits:[],compatibility_issues:[]};this.addInputPin("Input",[0],VVVV.PinTypes.Value);this.addOutputPin("Count",[1],VVVV.PinTypes.Value);this.addOutputPin("High",[0],VVVV.PinTypes.Value);this.evaluate=function(){this.inputPins.Input.pinIsChanged()&&(this.outputPins.Count.setValue(0,this.inputPins.Input.values.length),this.outputPins.High.setValue(0,
this.inputPins.Input.values.length-1))}};VVVV.Nodes.CountValue.prototype=new VVVV.Core.Node;
VVVV.Nodes.SwitchValueInput=function(b,a){this.constructor(b,"Switch (Value Input)",a);this.meta={authors:["Matthias Zauner"],original_authors:["VVVV Group"],credits:[],compatibility_issues:["No dynamic pin count yet"]};var h=this.addInvisiblePin("Input Count",[2],VVVV.PinTypes.Value),e=this.addInputPin("Switch",[0],VVVV.PinTypes.Value),f=[];this.initialize=function(){var c=Math.max(2,h.getValue(0));VVVV.Helpers.dynamicPins(this,f,c,function(c){return this.addInputPin("Input "+(c+1),[0],VVVV.PinTypes.Value)})};
var d=this.addOutputPin("Output",[0],VVVV.PinTypes.Value);this.evaluate=function(){h.pinIsChanged()&&this.initialize();for(var c=this.getMaxInputSliceCount(),b=0;b<c;b++)d.setValue(b,f[Math.round(Math.abs(e.getValue(b)))%f.length].getValue(b));d.setSliceCount(c)}};VVVV.Nodes.SwitchValueInput.prototype=new VVVV.Core.Node;
VVVV.Nodes.SelectValue=function(b,a){this.constructor(b,"Select (Value)",a);this.meta={authors:["Matthias Zauner"],original_authors:["VVVV Group"],credits:[],compatibility_issues:[]};var h=this.addInputPin("Input",[0],VVVV.PinTypes.Value),e=this.addInputPin("Select",[1],VVVV.PinTypes.Value),f=this.addOutputPin("Output",[0],VVVV.PinTypes.Value),d=this.addOutputPin("Former Slice",[0],VVVV.PinTypes.Value);this.evaluate=function(){for(var c=this.getMaxInputSliceCount(),b=0,a=0;a<c;a++)for(var q=0;q<e.getValue(a);q++)f.setValue(b,
parseFloat(h.getValue(a))),d.setValue(b,a),b++;f.setSliceCount(b);d.setSliceCount(b)}};VVVV.Nodes.SelectValue.prototype=new VVVV.Core.Node;
VVVV.Nodes.AsString=function(b,a){this.constructor(b,"AsString (Value)",a);this.meta={authors:["Matthias Zauner"],original_authors:["VVVV Group"],credits:[],compatibility_issues:["SubType not implemented, always returns float formatting"]};var h=this.addInputPin("Input",[0],VVVV.PinTypes.Value),e=this.addInputPin("SubType",["Real (MinFloat .. MaxFloat)"],VVVV.PinTypes.Enum);e.enumOptions=["Real (MinFloat .. MaxFloat)","Integer (MinInt .. MaxInt)"];var f=this.addOutputPin("Output",[0],VVVV.PinTypes.String);
this.evaluate=function(){for(var b=this.getMaxInputSliceCount(),c=0;c<b;c++){subtype=e.getValue(c).match(/^(.+) \(/)[1];var a;switch(subtype){case "Real":a=parseFloat(h.getValue(c)).toFixed(4);break;case "Integer":a=parseInt(h.getValue(c)).toFixed(0)}f.setValue(c,a)}f.setSliceCount(b)}};VVVV.Nodes.AsString.prototype=new VVVV.Core.Node;
VVVV.Nodes.Frac=function(b,a){this.constructor(b,"Frac (Value)",a);this.meta={authors:["Matthias Zauner"],original_authors:["VVVV Group"],credits:[],compatibility_issues:[]};var h=this.addInputPin("Input",[0],VVVV.PinTypes.Value),e=this.addOutputPin("Whole Part",[0],VVVV.PinTypes.Value),f=this.addOutputPin("Real Part",[0.5],VVVV.PinTypes.Value);this.evaluate=function(){for(var b=this.getMaxInputSliceCount(),c=0;c<b;c++){var a=parseFloat(h.getValue(c));e.setValue(c,Math.floor(a));f.setValue(c,a-Math.floor(a))}e.setSliceCount(b);
f.setSliceCount(b)}};VVVV.Nodes.Frac.prototype=new VVVV.Core.Node;
VVVV.Nodes.AddValueSpectral=function(b,a){this.constructor(b,"Add (Value Spectral)",a);this.meta={authors:["David M\u00f3r\u00e1sz (micro.D)","Matthias Zauner"],original_authors:["VVVV Group"],credits:[],compatibility_issues:[]};this.addInputPin("Input",[0],VVVV.PinTypes.Value);this.addInputPin("Bin Size",[-1],VVVV.PinTypes.Value);this.addOutputPin("Output",[0],VVVV.PinTypes.Value);this.evaluate=function(){for(var b=this.getMaxInputSliceCount(),a=0,f=0,d=0;d<b||0<this.inputPins["Bin Size"].getValue(0)&&
(0<f||0!=a%this.inputPins["Bin Size"].values.length);d++){if(0==f)var c=0;c+=parseFloat(this.inputPins.Input.getValue(d));f++;0<this.inputPins["Bin Size"].getValue(0)?f>=this.inputPins["Bin Size"].getValue(a)&&(this.outputPins.Output.setValue(a,c),a++,f=0):this.outputPins.Output.setValue(0,c)}this.outputPins.Output.setSliceCount(a+(0<f))}};VVVV.Nodes.AddValueSpectral.prototype=new VVVV.Core.Node;
VVVV.Nodes.WaveShaperValue=function(b,a){this.constructor(b,"WaveShaper (Value)",a);this.meta={authors:["sebl"],original_authors:["VVVV Group"],credits:[],compatibility_issues:[]};this.auto_evaluate=!1;var h=this.addInputPin("Input",[0],VVVV.PinTypes.Value),e=this.addInputPin("Shape",["Linear"],VVVV.PinTypes.Enum);e.enumOptions=["Linear","Inverse","Triangle","Sine","Rectangle"];var f=this.addOutputPin("Output",[0],VVVV.PinTypes.Value);this.initialize=function(){};this.evaluate=function(){for(var b=
this.getMaxInputSliceCount(),c=0;c<b;c++){var a=parseFloat(h.getValue(c));switch(e.getValue(c)){case "Linear":f.setValue(c,a);break;case "Inverse":f.setValue(c,1-a);break;case "Triangle":0.5>a?f.setValue(c,2*a):f.setValue(c,2*(1-a));break;case "Sine":inp=6.28318530717959*((a+0.25)%1);f.setValue(c,Math.sin(inp)/2+0.5);break;case "Rectangle":0.5>a?f.setValue(c,0):f.setValue(c,1)}}f.setSliceCount(b)}};VVVV.Nodes.WaveShaperValue.prototype=new VVVV.Core.Node;
VVVV.Nodes.MapValue=function(b,a){this.constructor(b,"Map (Value)",a);this.meta={authors:["Matthias Zauner"],original_authors:["VVVV Group"],credits:[],compatibility_issues:["Mirror Mapping Mode not implemented"]};this.auto_evaluate=!1;var h=this.addInputPin("Input",[0.5],VVVV.PinTypes.Value),e=this.addInputPin("Source Minimum",[0],VVVV.PinTypes.Value),f=this.addInputPin("Source Maximum",[1],VVVV.PinTypes.Value),d=this.addInputPin("Destination Minimum",[0],VVVV.PinTypes.Value),c=this.addInputPin("Destination Maximum",
[1],VVVV.PinTypes.Value),g=this.addInputPin("Mapping",["Float"],VVVV.PinTypes.Enum);g.enumOptions=["Float","Wrap","Clamp"];var m=this.addOutputPin("Output",[0.5],VVVV.PinTypes.Value);this.evaluate=function(){for(var b=this.getMaxInputSliceCount(),a=0;a<b;a++){var r=parseFloat(h.getValue(a)),n=parseFloat(e.getValue(a)),p=parseFloat(f.getValue(a)),s=parseFloat(d.getValue(a)),v=parseFloat(c.getValue(a)),t=g.getValue(a);if(p==n)m.setValue(a,s);else{r-=n;p-=n;switch(t){case "Clamp":r=Math.max(0,Math.min(p,
r));break;case "Wrap":r=(p+r%p)%p}m.setValue(a,r*((v-s)/p)+s)}}m.setSliceCount(b)}};VVVV.Nodes.MapValue.prototype=new VVVV.Core.Node;
VVVV.Nodes.MinValue=function(b,a){this.constructor(b,"Min (Value)",a);this.meta={authors:["Matthias Zauner"],original_authors:["VVVV Group"],credits:[],compatibility_issues:[]};this.auto_evaluate=!1;var h=this.addOutputPin("Output",[0],VVVV.PinTypes.Value),e=this.addInvisiblePin("Input Count",[2],VVVV.PinTypes.Value),f=[];this.initialize=function(){var b=Math.max(2,e.getValue(0));VVVV.Helpers.dynamicPins(this,f,b,function(c){return this.addInputPin("Input "+(c+1),[0],VVVV.PinTypes.Value)})};this.evaluate=
function(){e.pinIsChanged()&&this.initialize();for(var b=this.getMaxInputSliceCount(),c=0;c<b;c++){for(var a=void 0,m=0;m<f.length;m++)if(void 0==a||f[m].getValue(c)<a)a=f[m].getValue(c);h.setValue(c,a)}h.setSliceCount(b)}};VVVV.Nodes.MinValue.prototype=new VVVV.Core.Node;
VVVV.Nodes.MaxValue=function(b,a){this.constructor(b,"Max (Value)",a);this.meta={authors:["Matthias Zauner"],original_authors:["VVVV Group"],credits:[],compatibility_issues:[]};this.auto_evaluate=!1;var h=this.addOutputPin("Output",[0],VVVV.PinTypes.Value),e=this.addInvisiblePin("Input Count",[2],VVVV.PinTypes.Value),f=[];this.initialize=function(){var b=Math.max(2,e.getValue(0));VVVV.Helpers.dynamicPins(this,f,b,function(c){return this.addInputPin("Input "+(c+1),[0],VVVV.PinTypes.Value)})};this.evaluate=
function(){e.pinIsChanged()&&this.initialize();for(var b=this.getMaxInputSliceCount(),c=0;c<b;c++){for(var a=void 0,m=0;m<f.length;m++)if(void 0==a||f[m].getValue(c)>a)a=f[m].getValue(c);h.setValue(c,a)}h.setSliceCount(b)}};VVVV.Nodes.MaxValue.prototype=new VVVV.Core.Node;
VVVV.Nodes.ModValue=function(b,a){this.constructor(b,"Mod (Value)",a);this.meta={authors:["Matthias Zauner"],original_authors:["VVVV Group"],credits:[],compatibility_issues:[]};this.auto_evaluate=!1;var h=this.addOutputPin("Output",[0],VVVV.PinTypes.Value),e=this.addInvisiblePin("Input Count",[2],VVVV.PinTypes.Value),f=[];this.initialize=function(){var b=Math.max(2,e.getValue(0));VVVV.Helpers.dynamicPins(this,f,b,function(c){return this.addInputPin("Input "+(c+1),[0],VVVV.PinTypes.Value)})};this.evaluate=
function(){e.pinIsChanged()&&this.initialize();for(var b=this.getMaxInputSliceCount(),c=0;c<b;c++){for(var a=f[0].getValue(c),m=1;m<f.length;m++)a=0==f[m].getValue(c)?0:a%f[m].getValue(c);h.setValue(c,a)}h.setSliceCount(b)}};VVVV.Nodes.ModValue.prototype=new VVVV.Core.Node;
VVVV.Nodes.PowerValue=function(b,a){this.constructor(b,"Power (Value)",a);this.meta={authors:["Matthias Zauner"],original_authors:["VVVV Group"],credits:[],compatibility_issues:[]};this.auto_evaluate=!1;var h=this.addOutputPin("Output",[0],VVVV.PinTypes.Value),e=this.addInvisiblePin("Input Count",[2],VVVV.PinTypes.Value),f=[];this.initialize=function(){var b=Math.max(2,e.getValue(0));VVVV.Helpers.dynamicPins(this,f,b,function(c){return this.addInputPin("Input "+(c+1),[0],VVVV.PinTypes.Value)})};this.evaluate=
function(){e.pinIsChanged()&&this.initialize();for(var b=this.getMaxInputSliceCount(),c=0;c<b;c++){for(var a=f[0].getValue(c),m=1;m<f.length;m++)a=Math.pow(a,f[m].getValue(c));h.setValue(c,a)}h.setSliceCount(b)}};VVVV.Nodes.PowerValue.prototype=new VVVV.Core.Node;
VVVV.Nodes.RandomValue=function(b,a){this.constructor(b,"Random (Value)",a);this.meta={authors:["Matthias Zauner"],original_authors:["VVVV Group"],credits:[],compatibility_issues:[]};this.auto_evaluate=!0;var h=this.addInputPin("Enabled",[1],VVVV.PinTypes.Value),e=this.addInputPin("Is Integer",[0],VVVV.PinTypes.Value),f=this.addInputPin("Scale",[1],VVVV.PinTypes.Value),d=this.addInputPin("Prevent from doubles",[1],VVVV.PinTypes.Value),c=this.addOutputPin("Output",[0],VVVV.PinTypes.Value);this.evaluate=
function(){for(var b=this.getMaxInputSliceCount(),a=0;a<b;a++){var q=h.getValue(a),k=e.getValue(a),r=f.getValue(a),n=d.getValue(a),p=c.values[a];void 0==p&&c.setValue(a,0);if(0.5<=q){p=c.values[a];do q=Math.random()*r,0.5<=k&&(q=Math.round(q));while(0.5<=n&&q==p);c.setValue(a,q)}}c.setSliceCount(b)}};VVVV.Nodes.RandomValue.prototype=new VVVV.Core.Node;
VVVV.Nodes.SignValue=function(b,a){this.constructor(b,"Sign (Value)",a);this.meta={authors:["Matthias Zauner"],original_authors:["VVVV Group"],credits:[],compatibility_issues:[]};this.auto_evaluate=!1;var h=this.addInputPin("Input",[0],VVVV.PinTypes.Value),e=this.addOutputPin("Sign Part",[0],VVVV.PinTypes.Value),f=this.addOutputPin("Absolute Part",[0],VVVV.PinTypes.Value);this.evaluate=function(){for(var b=this.getMaxInputSliceCount(),c=0;c<b;c++){var a=h.getValue(c);e.setValue(c,0==a?0:a/Math.abs(a));
f.setValue(c,Math.abs(a))}f.setSliceCount(b)}};VVVV.Nodes.SignValue.prototype=new VVVV.Core.Node;
VVVV.Nodes.InputMorphValue=function(b,a){this.constructor(b,"InputMorph (Value)",a);this.meta={authors:["Matthias Zauner"],original_authors:["VVVV Group"],credits:[],compatibility_issues:[]};this.auto_evaluate=!1;var h=this.addInputPin("Switch",[0],VVVV.PinTypes.Value),e=this.addOutputPin("Output",[0],VVVV.PinTypes.Value),f=this.addInvisiblePin("Input Count",[2],VVVV.PinTypes.Value),d=[];this.initialize=function(){var c=Math.max(2,f.getValue(0));VVVV.Helpers.dynamicPins(this,d,c,function(c){return this.addInputPin("Input "+
(c+1),[0],VVVV.PinTypes.Value)})};this.evaluate=function(){f.pinIsChanged()&&this.initialize();for(var c=this.getMaxInputSliceCount(),b,a,q,k=0;k<c;k++)b=h.getValue(k),a=((Math.floor(b)+d.length)%d.length+d.length)%d.length,q=((Math.ceil(b)+d.length)%d.length+d.length)%d.length,b-=Math.floor(b),e.setValue(k,(1-b)*d[a].getValue(k)+b*d[q].getValue(k));e.setSliceCount(c)}};VVVV.Nodes.InputMorphValue.prototype=new VVVV.Core.Node;
VVVV.Nodes.Sift=function(b,a){this.constructor(b,"Sift (Value)",a);this.meta={authors:["Matthias Zauner"],original_authors:["VVVV Group"],credits:[],compatibility_issues:[]};this.auto_evaluate=!1;var h=this.addInputPin("Input",[0],VVVV.PinTypes.Value),e=this.addInputPin("Filter",[0],VVVV.PinTypes.Value),f=this.addInputPin("Epsilon",[0],VVVV.PinTypes.Value),d=this.addInputPin("Find",["First"],VVVV.PinTypes.Enum);d.enumOptions=["First","Last","All"];var c=this.addOutputPin("Hits",[0],VVVV.PinTypes.Value),
g=this.addOutputPin("Input Index",[0],VVVV.PinTypes.Value),m=this.addOutputPin("Filter Index",[0],VVVV.PinTypes.Value);this.evaluate=function(){this.getMaxInputSliceCount();var b=h.getSliceCount(),a=e.getSliceCount();c.setSliceCount(b);f.getValue(0);for(var r=d.getValue(0),n={},p=0,s=0;s<b;s++){var v=s;"Last"==r&&(v=b-s-1);var t=h.getValue(v);if("All"!=r){if(n[t]){c.setValue(v,0);continue}n[t]=!0}for(var u=0,w=0;w<a;w++)if(filter=e.getValue(w),filter==t){g.setValue(p,v);m.setValue(p,w);p++;u++;break}c.setValue(v,
u)}g.setSliceCount(p);m.setSliceCount(p)}};VVVV.Nodes.Sift.prototype=new VVVV.Core.Node;VVVV.Nodes.Join2dVector=function(b,a){this.constructor(b,"Vector (2d Join)",a);this.meta={authors:["Julien Vulliet"],original_authors:["VVVV Group"],credits:[],compatibility_issues:[""]};var h=this.addInputPin("X",[0],VVVV.PinTypes.Value),e=this.addInputPin("Y",[0],VVVV.PinTypes.Value),f=this.addOutputPin("XY",[0,0],VVVV.PinTypes.Value);this.evaluate=function(){var b=this.getMaxInputSliceCount();f.setSliceCount(2*b);for(var c=0;c<b;c++)f.setValue(2*c,h.getValue(c)),f.setValue(2*c+1,e.getValue(c))}};
VVVV.Nodes.Join2dVector.prototype=new VVVV.Core.Node;
VVVV.Nodes.Join3dVector=function(b,a){this.constructor(b,"Vector (3d Join)",a);this.meta={authors:["Julien Vulliet"],original_authors:["VVVV Group"],credits:[],compatibility_issues:[""]};var h=this.addInputPin("X",[0],VVVV.PinTypes.Value),e=this.addInputPin("Y",[0],VVVV.PinTypes.Value),f=this.addInputPin("Z",[0],VVVV.PinTypes.Value),d=this.addOutputPin("XYZ",[0,0,0],VVVV.PinTypes.Value);this.evaluate=function(){var c=this.getMaxInputSliceCount();d.setSliceCount(3*c);for(var b=0;b<c;b++)d.setValue(3*
b,h.getValue(b)),d.setValue(3*b+1,e.getValue(b)),d.setValue(3*b+2,f.getValue(b))}};VVVV.Nodes.Join3dVector.prototype=new VVVV.Core.Node;
VVVV.Nodes.Join4dVector=function(b,a){this.constructor(b,"Vector (4d Join)",a);this.meta={authors:["Julien Vulliet"],original_authors:["VVVV Group"],credits:[],compatibility_issues:[""]};var h=this.addInputPin("X",[0],VVVV.PinTypes.Value),e=this.addInputPin("Y",[0],VVVV.PinTypes.Value),f=this.addInputPin("Z",[0],VVVV.PinTypes.Value),d=this.addInputPin("W",[0],VVVV.PinTypes.Value),c=this.addOutputPin("XYZW",[0,0,0,1],VVVV.PinTypes.Value);this.evaluate=function(){var b=this.getMaxInputSliceCount();
c.setSliceCount(4*b);for(var a=0;a<b;a++)c.setValue(4*a,h.getValue(a)),c.setValue(4*a+1,e.getValue(a)),c.setValue(4*a+2,f.getValue(a)),c.setValue(4*a+3,d.getValue(a))}};VVVV.Nodes.Join4dVector.prototype=new VVVV.Core.Node;
VVVV.Nodes.Split2dVector=function(b,a){this.constructor(b,"Vector (2d Split)",a);this.meta={authors:["Julien Vulliet"],original_authors:["VVVV Group"],credits:[],compatibility_issues:[""]};var h=this.addInputPin("XY",[0],VVVV.PinTypes.Value),e=this.addOutputPin("X",[0],VVVV.PinTypes.Value),f=this.addOutputPin("Y",[0],VVVV.PinTypes.Value);this.evaluate=function(){for(var b=this.getMaxInputSliceCount(),c=0,a=0;a<b;a+=2)e.setValue(c,h.getValue(a)),f.setValue(c,h.getValue(a+1)),c++;e.setSliceCount(c);
f.setSliceCount(c)}};VVVV.Nodes.Split2dVector.prototype=new VVVV.Core.Node;
VVVV.Nodes.Split3dVector=function(b,a){this.constructor(b,"Vector (3d Split)",a);this.meta={authors:["Julien Vulliet"],original_authors:["VVVV Group"],credits:[],compatibility_issues:[""]};var h=this.addInputPin("XYZ",[0],VVVV.PinTypes.Value),e=this.addOutputPin("X",[0],VVVV.PinTypes.Value),f=this.addOutputPin("Y",[0],VVVV.PinTypes.Value),d=this.addOutputPin("Z",[0],VVVV.PinTypes.Value);this.evaluate=function(){for(var b=this.getMaxInputSliceCount(),a=0,m=0;m<b;m+=3)e.setValue(a,h.getValue(m)),f.setValue(a,
h.getValue(m+1)),d.setValue(a,h.getValue(m+2)),a++;e.setSliceCount(a);f.setSliceCount(a);d.setSliceCount(a)}};VVVV.Nodes.Split3dVector.prototype=new VVVV.Core.Node;
VVVV.Nodes.Split4dVector=function(b,a){this.constructor(b,"Vector (4d Split)",a);this.meta={authors:["Julien Vulliet"],original_authors:["VVVV Group"],credits:[],compatibility_issues:[""]};var h=this.addInputPin("XYZW",[0,0,0,1],VVVV.PinTypes.Value),e=this.addOutputPin("X",[0],VVVV.PinTypes.Value),f=this.addOutputPin("Y",[0],VVVV.PinTypes.Value),d=this.addOutputPin("Z",[0],VVVV.PinTypes.Value),c=this.addOutputPin("W",[0],VVVV.PinTypes.Value);this.evaluate=function(){for(var b=this.getMaxInputSliceCount(),
a=0,q=0;q<b;q+=4)e.setValue(a,h.getValue(q)),f.setValue(a,h.getValue(q+1)),d.setValue(a,h.getValue(q+2)),c.setValue(a,h.getValue(q+3)),a++;e.setSliceCount(a);f.setSliceCount(a);d.setSliceCount(a);c.setSliceCount(a)}};VVVV.Nodes.Split4dVector.prototype=new VVVV.Core.Node;VVVV.ShaderCodeResources={};VVVV.Types.ShaderCodeResource=function(){var b="";this.relatedNodes=[];this.definingNode=void 0;this.setSourceCode=function(a){b=a;for(a=0;a<this.relatedNodes.length;a++)this.relatedNodes[a].shaderSourceUpdated(b)};this.addRelatedNode=function(a){this.relatedNodes.push(a);""!=b&&a.shaderSourceUpdated(b)}};var identity=mat4.identity(mat4.create());
VVVV.Types.WebGlRenderState=function(){this.alphaBlending=!0;this.srcBlendMode="SRC_ALPHA";this.destBlendMode="ONE_MINUS_SRC_ALPHA";this.enableZWrite=!0;this.depthFunc="LEQUAL";this.depthOffset=0;this.polygonDrawMode="TRIANGLES";this.copy_attributes=function(b){this.alphaBlending=b.alphaBlending;this.alphaFunc=b.alphaFunc;this.srcBlendMode=b.srcBlendMode;this.destBlendMode=b.destBlendMode;this.enableZwrite=b.enableZWrite;this.depthFunc=b.depthFunc;this.depthOffset=b.depthOffset;this.polygonDrawMode=
b.polygonDrawMode};this.apply=function(b){this.alphaBlending?b.enable(b.BLEND):b.disable(b.BLEND);b.blendFunc(b[this.srcBlendMode],b[this.destBlendMode]);b.depthMask(this.enableZWrite)}};
VVVV.Types.VertexBuffer=function(b,a){this.vbo=void 0;this.subBuffers={};this.length=0;this.setSubBuffer=function(b,a,f){this.subBuffers[b]={usage:b,data:new Float32Array(f),size:a,offset:this.length};this.length+=this.subBuffers[b].data.byteLength};this.setSubBuffer("POSITION",3,a);this.create=function(){this.vbo=b.createBuffer();b.bindBuffer(b.ARRAY_BUFFER,this.vbo);b.bufferData(b.ARRAY_BUFFER,this.length,b.STATIC_DRAW);_(this.subBuffers).each(function(a){b.bufferSubData(b.ARRAY_BUFFER,a.offset,
a.data)})}};VVVV.Types.Mesh=function(b,a,h){this.vertexBuffer=a;this.indexBuffer=b.createBuffer();b.bindBuffer(b.ELEMENT_ARRAY_BUFFER,this.indexBuffer);b.bufferData(b.ELEMENT_ARRAY_BUFFER,new Uint16Array(h),b.STATIC_DRAW);this.numIndices=h.length};VVVV.Types.Layer=function(){this.mesh=null;this.textures=[];this.shader=null;this.uniforms={};this.uniformNames=[];this.renderState=defaultWebGlRenderState;this.toString=function(){return"Layer"}};
VVVV.PinTypes.WebGlResource={typeName:"WebGlResource",reset_on_disconnect:!0,connectionChangedHandlers:{webglresource:function(){function b(b){return"WebGlResource"==b||"WebGlTexture"==b}if(this.direction!=PinDirection.Input){var a=this.node,h=a.findDownstreamNodes("Renderer (EX9)");a.renderContexts||(a.renderContexts=[]);void 0==a.contextChanged&&(a.contextChanged=!1);for(var e=0;e<h.length;e++)a.contextChanged|=!a.renderContexts[e]||a.renderContexts[e].canvas.id!=h[e].ctxt.id,a.renderContexts[e]=
h[e].ctxt,a.dirty=!0;a.renderContexts.length!=h.length&&(a.renderContexts.length=h.length,a.contextChanged=!0,a.dirty=!0);a.isSubpatch||_(a.inputPins).each(function(f){var d;f.markPinAsChanged();"Renderer (EX9)"!=a.nodename&&f.isConnected()&&(0<f.links.length?d=f.links[0].fromPin:0<f.masterPin.links[0].fromPin.links.length&&(d=f.masterPin.links[0].fromPin),d&&b(d.typeName)&&d.connectionChanged())});this.masterPin&&b(this.masterPin.typeName)&&this.masterPin.connectionChanged()}}},defaultValue:function(){return new VVVV.Types.Layer}};
VVVV.PinTypes.WebGlTexture={typeName:"WebGlTexture",reset_on_disconnect:!0,connectionChangedHandlers:{webglresource:VVVV.PinTypes.WebGlResource.connectionChangedHandlers.webglresource},defaultValue:function(){return VVVV.DefaultTexture}};var defaultWebGlRenderState=new VVVV.Types.WebGlRenderState;VVVV.PinTypes.WebGlRenderState={typeName:"WebGlRenderState",reset_on_disconnect:!0,defaultValue:function(){return defaultWebGlRenderState}};VVVV.DefaultTexture="Empty Texture";
VVVV.Types.ShaderProgram=function(){this.uniformSpecs={};this.attributeSpecs={};this.attribSemanticMap={};this.uniformSemanticMap={};var b="",a="",h,e;this.isSetup=!1;this.shaderProgram=void 0;this.log="";var f=this;this.extractSemantics=function(b){f.attributeSpecs={};f.attribSemanticMap={};f.uniformSpecs={};f.uniformSemanticMap={};for(var c=/(uniform|attribute) ([a-zA-Z]+)([0-9xD]*) ([a-zA-Z0-9_]+)( : ([A-Z0-9]+))?( = \{?([^;\}]+)\}?)?;/g,a;a=c.exec(b);)"attribute"!=a[1]||f.attributeSpecs[a[4]]?
"uniform"!=a[1]||f.uniformSpecs[a[4]]||(f.uniformSpecs[a[4]]={varname:a[4],semantic:a[6],position:0,type:a[2],defaultValue:a[8],dimension:""==a[3]?1:a[3]},void 0!=a[6]&&(f.uniformSemanticMap[a[6]]=a[4])):(f.attributeSpecs[a[4]]={varname:a[4],semantic:a[6],position:0},void 0!=a[6]&&(f.attribSemanticMap[a[6]]=a[4]))};this.setVertexShader=function(a){b=a};this.setFragmentShader=function(b){a=b};this.setup=function(d){this.log="";h=d.createShader(d.VERTEX_SHADER);d.shaderSource(h,b.replace(/((uniform|attribute) [a-zA-Z0-9]+ [a-zA-Z0-9_]+)[^;]*/g,
"$1"));d.compileShader(h);d.getShaderParameter(h,d.COMPILE_STATUS)||(this.log=d.getShaderInfoLog(h),console.log(this.log));e=d.createShader(d.FRAGMENT_SHADER);d.shaderSource(e,a.replace(/((uniform|attribute) [a-zA-Z0-9]+ [a-zA-Z0-9_]+)[^;]*/g,"$1"));d.compileShader(e);d.getShaderParameter(e,d.COMPILE_STATUS)||(this.log=d.getShaderInfoLog(e),console.log(this.log));this.shaderProgram=d.createProgram();d.attachShader(this.shaderProgram,h);d.attachShader(this.shaderProgram,e);d.linkProgram(this.shaderProgram);
d.getProgramParameter(this.shaderProgram,d.LINK_STATUS)||console.log("Could not initialise shaders");_(this.attributeSpecs).each(function(b){b.position=d.getAttribLocation(f.shaderProgram,b.varname)});_(this.uniformSpecs).each(function(b){b.position=d.getUniformLocation(f.shaderProgram,b.varname)});this.isSetup=!0;return""==this.log}};
VVVV.Nodes.FileTexture=function(b,a){this.constructor(b,"FileTexture (EX9.Texture)",a);this.auto_nil=!1;this.meta={authors:["Matthias Zauner"],original_authors:["VVVV Group"],credits:[],compatibility_issues:["Always loads in background","No reload pin","No preload pin (preloading handled by browser)","No up and running pin","No texture info outputs"]};this.auto_evaluate=!1;var h=this.addInputPin("Filename",[""],VVVV.PinTypes.String),e=this.addOutputPin("Texture Out",[],VVVV.PinTypes.WebGlTexture),
f=this.addInvisiblePin("Type",["Texture"],VVVV.PinTypes.Enum);f.enumOptions=["Texture","Cube Texture"];var d=[];this.evaluate=function(){if(this.renderContexts){var b=this.renderContexts[0];if(b){if(this.contextChanged){for(var a=0;a<d.length;a++)d[a].context.deleteTexture(d[a]);d=[]}if(h.pinIsChanged()||f.pinIsChanged()||this.contextChanged){for(var m=f.getValue(0),q=this.getMaxInputSliceCount(),a=0;a<q;a++){var k=VVVV.Helpers.prepareFilePath(h.getValue(a),this.parentPatch);0===k.indexOf("http://")&&
void 0!==VVVV.ImageProxyPrefix&&(k=VVVV.ImageProxyPrefix+encodeURI(k));d[a]=b.createTexture();d[a].context=b;"Texture"==m?(d[a].image=new Image,d[a].image.onload=function(a){return function(){b.bindTexture(b.TEXTURE_CUBE_MAP,null);b.bindTexture(b.TEXTURE_2D,d[a]);b.texImage2D(b.TEXTURE_2D,0,b.RGBA,b.RGBA,b.UNSIGNED_BYTE,d[a].image);b.texParameteri(b.TEXTURE_2D,b.TEXTURE_MAG_FILTER,b.NEAREST);b.texParameteri(b.TEXTURE_2D,b.TEXTURE_MIN_FILTER,b.NEAREST);b.bindTexture(b.TEXTURE_2D,null);e.setValue(a,
d[a])}}(a),d[a].image.src=k):"Cube Texture"==m&&(d[a].image=new Image,d[a].image.onload=function(a){return function(){var f=[{face:b.TEXTURE_CUBE_MAP_POSITIVE_X,offset:[2,1]},{face:b.TEXTURE_CUBE_MAP_NEGATIVE_X,offset:[0,1]},{face:b.TEXTURE_CUBE_MAP_POSITIVE_Y,offset:[1,0]},{face:b.TEXTURE_CUBE_MAP_NEGATIVE_Y,offset:[1,2]},{face:b.TEXTURE_CUBE_MAP_POSITIVE_Z,offset:[1,1]},{face:b.TEXTURE_CUBE_MAP_NEGATIVE_Z,offset:[3,1]}];b.bindTexture(b.TEXTURE_CUBE_MAP,d[a]);var g=$('<canvas style="display:none" width="'+
this.width/4+'" height="'+this.height/3+'"></canvas>');$("body").append(g);for(var h=g.get(0).getContext("2d"),k=0;6>k;k++)h.save(),h.translate(-this.width/4*f[k].offset[0],-this.height/3*f[k].offset[1]),h.drawImage(this,0,0),b.texImage2D(f[k].face,0,b.RGBA,b.RGBA,b.UNSIGNED_BYTE,g.get(0)),b.texParameteri(b.TEXTURE_CUBE_MAP,b.TEXTURE_MAG_FILTER,b.NEAREST),b.texParameteri(b.TEXTURE_CUBE_MAP,b.TEXTURE_MIN_FILTER,b.NEAREST),h.restore();b.bindTexture(b.TEXTURE_CUBE_MAP,null);g.remove();e.setValue(a,d[a])}}(a),
d[a].image.src=k);e.setValue(a,VVVV.defaultTexture)}e.setSliceCount(q)}this.contextChanged=!1}}};this.destroy=function(){for(var b=0;b<d.length;b++)d[b].context.deleteTexture(d[b])}};VVVV.Nodes.FileTexture.prototype=new VVVV.Core.Node;
VVVV.Nodes.DX9Texture=function(b,a){this.constructor(b,"DX9Texture (EX9.Texture)",a);this.auto_nil=!1;this.meta={authors:["Matthias Zauner"],original_authors:["VVVV Group"],credits:[],compatibility_issues:["Using WebGL renderer as source doesnt work correctly in Chrome."]};var h=this.addInputPin("Source",[],VVVV.PinTypes.WebGlResource),e=this.addOutputPin("Texture Out",[],VVVV.PinTypes.WebGlTexture),f;this.evaluate=function(){if(this.renderContexts){var b=this.renderContexts[0];if(b){this.contextChanged&&
f&&(f.context.deleteTexture(f),f=void 0);if(h.isConnected()){var a=h.getValue(0);if(!a)return;0==(a.width&a.width-1)&&0==(a.height&a.height-1)||console.log("Warning: Source renderer's width/height is not a power of 2. DX9Texture will most likely not work.");a instanceof WebGLTexture?e.setValue(0,a):(void 0==f&&(f=b.createTexture(),f.context=b),b.bindTexture(b.TEXTURE_2D,f),b.texImage2D(b.TEXTURE_2D,0,b.RGBA,b.RGBA,b.UNSIGNED_BYTE,a),b.texParameteri(b.TEXTURE_2D,b.TEXTURE_MAG_FILTER,b.LINEAR),b.texParameteri(b.TEXTURE_2D,
b.TEXTURE_MIN_FILTER,b.LINEAR),b.bindTexture(b.TEXTURE_2D,null),e.setValue(0,f))}else delete f,b.deleteTexture(f),e.setValue(0,void 0);this.contextChanged=!1}}};this.destroy=function(){f&&f.context.deleteTexture(f)}};VVVV.Nodes.DX9Texture.prototype=new VVVV.Core.Node;
VVVV.Nodes.VideoTexture=function(b,a){this.constructor(b,"VideoTexture (EX9.Texture VMR9)",a);this.auto_nil=!1;this.meta={authors:["Matthias Zauner"],original_authors:["VVVV Group"],credits:[],compatibility_issues:["Only supports power-of-2 sized videos","Has no output pins for meta data"]};var h=this.addInputPin("Video",[],this),e=this.addOutputPin("Texture Out",[],VVVV.PinTypes.WebGlTexture),f;this.evaluate=function(){if(this.renderContexts){var b=this.renderContexts[0];if(b)if(h.isConnected()){var a=
h.getValue(0);0==(a.videoWidth&a.videoWidth-1)&&0==(a.videoHeight&a.videoHeight-1)||console.log("Warning: Video width/height is not a power of 2. VideoTexture will most likely not work.");if(void 0==f||this.contextChanged)f=b.createTexture();b.bindTexture(b.TEXTURE_2D,f);b.texImage2D(b.TEXTURE_2D,0,b.RGBA,b.RGBA,b.UNSIGNED_BYTE,a);b.texParameteri(b.TEXTURE_2D,b.TEXTURE_MAG_FILTER,b.NEAREST);b.texParameteri(b.TEXTURE_2D,b.TEXTURE_MIN_FILTER,b.NEAREST);b.bindTexture(b.TEXTURE_2D,null);e.setValue(0,
f);this.contextChanged=!1}else delete f,b.deleteTexture(f),e.setValue(0,void 0)}}};VVVV.Nodes.VideoTexture.prototype=new VVVV.Core.Node;
VVVV.Nodes.VertexBufferJoin=function(b,a){this.constructor(b,"VertexBuffer (EX9.Geometry Join)",a);this.auto_nil=!1;this.meta={authors:["Matthias Zauner"],original_authors:["VVVV Group"],credits:[],compatibility_issues:[]};var h=this.addInputPin("Position XYZ",[0,0,0],VVVV.PinTypes.Value),e=this.addInputPin("Normal XYZ",[0,0,0],VVVV.PinTypes.Value),f=this.addInputPin("Texture Coordinate 0 XY",[0,0],VVVV.PinTypes.Value),d=this.addInputPin("Apply",[1],VVVV.PinTypes.Value),c=this.addOutputPin("Vertex Buffer",
[],VVVV.PinTypes.WebGlResource),g=null;this.evaluate=function(){var b=this.renderContexts[0];if(b&&0.5<=d.getValue(0)){for(var a=[],k=[],r=[],n=0;n<this.getMaxInputSliceCount();n++)a[n]=parseFloat(h.getValue(n)),k[n]=parseFloat(f.getValue(n)),r[n]=parseFloat(e.getValue(n));g=new VVVV.Types.VertexBuffer(b,a);g.setSubBuffer("TEXCOORD0",2,k);g.setSubBuffer("NORMAL",3,r);g.create();c.setValue(0,g)}}};VVVV.Nodes.VertexBufferJoin.prototype=new VVVV.Core.Node;
VVVV.Nodes.MeshJoin=function(b,a){this.constructor(b,"Mesh (EX9.Geometry Join)",a);this.auto_nil=!1;this.meta={authors:["Matthias Zauner"],original_authors:["VVVV Group"],credits:[],compatibility_issues:[]};var h=this.addInputPin("Vertex Buffer",[],VVVV.PinTypes.WebGlResource),e=this.addInputPin("Indices",[0],VVVV.PinTypes.Value),f=this.addInputPin("Apply",[1],VVVV.PinTypes.Value),d=this.addOutputPin("Mesh",[],VVVV.PinTypes.WebGlResource),c=null;this.evaluate=function(){var b=this.renderContexts[0];
b&&0.5<=f.getValue(0)&&(h.isConnected()?(c=new VVVV.Types.Mesh(b,h.getValue(0),e.values),d.setValue(0,c)):(d.setValue(0,void 0),delete c))}};VVVV.Nodes.MeshJoin.prototype=new VVVV.Core.Node;
VVVV.Nodes.Grid=function(b,a){this.constructor(b,"Grid (EX9.Geometry)",a);this.auto_nil=!1;this.meta={authors:["Matthias Zauner"],original_authors:["VVVV Group"],credits:[],compatibility_issues:[]};var h=this.addInputPin("Resolution X",[2],VVVV.PinTypes.Value),e=this.addInputPin("Resolution Y",[2],VVVV.PinTypes.Value),f=this.addOutputPin("Mesh",[],VVVV.PinTypes.WebGlResource),d=null;this.evaluate=function(){if(this.renderContexts){var b=this.renderContexts[0];if(b){for(var a=parseInt(h.getValue(0)),
m=parseInt(e.getValue(0)),q=[],k=[],r=[],n=0,p=0;p<m;p++)for(var s=0;s<a;s++)q.push(parseFloat(s)/(a-1)-0.5),q.push(0.5-parseFloat(p)/(m-1)),q.push(0),n++,k.push(0),k.push(0),k.push(1),r.push(parseFloat(s)/(a-1)),r.push(parseFloat(p)/(m-1));q=new VVVV.Types.VertexBuffer(b,q);q.setSubBuffer("TEXCOORD0",2,r);q.setSubBuffer("NORMAL",3,k);q.create();k=[];for(p=0;p<m-1;p++)for(s=0;s<a-1;s++)r=s+a*p,k.push(r),k.push(r+1),k.push(r+a+1),k.push(r+a+1),k.push(r+a),k.push(r);d=new VVVV.Types.Mesh(b,q,k);f.setValue(0,
d)}}}};VVVV.Nodes.Grid.prototype=new VVVV.Core.Node;
VVVV.Nodes.Sphere=function(b,a){this.constructor(b,"Sphere (EX9.Geometry)",a);this.auto_nil=!1;this.meta={authors:["Matthias Zauner"],original_authors:["VVVV Group"],credits:[],compatibility_issues:[]};var h=this.addInputPin("Radius",[0.5],VVVV.PinTypes.Value),e=this.addInputPin("Resolution X",[15],VVVV.PinTypes.Value),f=this.addInputPin("Resolution Y",[15],VVVV.PinTypes.Value),d=this.addOutputPin("Mesh",[],VVVV.PinTypes.WebGlResource),c=null;this.evaluate=function(){if(this.renderContexts){var b=
this.renderContexts[0];if(b){for(var a=parseInt(e.getValue(0)),q=parseInt(f.getValue(0)),k=parseFloat(h.getValue(0)),r=[],n=[],p=[],s=0;s<q+1;s++)for(var v=Math.cos(-parseFloat(s)/q*Math.PI),t=0;t<a;t++){var u=Math.cos(2*(parseFloat(t)/a)*Math.PI)*Math.cos(Math.asin(v)),w=Math.sin(2*(parseFloat(t)/a)*Math.PI)*Math.cos(Math.asin(v));r.push(u*k);r.push(v*k);r.push(w*k);n.push(u);n.push(v);n.push(w);p.push(parseFloat(t)/a);p.push(parseFloat(s)/q)}k=new VVVV.Types.VertexBuffer(b,r);k.setSubBuffer("TEXCOORD0",
2,p);k.setSubBuffer("NORMAL",3,n);k.create();n=[];for(s=0;s<q;s++)for(t=0;t<a;t++)p=a*s,r=t+p,n.push(r),n.push((r+1)%a+p),n.push((r+1)%a+a+p),n.push((r+1)%a+a+p),n.push(r+a),n.push(r);c=new VVVV.Types.Mesh(b,k,n);d.setValue(0,c)}}}};VVVV.Nodes.Sphere.prototype=new VVVV.Core.Node;
VVVV.Nodes.Cylinder=function(b,a){this.constructor(b,"Cylinder (EX9.Geometry)",a);this.auto_nil=!1;this.meta={authors:["Matthias Zauner"],original_authors:["VVVV Group"],credits:[],compatibility_issues:[]};var h=this.addInputPin("Radius 1",[0.5],VVVV.PinTypes.Value),e=this.addInputPin("Radius 2",[0.5],VVVV.PinTypes.Value),f=this.addInputPin("Length",[1],VVVV.PinTypes.Value),d=this.addInputPin("Cycles",[1],VVVV.PinTypes.Value),c=this.addInputPin("Caps",[1],VVVV.PinTypes.Value),g=this.addInputPin("Resolution X",
[15],VVVV.PinTypes.Value),m=this.addInputPin("Resolution Y",[1],VVVV.PinTypes.Value),q=this.addOutputPin("Mesh",[],VVVV.PinTypes.WebGlResource),k=null;this.evaluate=function(){if(this.renderContexts){var b=this.renderContexts[0];if(b){var a=parseInt(g.getValue(0)),p=parseInt(m.getValue(0)),s=parseFloat(h.getValue(0)),v=parseFloat(e.getValue(0)),t=parseFloat(f.getValue(0)),u=parseFloat(d.getValue(0)),w=[],l=[],z=[];w.push(0);w.push(t/2);w.push(0);l.push(0);l.push(1);l.push(0);z.push(0);z.push(0);w.push(0);
w.push(-t/2);w.push(0);l.push(0);l.push(-1);l.push(0);z.push(0);z.push(0);for(var y=0;y<p+1;y++)for(var A=parseFloat(y)/p,F=(A-0.5)*-t,C=0;C<a+1;C++){var I=Math.cos(2*(parseFloat(C)/a)*Math.PI*u-Math.PI*u-Math.PI/2),J=Math.sin(2*(parseFloat(C)/a)*Math.PI*u-Math.PI*u-Math.PI/2),H=A*v+(1-A)*s;w.push(I*H);w.push(F);w.push(J*H);l.push(I);l.push(0);l.push(J);z.push(parseFloat(C)/a);z.push(parseFloat(y)/p)}s=new VVVV.Types.VertexBuffer(b,w);s.setSubBuffer("TEXCOORD0",2,z);s.setSubBuffer("NORMAL",3,l);s.create();
l=[];if(0.5<c.getValue(0))for(A=0;2>A;A++)for(C=0;C<a;C++)l.push(A),l.push(2+C+A+A*p*(a+1)),l.push(2+C+(1-A)+A*p*(a+1));for(y=0;y<p;y++)for(C=0;C<a;C++)A=C+(a+1)*y+2,l.push(A),l.push(A+1),l.push(A+a+2),l.push(A+a+2),l.push(A+a+1),l.push(A);k=new VVVV.Types.Mesh(b,s,l);q.setValue(0,k)}}}};VVVV.Nodes.Cylinder.prototype=new VVVV.Core.Node;
VVVV.Nodes.BlendWebGLAdvanced=function(b,a){function h(b){switch(b){case "One":return"ONE";case "Zero":return"ZERO";case "SrcAlpha":return"SRC_ALPHA";case "InvSrcAlpha":return"ONE_MINUS_SRC_ALPHA";case "DestAlpha":return"DST_ALPHA";case "InvDestAlpha":return"ONE_MINUS_DST_ALPHA";case "SrcColor":return"SRC_COLOR";case "InvSrcColor":return"ONE_MINUS_SRC_COLOR";case "DestColor":return"DST_COLOR";case "InvDestColor":return"ONE_MINUS_DST_COLOR"}return null}this.constructor(b,"Blend (EX9.RenderState Advanced)",
a);this.meta={authors:["Matthias Zauner"],original_authors:["VVVV Group"],credits:[],compatibility_issues:[]};var e=this.addInputPin("Render State In",[],VVVV.PinTypes.WebGlRenderState),f=this.addInputPin("Alpha Blending",[1],VVVV.PinTypes.Value),d=this.addInputPin("Source Blend Mode",["SrcAlpha"],VVVV.PinTypes.Enum),c=this.addInputPin("Destination Blend Mode",["SrcAlpha"],VVVV.PinTypes.Enum);d.enumOptions=c.enumOptions="One Zero SrcAlpha InvSrcAlpha DestAlpha InvDestAlpha SrcColor InvSrcColor DestColor InvDestColor".split(" ");
var g=this.addOutputPin("Render State Out",[],VVVV.PinTypes.WebGlRenderState),m=[];this.evaluate=function(){for(var b=this.getMaxInputSliceCount(),a=0;a<b;a++)void 0==m[a]&&(m[a]=new VVVV.Types.WebGlRenderState),m[a].copy_attributes(e.getValue(a)),m[a].alphaBlending=0.5<parseFloat(f.getValue(a)),m[a].srcBlendMode=h(d.getValue(a)),m[a].destBlendMode=h(c.getValue(a)),g.setValue(a,m[a]);g.setSliceCount(b)}};VVVV.Nodes.BlendWebGLAdvanced.prototype=new VVVV.Core.Node;
VVVV.Nodes.BlendWebGL=function(b,a){this.constructor(b,"Blend (EX9.RenderState)",a);this.meta={authors:["Matthias Zauner"],original_authors:["VVVV Group"],credits:[],compatibility_issues:["results differ from VVVV","Multiply mode not supported"]};var h=this.addInputPin("Render State In",[],VVVV.PinTypes.WebGlRenderState),e=this.addInputPin("Draw Mode",["Blend"],VVVV.PinTypes.Enum);e.enumOptions=["Add","Multiply","Blend","ColorAsAlphaAdd","ColorAsAlphaBlend"];var f=this.addOutputPin("Render State Out",
[],VVVV.PinTypes.WebGlRenderState),d=[];this.evaluate=function(){for(var b=this.getMaxInputSliceCount(),a=0;a<b;a++){void 0==d[a]&&(d[a]=new VVVV.Types.WebGlRenderState);d[a].copy_attributes(h.getValue(a));switch(e.getValue(a)){case "Add":d[a].srcBlendMode="SRC_ALPHA";d[a].destBlendMode="ONE";break;case "Multiply":console.log("Multiply Blend Mode not supported (or we just missed it)");case "Blend":d[a].srcBlendMode="SRC_ALPHA";d[a].destBlendMode="ONE_MINUS_SRC_ALPHA";break;case "ColorAsAlphaAdd":d[a].srcBlendMode=
"SRC_COLOR";d[a].destBlendMode="ONE";break;case "ColorAsAlphaBlend":d[a].srcBlendMode="SRC_COLOR",d[a].destBlendMode="ONE_MINUS_SRC_COLOR"}f.setValue(a,d[a])}f.setSliceCount(b)}};VVVV.Nodes.BlendWebGL.prototype=new VVVV.Core.Node;
VVVV.Nodes.FillWebGL=function(b,a){this.constructor(b,"Fill (EX9.RenderState)",a);this.meta={authors:["Matthias Zauner"],original_authors:["VVVV Group"],credits:[],compatibility_issues:["does not actually draw wireframe, because this is not supported in WebGL, but makes renderer use gl.LINE instead of gl.TRIANGLES when drawing"]};var h=this.addInputPin("Render State In",[],VVVV.PinTypes.WebGlRenderState),e=this.addInputPin("Fill Mode",["Solid"],VVVV.PinTypes.Enum);e.enumOptions=["Point","Solid","WireFrame"];
var f=this.addOutputPin("Render State Out",[],VVVV.PinTypes.WebGlRenderState),d=[];this.evaluate=function(){for(var b=this.getMaxInputSliceCount(),a=0;a<b;a++){void 0==d[a]&&(d[a]=new VVVV.Types.WebGlRenderState);d[a].copy_attributes(h.getValue(a));switch(e.getValue(a)){case "Point":d[a].polygonDrawMode="POINTS";break;case "Solid":d[a].polygonDrawMode="TRIANGLES";break;case "WireFrame":d[a].polygonDrawMode="LINES"}f.setValue(a,d[a])}f.setSliceCount(b)}};VVVV.Nodes.FillWebGL.prototype=new VVVV.Core.Node;
VVVV.Nodes.ZWriteEnableWebGL=function(b,a){function h(b){switch(b){case "Never":return"NEVER";case "Less":return"LESS";case "LessEqual":return"LEQUAL";case "Equal":return"EQUAL";case "NotEqual":return"NOTEQUAL";case "Greater":return"GREATER";case "GreaterEqual":return"GEQUAL";case "Always":return"ALWAYS"}return null}this.constructor(b,"ZWriteEnable (EX9.RenderState)",a);this.meta={authors:["Matthias Zauner"],original_authors:["VVVV Group"],credits:[],compatibility_issues:[]};var e=this.addInputPin("Render State In",
[],VVVV.PinTypes.WebGlRenderState),f=this.addInputPin("ZWrite Enable",[1],VVVV.PinTypes.Value),d=this.addInputPin("Compare Function",["Always"],VVVV.PinTypes.Enum);d.enumOptions="Never Less LessEqual Equal NotEqual Greater GreaterEqual Always".split(" ");var c=this.addInputPin("Depth Bias",[0],VVVV.PinTypes.Value),g=this.addOutputPin("Render State Out",[],VVVV.PinTypes.WebGlRenderState),m=[];this.evaluate=function(){for(var b=this.getMaxInputSliceCount(),a=0;a<b;a++)void 0==m[a]&&(m[a]=new VVVV.Types.WebGlRenderState),
m[a].copy_attributes(e.getValue(a)),m[a].enableZWrite=0.5<parseFloat(f.getValue(a)),m[a].depthFunc=h(d.getValue(a)),m[a].depthOffset=parseFloat(c.getValue(0)),g.setValue(a,m[a]);g.setSliceCount(b)}};VVVV.Nodes.ZWriteEnableWebGL.prototype=new VVVV.Core.Node;
VVVV.Nodes.GenericShader=function(b,a){this.constructor(b,"GenericShader (EX9.Effect)",a);this.auto_nil=!1;this.meta={authors:["Matthias Zauner"],original_authors:["VVVV Group"],credits:[],compatibility_issues:[]};this.shaderFile="";var h=this.addInputPin("Render State",[],VVVV.PinTypes.WebGlRenderState),e=this.addInputPin("Mesh",[],VVVV.PinTypes.WebGlResource),f=this.addInputPin("Transform",[],VVVV.PinTypes.Transform),d=this.addInputPin("Technique",[""],VVVV.PinTypes.Enum);d.enumOptions=[""];this.addOutputPin("Layer",
[],VVVV.PinTypes.WebGlResource);var c=[],g=null,m,q=!1,k=[],r=this;this.initialize=function(){var a=["Render State","Mesh","Transform","Technique"];_(r.inputPins).each(function(b){0>a.indexOf(b.pinname)&&(b.unvalidated=!0,k.push(b))});void 0==VVVV.ShaderCodeResources[r.shaderFile]?(VVVV.ShaderCodeResources[r.shaderFile]=new VVVV.Types.ShaderCodeResource,VVVV.ShaderCodeResources[r.shaderFile].addRelatedNode(r),$.ajax({url:VVVV.Helpers.prepareFilePath(r.shaderFile,r.parentPatch),async:!1,dataType:"text",
success:function(a){VVVV.ShaderCodeResources[r.shaderFile].setSourceCode(a)},error:function(){console.log("ERROR: Could not load shader file "+r.shaderFile.replace("%VVVV%",VVVV.Root));VVVV.onNotImplemented("Could not load shader file "+r.shaderFile.replace("%VVVV%",VVVV.Root))}})):VVVV.ShaderCodeResources[r.shaderFile].addRelatedNode(r)};this.shaderSourceUpdated=function(a){m=a;g||(g=new VVVV.Types.ShaderProgram);r.addUniformPins();r.setupShader();_(r.inputPins).each(function(a){a.markPinAsChanged()});
q=!0;this.parentPatch.afterUpdate()};this.addUniformPins=function(){g.extractSemantics(m);for(var a=[],b=0;b<k.length;b++)g.uniformSpecs[k[b].pinname.replace(/ /g,"_")]||(r.removeInputPin(k[b].pinname),a.push(b));for(b=0;b<a.length;b++)k.splice(a[b],1);_(g.uniformSpecs).each(function(a){if("VIEW"!=a.semantic&&"PROJECTION"!=a.semantic&&"WORLD"!=a.semantic){var b=VVVV.PinTypes.Value,c=[];switch(a.type){case "mat":b=VVVV.PinTypes.Transform;break;case "samplerCube":case "sampler":b=VVVV.PinTypes.WebGlTexture;
break;default:"COLOR"==a.semantic?(b=VVVV.PinTypes.Color,c=["1.0, 1.0, 1.0, 1.0"]):c=[0],a.defaultValue&&(c="COLOR"!=a.semantic?_(a.defaultValue.split(",")).map(function(a){return parseFloat(a)}):[a.defaultValue])}for(var d=0;d<k.length;d++)if(k[d].pinname==a.varname.replace(/_/g," ")){k[d].dimensions=a.dimension;k[d].unvalidated&&!k[d].isConnected()&&(k[d].values=r.defaultPinValues[k[d].pinname]?r.defaultPinValues[k[d].pinname].slice():c);k[d].typeName!=b.typeName&&(a=k[d].values.slice(),k[d].setType(b),
k[d].unvalidated&&(b.primitive||k[d].isConnected())&&(k[d].values=a),k[d].isConnected()&&!k[d].unvalidated&&(k[d].connectionChanged(),k[d].links[0].destroy()));k[d].unvalidated=!1;return}b=r.addInputPin(a.varname.replace(/_/g," "),c,b);b.dimensions=a.dimension;k.push(b)}})};this.setupShader=function(){var a=d.getValue(0),a=a.replace(/^\s*/,"").replace(/\s*$/,""),b=RegExp(/(vertex_shader|fragment_shader)\{([^\}]+)\}/g);d.enumOptions=[];for(var c;null!=(c=b.exec(m));)d.enumOptions=d.enumOptions.concat(c[2].replace(/\s/g,
"").split(","));d.enumOptions=d.enumOptions.filter(function(a,b,c){return c.indexOf(a)===b});0==d.enumOptions.length&&d.enumOptions.push("");if(""==a||0>d.enumOptions.indexOf(a))a=d.enumOptions[0],d.setValue(0,a);var f=RegExp("vertex_shader(\\{([a-zA-Z0-9]+,\\s*)*"+a+"(,\\s*[a-zA-Z0-9]+)*\\})?:([\\s\\S]*?)(vertex_shader|fragment_shader)"),b=RegExp("fragment_shader(\\{([a-zA-Z0-9]+,\\s*)*"+a+"(,\\s*[a-zA-Z0-9]+)*\\})?:([\\s\\S]*?)(vertex_shader|fragment_shader)");c=/STARTOFSTRING((\r?\n|.)*?)(vertex_shader|fragment_shader)/.exec("STARTOFSTRING"+
m);var e=c[1];void 0==(c=f.exec(m+"\nfragment_shader"))?console.log("ERROR: No vertex shader code for technique "+a+" found"):(f=c[4],void 0==(c=b.exec(m+"\nfragment_shader"))?console.log("ERROR: No fragment shader code for technique "+a+" found"):(g.setFragmentShader(e+c[4]),g.setVertexShader(e+f)))};this.evaluate=function(){if(this.renderContexts){var a=this.renderContexts[0];if(a&&g){if(!g.isSetup||this.contextChanged||d.pinIsChanged())this.setupShader(),g.setup(a)?VVVV.ShaderCodeResources[r.shaderFile].definingNode&&
VVVV.ShaderCodeResources[r.shaderFile].definingNode.showStatus("success","Successfully compiled"):VVVV.ShaderCodeResources[r.shaderFile].definingNode&&VVVV.ShaderCodeResources[r.shaderFile].definingNode.showStatus("error",g.log);var b=0;_(this.inputPins).each(function(a){var c=a.getSliceCount();a=a.pinname.replace(/ /g,"_");g.uniformSpecs[a]&&("vec"==g.uniformSpecs[a].type&&"COLOR"!=g.uniformSpecs[a].semantic)&&(c=parseInt(c/g.uniformSpecs[a].dimension));c>b&&(b=c)});e.isConnected()&&void 0!=e.getValue(0)||
(b=0);var m=c.length;if(this.contextChanged||q)m=0;b<m&&c.splice(b,m-b);for(var v=m;v<b;v++)c[v]=new VVVV.Types.Layer,c[v].mesh=e.getValue(0),c[v].shader=g,_(g.uniformSpecs).each(function(a){c[v].uniformNames.push(a.varname);c[v].uniforms[a.varname]={uniformSpec:a,value:void 0}});if(e.pinIsChanged())for(v=0;v<b;v++)c[v].mesh=e.getValue(0);for(v=0;v<b;v++)c[v].shader=g;for(a=0;a<k.length;a++){var t=k[a].pinname.replace(/ /g,"_");if(k[a].pinIsChanged()||m<b)for(v=0;v<b;v++)if("vec"==g.uniformSpecs[t].type){var u=
"COLOR"==g.uniformSpecs[t].semantic?_(k[a].getValue(v).split(",")).map(function(a){return parseFloat(a)}):k[a].getValue(v,k[a].dimensions);c[v].uniforms[t].value=new Float32Array(u)}else u=k[a].getValue(v),c[v].uniforms[t].value=u}if(h.pinIsChanged()||m<b)for(a=0;a<b;a++)h.isConnected()?c[a].renderState=h.getValue(a):c[a].renderState=VVVV.DefaultRenderState;if(f.pinIsChanged()||m<b)for(a=0;a<b;a++)m=this.inputPins.Transform.getValue(a),c[a].uniforms[c[a].shader.uniformSemanticMap.WORLD].value=m;this.outputPins.Layer.setSliceCount(b);
for(a=0;a<b;a++)this.outputPins.Layer.setValue(a,c[a]);q=this.contextChanged=!1}}};this.openUIWindow=function(){VVVV.ShaderCodeResources[r.shaderFile].definingNode&&VVVV.ShaderCodeResources[r.shaderFile].definingNode.openUIWindow()}};VVVV.Nodes.GenericShader.prototype=new VVVV.Core.Node;
VVVV.Nodes.Quad=function(b,a){this.constructor(b,"Quad (DX9)",a);this.auto_nil=!1;this.meta={authors:["Matthias Zauner"],original_authors:["VVVV Group"],credits:[],compatibility_issues:["No Sampler States","No texture coord mapping","No enable pin","Transprent pixels are discarded by default"]};this.auto_evaluate=!1;var h=this.addInputPin("Render State",[],VVVV.PinTypes.WebGlRenderState);this.addInputPin("Transform",[],VVVV.PinTypes.Transform);this.addInputPin("Texture",[],VVVV.PinTypes.WebGlTexture);
this.addInputPin("Texture Transform",[],VVVV.PinTypes.Transform);this.addInputPin("Color",["1.0, 1.0, 1.0, 1.0"],VVVV.PinTypes.Color);this.addOutputPin("Layer",[],VVVV.PinTypes.WebGlResource);var e=[],f=null,d=null;this.evaluate=function(){if(this.renderContexts){var a=this.renderContexts[0];if(a){if(this.contextChanged){var b=new VVVV.Types.VertexBuffer(a,[0.5,0.5,0,-0.5,0.5,0,0.5,-0.5,0,-0.5,-0.5,0]);b.setSubBuffer("TEXCOORD0",2,[1,0,0,0,1,1,0,1]);b.create();f=new VVVV.Types.Mesh(a,b,[0,1,2,1,3,
2]);b="#ifdef GL_ES\nprecision highp float;\n#endif\n";b+="uniform vec4 col : COLOR = {1.0, 1.0, 1.0, 1.0}; varying vec2 vs2psTexCd; uniform sampler2D Samp0; void main(void) { gl_FragColor = col*texture2D(Samp0, vs2psTexCd); if (gl_FragColor.a==0.0) discard;  }";d=new VVVV.Types.ShaderProgram;d.extractSemantics(b+"attribute vec3 PosO : POSITION; attribute vec2 TexCd : TEXCOORD0; uniform mat4 tW : WORLD; uniform mat4 tV : VIEW; uniform mat4 tP : PROJECTION; uniform mat4 tTex; varying vec2 vs2psTexCd; void main(void) { gl_Position = tP * tV * tW * vec4(PosO, 1.0); vs2psTexCd = (tTex * vec4(TexCd.xy-.5, 0.0, 1.0)).xy+.5; }");
d.setFragmentShader(b);d.setVertexShader("attribute vec3 PosO : POSITION; attribute vec2 TexCd : TEXCOORD0; uniform mat4 tW : WORLD; uniform mat4 tV : VIEW; uniform mat4 tP : PROJECTION; uniform mat4 tTex; varying vec2 vs2psTexCd; void main(void) { gl_Position = tP * tV * tW * vec4(PosO, 1.0); vs2psTexCd = (tTex * vec4(TexCd.xy-.5, 0.0, 1.0)).xy+.5; }");d.setup(a)}a=this.getMaxInputSliceCount();b=e.length;this.contextChanged&&(b=0);a<b&&e.splice(a,b-a);for(var m=b;m<a;m++)e[m]=new VVVV.Types.Layer,
e[m].mesh=f,e[m].shader=d,_(d.uniformSpecs).each(function(a){e[m].uniformNames.push(a.varname);e[m].uniforms[a.varname]={uniformSpec:a,value:void 0}});var q=this.inputPins.Color.pinIsChanged(),k=this.inputPins.Transform.pinIsChanged(),r=this.inputPins.Texture.pinIsChanged(),n=this.inputPins["Texture Transform"].pinIsChanged();if(q||b<a)for(q=0;q<a;q++){var p=this.inputPins.Color.getValue(q),p=_(p.split(",")).map(function(a){return parseFloat(a)});e[q].uniforms.col.value=new Float32Array(p)}if(h.pinIsChanged()||
b<a)for(q=0;q<a;q++)h.isConnected()?e[q].renderState=h.getValue(q):e[q].renderState=VVVV.DefaultRenderState;if(k||b<a)for(q=0;q<a;q++)k=this.inputPins.Transform.getValue(q),e[q].uniforms[e[q].shader.uniformSemanticMap.WORLD].value=k;if(r||b<a)for(q=0;q<a;q++)e[q].uniforms.Samp0.value=this.inputPins.Texture.getValue(q);if(n||b<a)for(q=0;q<a;q++)k=this.inputPins["Texture Transform"].getValue(q),e[q].uniforms.tTex.value=k;this.outputPins.Layer.setSliceCount(a);for(q=0;q<a;q++)this.outputPins.Layer.setValue(q,
e[q]);this.contextChanged=!1}}}};VVVV.Nodes.Quad.prototype=new VVVV.Core.Node;
VVVV.Nodes.Group=function(b,a){this.constructor(b,"Group (EX9)",a);this.auto_nil=!1;this.meta={authors:["Matthias Zauner"],original_authors:["VVVV Group"],credits:[],compatibility_issues:[]};var h=[],e=this.addInputPin("Enabled",[1],VVVV.PinTypes.Value),f=this.addInvisiblePin("Layer Template Count",[2],VVVV.PinTypes.Value),d=this.addOutputPin("Layer",[],VVVV.PinTypes.WebGlResource);this.initialize=function(){var a=Math.max(2,f.getValue(0));VVVV.Helpers.dynamicPins(this,h,a,function(a){return this.addInputPin("Layer "+
(a+1),[],VVVV.PinTypes.WebGlResource)})};this.evaluate=function(){f.pinIsChanged()&&this.initialize();var a=0;if(0.5<e.getValue(0))for(var b=0;b<h.length;b++)for(var m=0;m<h[b].getSliceCount();m++)d.setValue(a++,h[b].getValue(m));d.setSliceCount(a)}};VVVV.Nodes.Group.prototype=new VVVV.Core.Node;
VVVV.Nodes.RendererWebGL=function(b,a){function h(){$(u).detach("mousemove");$(u).detach("mousedown");$(u).detach("mouseup");VVVV.MousePositions[u.id]={x:0,y:0,wheel:0,lb:0,mb:0,rb:0};$(u).mousemove(function(a){var b=2*(a.pageX-$(this).offset().left)/$(this).width()-1;a=-(2*(a.pageY-$(this).offset().top)/$(this).height()-1);VVVV.MousePositions._all.x=b;VVVV.MousePositions._all.y=a;VVVV.MousePositions[u.id].x=b;VVVV.MousePositions[u.id].y=a});$(u).bind("mousewheel",function(a){a=a.originalEvent.wheelDelta/
120;VVVV.MousePositions[u.id].wheel+=a;VVVV.MousePositions._all.wheel+=a});$(u).bind("DOMMouseScroll",function(a){a=-a.originalEvent.detail/3;VVVV.MousePositions[u.id].wheel+=a;VVVV.MousePositions._all.wheel+=a});$(u).mousedown(function(a){switch(a.which){case 1:VVVV.MousePositions._all.lb=1;VVVV.MousePositions[u.id].lb=1;break;case 2:VVVV.MousePositions._all.mb=1;VVVV.MousePositions[u.id].mb=1;break;case 3:VVVV.MousePositions._all.rb=1,VVVV.MousePositions[u.id].rb=1}});$(u).mouseup(function(a){switch(a.which){case 1:VVVV.MousePositions._all.lb=
0;VVVV.MousePositions[u.id].lb=0;break;case 2:VVVV.MousePositions._all.mb=0;VVVV.MousePositions[u.id].mb=0;break;case 3:VVVV.MousePositions._all.rb=0,VVVV.MousePositions[u.id].rb=0}})}this.constructor(b,"Renderer (EX9)",a);this.auto_nil=!1;this.meta={authors:["Matthias Zauner"],original_authors:["VVVV Group"],credits:[],compatibility_issues:["Disabling Clear doesn't work in Chrome","No Fullscreen","No Enable Pin","No Aspect Ration and Viewport transform","No mouse output"]};this.addInputPin("Layers",
[],VVVV.PinTypes.WebGlResource);var e=this.addInputPin("Clear",[1],VVVV.PinTypes.Value),f=this.addInputPin("Background Color",["0.0, 0.0, 0.0, 1.0"],VVVV.PinTypes.Color),d=this.addInputPin("Backbuffer Width",[0],VVVV.PinTypes.Value),c=this.addInputPin("Backbuffer Height",[0],VVVV.PinTypes.Value),g=this.addInputPin("View",[],VVVV.PinTypes.Transform),m=this.addInputPin("Projection",[],VVVV.PinTypes.Transform),q=this.addInvisiblePin("Windowed Depthbuffer Format",["NONE"],VVVV.PinTypes.Enum);q.enumOptions=
["NONE","DX16"];var k=this.addOutputPin("Actual Backbuffer Width",[0],VVVV.PinTypes.Value),r=this.addOutputPin("Actual Backbuffer Height",[0],VVVV.PinTypes.Value),n=this.addOutputPin("EX9 Out",[],VVVV.PinTypes.WebGlResource),p=0,s=0,v,t,u,w=this.ctxt=void 0,l,z,y;this.getContexts=function(){if(this.invisiblePins["Descriptive Name"]){var a=this.invisiblePins["Descriptive Name"].getValue(0);if((a=$(a).get(0))&&"CANVAS"==a.nodeName)u=$(a);else{var b=parseInt(d.getValue(0)),k=parseInt(c.getValue(0));
u=$('<canvas width="'+(0<b?b:512)+'" height="'+(0<k?k:512)+'" id="vvvv-js-generated-renderer-'+(new Date).getTime()+'" class="vvvv-js-generated-renderer"></canvas>');a||(a="body");$(a).append(u)}if(u){h();try{w=u.get(0).getContext("experimental-webgl",{preserveDrawingBuffer:!0}),w.viewportWidth=parseInt(u.get(0).width),w.viewportHeight=parseInt(u.get(0).height)}catch(q){console.log(q)}this.ctxt=w;n.isConnected()&&this.renderContexts&&this.renderContexts[0]?(l=this.ctxt=this.renderContexts[0],z=l.createFramebuffer(),
l.bindFramebuffer(l.FRAMEBUFFER,z),z.width=u.get(0).width,z.height=u.get(0).height,y=l.createTexture(),l.bindTexture(l.TEXTURE_2D,y),l.pixelStorei(l.UNPACK_FLIP_Y_WEBGL,!0),l.texParameteri(l.TEXTURE_2D,l.TEXTURE_MAG_FILTER,l.LINEAR),l.texParameteri(l.TEXTURE_2D,l.TEXTURE_MIN_FILTER,l.LINEAR_MIPMAP_NEAREST),l.texImage2D(l.TEXTURE_2D,0,l.RGBA,z.width,z.height,0,l.RGBA,l.UNSIGNED_BYTE,null),l.generateMipmap(l.TEXTURE_2D),a=l.createRenderbuffer(),l.bindRenderbuffer(l.RENDERBUFFER,a),l.renderbufferStorage(l.RENDERBUFFER,
l.DEPTH_COMPONENT16,z.width,z.height),l.framebufferTexture2D(l.FRAMEBUFFER,l.COLOR_ATTACHMENT0,l.TEXTURE_2D,y,0),l.framebufferRenderbuffer(l.FRAMEBUFFER,l.DEPTH_ATTACHMENT,l.RENDERBUFFER,a),l.bindTexture(l.TEXTURE_2D,null),l.bindRenderbuffer(l.RENDERBUFFER,null),l.bindFramebuffer(l.FRAMEBUFFER,null)):this.renderContexts&&this.renderContexts[0]&&(this.renderContexts[0].deleteTexture(y),y=void 0);this.ctxt&&(p=parseInt(u.get(0).width),s=parseInt(u.get(0).height),l=this.ctxt,a=new Uint8Array([255,255,
255]),l.DefaultTexture={},l.DefaultTexture["2D"]=l.createTexture(),l.bindTexture(l.TEXTURE_2D,l.DefaultTexture["2D"]),l.texParameteri(l.TEXTURE_2D,l.TEXTURE_WRAP_S,l.CLAMP_TO_EDGE),l.texParameteri(l.TEXTURE_2D,l.TEXTURE_WRAP_T,l.CLAMP_TO_EDGE),l.texParameteri(l.TEXTURE_2D,l.TEXTURE_MIN_FILTER,l.NEAREST),l.texParameteri(l.TEXTURE_2D,l.TEXTURE_MAG_FILTER,l.NEAREST),l.pixelStorei(l.UNPACK_ALIGNMENT,1),l.texImage2D(l.TEXTURE_2D,0,l.RGB,1,1,0,l.RGB,l.UNSIGNED_BYTE,a),l.bindTexture(l.TEXTURE_2D,null),l.DefaultTexture.CUBE=
l.createTexture(),l.bindTexture(l.TEXTURE_CUBE_MAP,l.DefaultTexture.CUBE),l.texParameteri(l.TEXTURE_CUBE_MAP,l.TEXTURE_WRAP_S,l.CLAMP_TO_EDGE),l.texParameteri(l.TEXTURE_CUBE_MAP,l.TEXTURE_WRAP_T,l.CLAMP_TO_EDGE),l.texParameteri(l.TEXTURE_CUBE_MAP,l.TEXTURE_MIN_FILTER,l.NEAREST),l.texParameteri(l.TEXTURE_CUBE_MAP,l.TEXTURE_MAG_FILTER,l.NEAREST),l.pixelStorei(l.UNPACK_ALIGNMENT,1),l.texImage2D(l.TEXTURE_CUBE_MAP_POSITIVE_X,0,l.RGB,1,1,0,l.RGB,l.UNSIGNED_BYTE,a),l.texImage2D(l.TEXTURE_CUBE_MAP_NEGATIVE_X,
0,l.RGB,1,1,0,l.RGB,l.UNSIGNED_BYTE,a),l.texImage2D(l.TEXTURE_CUBE_MAP_POSITIVE_Y,0,l.RGB,1,1,0,l.RGB,l.UNSIGNED_BYTE,a),l.texImage2D(l.TEXTURE_CUBE_MAP_NEGATIVE_Y,0,l.RGB,1,1,0,l.RGB,l.UNSIGNED_BYTE,a),l.texImage2D(l.TEXTURE_CUBE_MAP_POSITIVE_Z,0,l.RGB,1,1,0,l.RGB,l.UNSIGNED_BYTE,a),l.texImage2D(l.TEXTURE_CUBE_MAP_NEGATIVE_Z,0,l.RGB,1,1,0,l.RGB,l.UNSIGNED_BYTE,a),l.bindTexture(l.TEXTURE_CUBE_MAP,null),this.inputPins.Layers.markPinAsChanged(),e.markPinAsChanged(),f.markPinAsChanged(),g.markPinAsChanged(),
m.markPinAsChanged())}}};this.destroy=function(){$(u).remove()};var A=!1;this.evaluate=function(){l=this.ctxt;if(this.invisiblePins["Descriptive Name"].pinIsChanged()||this.contextChanged)w&&$(w.canvas).hasClass("vvvv-js-generated-renderer")&&$(w.canvas).remove(),this.getContexts(),this.inputPins.Layers.isConnected()&&this.inputPins.Layers.links[0].fromPin.connectionChanged();A||(k.setValue(0,p),r.setValue(0,s),A=!0);if(void 0!=l){if(d.pinIsChanged()&&(!this.renderContexts||!this.renderContexts[0])){var a=
parseInt(d.getValue(0));0<a&&(p=a,$(w.canvas).attr("width",p),k.setValue(0,p))}!c.pinIsChanged()||this.renderContexts&&this.renderContexts[0]||(a=parseInt(c.getValue(0)),0<a&&(s=a,$(w.canvas).attr("height",s),r.setValue(0,s)));this.renderContexts&&this.renderContexts[0]&&l==this.renderContexts[0]?l.bindFramebuffer(l.FRAMEBUFFER,z):l.bindFramebuffer(l.FRAMEBUFFER,null);a=_(f.getValue(0).split(",")).map(function(a){return parseFloat(a)});l.clearColor(a[0],a[1],a[2],a[3]);l.clear(l.COLOR_BUFFER_BIT|
l.DEPTH_BUFFER_BIT);"NONE"==q.getValue(0)?l.disable(l.DEPTH_TEST):l.enable(l.DEPTH_TEST);m.pinIsChanged()&&(m.isConnected()?(v=mat4.create(),mat4.set(m.getValue(0),v)):(v=mat4.create(),mat4.ortho(-1,1,-1,1,-100,100,v)),mat4.scale(v,[1,1,-1]),this.renderContexts&&this.renderContexts[0]&&mat4.scale(v,[1,-1,1]));g.pinIsChanged()&&(t=g.getValue(0));if(this.contextChanged)this.contextChanged=!1;else{l.viewport(0,0,p,s);var b=a=null,e=null;if(this.inputPins.Layers.isConnected()){for(var h=this.inputPins.Layers.values,
u=0;u<h.length;u++)if(layer=h[u],void 0!=layer.shader){a!=layer.shader.shaderProgram&&(l.useProgram(layer.shader.shaderProgram),l.uniformMatrix4fv(layer.shader.uniformSpecs[layer.shader.uniformSemanticMap.PROJECTION].position,!1,v),l.uniformMatrix4fv(layer.shader.uniformSpecs[layer.shader.uniformSemanticMap.VIEW].position,!1,t));var E=layer.renderState;E||(E=defaultWebGlRenderState);E!=b&&E.apply(l);if(layer.mesh!=e||layer.shader.shaderProgram!=a)l.bindBuffer(l.ARRAY_BUFFER,layer.mesh.vertexBuffer.vbo),
_(layer.mesh.vertexBuffer.subBuffers).each(function(a){layer.shader.attributeSpecs[layer.shader.attribSemanticMap[a.usage]]&&-1!=layer.shader.attributeSpecs[layer.shader.attribSemanticMap[a.usage]].position&&(l.enableVertexAttribArray(layer.shader.attributeSpecs[layer.shader.attribSemanticMap[a.usage]].position),l.vertexAttribPointer(layer.shader.attributeSpecs[layer.shader.attribSemanticMap[a.usage]].position,a.size,l.FLOAT,!1,0,a.offset))}),l.bindBuffer(l.ELEMENT_ARRAY_BUFFER,layer.mesh.indexBuffer);
for(var b=layer.uniformNames.length,G=e=0;G<b;G++){var B=layer.uniforms[layer.uniformNames[G]];if(void 0!=B.value&&!(0<u&&layer.shader.shaderProgram==a&&h[u-1].uniforms[layer.uniformNames[G]]&&B.value==h[u-1].uniforms[layer.uniformNames[G]].value)){start=(new Date).getTime();switch(B.uniformSpec.type){case "mat":l["uniformMatrix"+B.uniformSpec.dimension+"fv"](B.uniformSpec.position,!1,B.value);break;case "vec":l["uniform"+B.uniformSpec.dimension+"fv"](B.uniformSpec.position,B.value);break;case "int":l["uniform"+
B.uniformSpec.dimension+"i"](B.uniformSpec.position,B.value);break;case "float":l["uniform"+B.uniformSpec.dimension+"f"](B.uniformSpec.position,B.value);break;case "sampler":var D=B.value;D==VVVV.DefaultTexture&&(D=l.DefaultTexture["2D"]);l.activeTexture(l["TEXTURE"+e]);l.bindTexture(l["TEXTURE_"+B.uniformSpec.dimension],D);l.uniform1i(B.uniformSpec.position,e);e++;break;case "samplerCube":D=B.value,D==VVVV.DefaultTexture&&(D=l.DefaultTexture.CUBE),l.activeTexture(l["TEXTURE"+e]),l.bindTexture(l.TEXTURE_CUBE_MAP,
D),l.uniform1i(B.uniformSpec.position,e),e++}loopstart=(new Date).getTime()}}l.drawElements(l[E.polygonDrawMode],layer.mesh.numIndices,l.UNSIGNED_SHORT,0);a=layer.shader.shaderProgram;b=E;e=layer.mesh}l.bindTexture(l.TEXTURE_2D,null);l.bindTexture(l.TEXTURE_CUBE_MAP,null)}this.renderContexts&&this.renderContexts[0]&&(l.bindTexture(l.TEXTURE_2D,y),l.generateMipmap(l.TEXTURE_2D),l.bindTexture(this.renderContexts[0].TEXTURE_2D,null));n.setValue(0,y)}}}};VVVV.Nodes.RendererWebGL.prototype=new VVVV.Core.Node;
VVVV.Nodes.DefineEffect=function(b,a){this.constructor(b,"DefineEffect (DX9)",a);this.auto_nil=!1;this.meta={authors:["Matthias Zauner"],original_authors:["Matthias Zauner"],credits:[],compatibility_issues:["Not available in classic VVVV"]};this.auto_evaluate=!1;var h=this.addInputPin("Effect Descriptor",[""],VVVV.PinTypes.String),e=this.addInvisiblePin("Source Code",["#ifdef GL_ES\nprecision highp float;\n#endif\n\nuniform mat4 tW : WORLD;\nuniform mat4 tV : VIEW;\nuniform mat4 tP : PROJECTION;\n\nuniform vec4 Color : COLOR = {1.0, 1.0, 1.0, 1.0};\nuniform sampler2D Texture;\nuniform mat4 Texture_Transform;\nuniform float Alpha = 1.0;\n\nvarying vec2 vs2psTexCd;\n\nvertex_shader:\n\nattribute vec3 PosO : POSITION;\nattribute vec2 TexCd : TEXCOORD0;\n\nvoid main(void) {\n  gl_Position = tP * tV * tW * vec4(PosO, 1.0);\n  vs2psTexCd = (Texture_Transform * vec4(TexCd, 0, 1)).xy;\n}\n\n\nfragment_shader:\n\nvoid main(void) {\n  gl_FragColor = Color * texture2D(Texture, vs2psTexCd) * vec4(1.0, 1.0, 1.0, Alpha);\n}"],
VVVV.PinTypes.String),f="",d;this.evaluate=function(){if(""!=h.getValue(0)){if(h.pinIsChanged()){var a=h.getValue(0);if(""==a)return;""==f?void 0==VVVV.ShaderCodeResources["./"+a+".vvvvjs.fx"]&&(VVVV.ShaderCodeResources["./"+a+".vvvvjs.fx"]=new VVVV.Types.ShaderCodeResource):VVVV.ShaderCodeResources["./"+a+".vvvvjs.fx"]=VVVV.ShaderCodeResources[f];f="./"+a+".vvvvjs.fx";VVVV.ShaderCodeResources[f].definingNode=this;VVVV.ShaderCodeResources[f].setSourceCode(e.getValue(0));d&&$("#path",d.document).text((this.parentPatch.nodename||
"root")+" / "+(""!=f?f:"Untitled"))}e.pinIsChanged()&&VVVV.ShaderCodeResources[f]&&VVVV.ShaderCodeResources[f].setSourceCode(e.getValue(0))}};this.openUIWindow=function(){d=window.open("code_editor.html",f+" / VVVV.js Effect Editor","location=no, width=800, height=800, toolbar=no");var a=this;window.setTimeout(function(){d.document.title=f+" / VVVV.js Effect Editor";var b=a.parentPatch.nodename||"root",h=""!=f?f:"Untitled";$("#path",d.document).text(b+" / "+h);$("textarea",d.document).text(e.getValue(0));
$("#compile_button",d.document).click(function(){""==f?a.showStatus("error","Please provide a name for this shader first"):(e.setValue(0,$("textarea",d.document).val()),0<VVVV.ShaderCodeResources[f].relatedNodes.length?a.showStatus("notice","Compiling ..."):a.showStatus("notice","No instance of this shader found. Create a node (./"+f+") and connect it to a Renderer (EX9) to compile."))});d.focus()},500)};this.showStatus=function(a,b){d&&($("#status",d.document).text(b),$("#status",d.document).attr("class",
a))}};VVVV.Nodes.DefineEffect.prototype=new VVVV.Core.Node;VVVV.Nodes.XPathXML=function(b,a){this.constructor(b,"XPath (XML)",a);this.meta={authors:["Matthias Zauner"],original_authors:["VVVV Group"],credits:[],compatibility_issues:["XML Index Output Pin not implemented","Query Index Output Pin not implemented"]};this.auto_evaluate=!1;var h=this.addInputPin("XML Input",["text"],VVVV.PinTypes.String),e=this.addInputPin("XPath Query",["text"],VVVV.PinTypes.String),f=this.addInputPin("Base Element",["text"],VVVV.PinTypes.String),d=this.addOutputPin("Output",
["text"],VVVV.PinTypes.String),c=this.addOutputPin("XML Index",[0],VVVV.PinTypes.Value),g=this.addOutputPin("Query Index",[0],VVVV.PinTypes.Value),m;this.evaluate=function(){var a=h.getValue(0),b=e.getValue(0);f.getValue(0);h.pinIsChanged()&&(m=(new DOMParser).parseFromString(a,"text/xml"));for(var a=m.evaluate(b,m,null,XPathResult.ORDERED_NODE_ITERATOR_TYPE,null),b=0,r;r=a.iterateNext();)r.value?d.setValue(b,r.value):r.data?d.setValue(b,r.data):d.setValue(b,""),b++;c.setValue(b,0);g.setValue(b,0);
d.setSliceCount(b);c.setSliceCount(1);g.setSliceCount(1)}};VVVV.Nodes.XPathXML.prototype=new VVVV.Core.Node;var UIState={Idle:0,Connecting:1,Moving:2,Creating:3,Changing:4,AreaSelecting:5};
VVVV.PinTypes.Value.makeLabel=VVVV.PinTypes.String.makeLabel=function(b,a){var h=a.IOBoxRows();a.IOBoxInputPin().getSliceCount();d3.select(b).selectAll(".vvvv-node-label").remove();for(var e=0;e<h;e++)d3.select(b).append("svg:text").text(a.IOBoxInputPin().getValue(e)).attr("class","vvvv-node-label").attr("shape-rendering","crispEdges").attr("dy",function(a){return 12*e+12}).attr("dx",4).attr("font-size",10).attr("font-family","Lucida Sans Unicode")};
VVVV.PinTypes.Value.openInputBox=VVVV.PinTypes.String.openInputBox=function(b,a,h,e){$inputbox=$("<input type='text' value='"+h.getValue(e)+"' class='pininputbox value resettable'/>");$inputbox.css("position",a.css("position"));$inputbox.css("width",a.css("width"));$inputbox.css("height",a.css("height"));$inputbox.css("left",a.css("left"));$inputbox.css("top",a.css("top"));a.replaceWith($inputbox);$inputbox.get(0).select();$inputbox.change(function(){h.setValue(e,$(this).val());h.node.parentPatch.editor.update(h.node.parentPatch,
"<PATCH><NODE id='"+h.node.id+"'><PIN pinname='"+h.pinname+"' values='"+_(h.values).map(function(a){return"|"+a.toString().replace(/\|/g,"||")+"|"}).join(",")+"'/></NODE>")});$inputbox.keydown(function(a){13==a.which&&($(this).change(),$(this).remove())});if("Value"==this.typeName){var f=function(a,b,f){var e=$(a).val()%1;if(!isNaN(e)){var h;h=1;if(f.altKey||0!==e)h=0.01;b*=h;$(a).val(parseFloat($(a).val())+b);$(a).change()}};$inputbox.bind("mousewheel",function(a){f(this,a.originalEvent.wheelDelta/
120,a);a.preventDefault();return!1});$inputbox.bind("DOMMouseScroll",function(a){f(this,-a.originalEvent.detail/3,a);a.preventDefault();return!1})}$inputbox.bind("paste",function(a){a.stopPropagation()});$inputbox.bind("copy",function(a){a.stopPropagation()})};
VVVV.PinTypes.Enum.openInputBox=function(b,a,h,e){$inputbox=$("<select class='pininputbox value resettable'>");for(b=0;b<h.enumOptions.length;b++)$opt=$('<option value="'+h.enumOptions[b]+'">'+h.enumOptions[b]+"</option>"),h.getValue(e)==h.enumOptions[b]&&$opt.attr("selected",!0),$inputbox.append($opt);$inputbox.css("position",a.css("position"));$inputbox.css("width",a.css("width"));$inputbox.css("height",a.css("height"));$inputbox.css("left",a.css("left"));$inputbox.css("top",a.css("top"));a.replaceWith($inputbox);
$inputbox.change(function(){h.setValue(e,$(this).val());h.node.parentPatch.editor.update(h.node.parentPatch,"<PATCH><NODE id='"+h.node.id+"'><PIN pinname='"+h.pinname+"' values='"+_(h.values).map(function(a){return"|"+a+"|"}).join(",")+"'/></NODE>")})};
VVVV.PinTypes.Color.makeLabel=function(b,a){var h=a.IOBoxRows();a.IOBoxInputPin().getSliceCount();d3.select(b).selectAll(".vvvv-node-label").remove();for(var e=0;e<h;e++)d3.select(b).append("svg:rect").attr("class","vvvv-node-label").attr("height",a.getHeight()/h-8).attr("width",a.getWidth()).attr("y",12*e+4).attr("fill",function(b){b=a.IOBoxInputPin().getValue(e).split(",");for(var d=0;d<b.length;d++)b[d]=parseInt(256*b[d]);return"rgba("+b.join(",")+")"})};
VVVV.PinTypes.Color.openInputBox=function(b,a,h,e){function f(a){c=a.altKey&&a.shiftKey?3:a.altKey?1:a.shiftKey?2:0}function d(a){var b=h.getValue(e).split(","),d=VVVV.PinTypes.Color.rgbToHsv(b[0],b[1],b[2]);d[3]=parseFloat(b[3]);d[c]+=0.01*a;0!=c&&(d[c]=Math.min(1,Math.max(0,d[c])));b=VVVV.PinTypes.Color.hsvToRgb(d[0],d[1],d[2]);b[3]=d[3];$inputbox.css("background-color","rgba("+_(b).map(function(a){return parseInt(255*a)}).join(",")+")");ibx=$inputbox;b.join(",");h.setValue(e,b.join(","));h.node.parentPatch.editor.update(h.node.parentPatch,
"<PATCH><NODE id='"+h.node.id+"'><PIN pinname='"+h.pinname+"' values='"+_(h.values).map(function(a){return"|"+a+"|"}).join(",")+"'/></NODE>")}var c=0;$(b.window.document).keydown(f).keyup(f);$inputbox=$('<div class="pininputbox color resettable"></div>');$inputbox.css("position",a.css("position"));$inputbox.css("width",a.css("width"));$inputbox.css("height",a.css("height"));$inputbox.css("left",a.css("left"));$inputbox.css("top",a.offset().top-8+"px");b=h.getValue(e).split(",");for(var g=0;g<b.length;g++)b[g]=
parseInt(256*b[g]);$inputbox.css("background-color","rgba("+b.join(",")+")");a.replaceWith($inputbox);$inputbox.on("mousewheel",function(a){d(a.originalEvent.wheelDelta/120);a.preventDefault();return!1});$inputbox.bind("DOMMouseScroll",function(a){d(-a.originalEvent.detail/3);a.preventDefault();return!1})};VVVV.Editors.BrowserEditor={};
VVVV.Editors.BrowserEditor.PatchWindow=function(b,a,h){function e(){c.selectAll(".vvvv-node.selected").attr("class",function(a){return a.isIOBox?"vvvv-node vvvv-iobox":"vvvv-node"});n=[]}this.state=UIState.Idle;var f=0,d=0,c,g,m,q,k,r=void 0,n=[],p=b,s=0,v=VVVV.Root+"/patch.html",t=!1,u=0,w=0,l=0,z=0;b.isSubpatch&&(v="patch.html");this.window=h?window:window.open(v,b.nodename,"location=no, width="+b.windowWidth+", height="+b.windowHeight+", toolbar=no");var y=this;window.setTimeout(function(){for(var k=
0;k<p.nodeList.length;k++)s=Math.max(s,p.nodeList[k].id);h?root=d3.select($(h).get(0)):(y.window.document.title=b.nodename,root=d3.select(y.window.document.body));if(!h){$("body",y.window.document).on("copy",function(a){for(var b=$("<PATCH>"),c=[],d=_(n).map(function(a){return a.id}),f=0;f<n.length;f++)b.append(n[f].serialize()),_(n[f].inputPins).each(function(a){for(var b=0;b<a.links.length;b++)0<=d.indexOf(a.links[b].fromPin.node.id)&&c.push(a.links[b])});for(f=0;f<c.length;f++)b.append(c[f].serialize());
b='<!DOCTYPE PATCH  SYSTEM "http://vvvv.org/versions/vvvv45beta28.1.dtd" >\r\n'+b.wrapAll("<d></d>").parent().html();b=b.replace(/<patch/g,"<PATCH");b=b.replace(/<\/patch>/g,"\n  </PATCH>");b=b.replace(/<node/g,"\n  <NODE");b=b.replace(/<\/node>/g,"\n  </NODE>");b=b.replace(/<bounds/g,"\n  <BOUNDS");b=b.replace(/<\/bounds>/g,"\n  </BOUNDS>");b=b.replace(/<pin/g,"\n  <PIN");b=b.replace(/<\/pin>/g,"\n  </PIN>");b=b.replace(/<lonk/g,"\n  <LINK");b=b.replace(/<\/lonk>/g,"\n  </LINK>");a.originalEvent.clipboardData.setData("text/plain",
b);a.preventDefault();return!1});var m=0,q=0;$("body",y.window.document).mousemove(function(a){m=a.pageX;q=a.pageY});$("body",y.window.document).on("paste",function(b){b=b.originalEvent.clipboardData.getData("text/plain");if(!b.match(/^<!DOCTYPE PATCH/))return!1;$patch=$(b);var d=void 0,f=void 0;$patch.find("node bounds").each(function(){var a=parseInt($(this).attr("left")),b=parseInt($(this).attr("top"));if(!d||a<d)d=a;if(!f||b<f)f=b});var g={};$patch.find("node").each(function(){s++;g[$(this).attr("id")]=
s;$(this).attr("createme","pronto");$(this).attr("id",s);var a=parseInt($(this).find("bounds").attr("left"))-d+15*m,b=parseInt($(this).find("bounds").attr("top"))-f+15*q;$(this).find("bounds").attr("left",a);$(this).find("bounds").attr("top",b)});$patch.find("link").each(function(){$(this).attr("createme","pronto");var a=$(this).attr("srcnodeid"),b=$(this).attr("dstnodeid");$(this).attr("srcnodeid",g[a]);$(this).attr("dstnodeid",g[b])});b=$patch.wrapAll("<d></d>").parent().html();a.update(p,b);e();
var h=_(g).map(function(a){return a});c.selectAll(".vvvv-node").each(function(a){0<=h.indexOf(parseInt(a.id))&&(n.push(a),d3.select(this).attr("class","vvvv-node selected"))})})}c=root.append("svg:svg").attr("class","chart").attr("width",Math.max(p.windowWidth,p.boundingBox.width)).attr("height",Math.max(p.windowHeight,p.boundingBox.height));k=c.append("svg:rect").attr("class","background").attr("width",Math.max(p.windowWidth,p.boundingBox.width)).attr("height",Math.max(p.windowHeight,p.boundingBox.height));
h||(c.on("mousemove",function(){if(y.state==UIState.Connecting)c.select(".vvvv-link.current-link").attr("x2",function(a){return d3.event.pageX+(d3.select(this).attr("x1")<d3.event.pageX?-1:1)}).attr("y2",function(a){return d3.event.pageY+(d3.select(this).attr("y1")<d3.event.pageY?-1:1)});else if(y.state==UIState.Moving){var a=d3.event.pageX-f,b=d3.event.pageY-d;c.selectAll(".vvvv-node.selected").attr("transform",function(c){return"translate("+(c.x+a)+","+(c.y+b)+")"});for(var g=0;g<n.length;g++){var h=
n[g];c.selectAll(".vvvv-link line").filter(function(a){return a.fromPin.node.id==h.id}).attr("x1",function(b){return b.fromPin.x+b.fromPin.node.x+a}).attr("y1",function(a){return a.fromPin.y+a.fromPin.node.y+b});c.selectAll(".vvvv-link line").filter(function(a){return a.toPin.node.id==h.id}).attr("x2",function(b){return b.toPin.x+b.toPin.node.x+a}).attr("y2",function(a){return a.toPin.y+a.toPin.node.y+b})}}else y.state==UIState.AreaSelecting&&(l=d3.event.pageX,z=d3.event.pageY,c.select(".selection-area").attr("transform",
"translate("+Math.min(u,l)+", "+Math.min(w,z)+")").attr("width",Math.abs(l-u)).attr("height",Math.abs(z-w)),e(),c.selectAll(".vvvv-node").each(function(a){for(var b=[a.x,a.x+a.getWidth()],c=[a.y,a.y+a.getHeight()],d=!1,f=0;2>f;f++)for(var e=0;2>e;e++)b[f]>=Math.min(u,l)&&(b[f]<=Math.max(u,l)&&c[e]>=Math.min(w,z)&&c[e]<=Math.max(w,z))&&(d=!0);d&&(d3.select(this).attr("class","vvvv-node selected"),n.push(a))}))}).on("contextmenu",function(){y.state==UIState.Connecting&&(c.select(".vvvv-link.current-link").remove(),
y.state=UIState.Idle);d3.event.stopPropagation();d3.event.preventDefault();return!1}).on("mouseup",function(){if(y.state==UIState.Moving){y.state=UIState.Idle;for(var b=d3.event.pageX-f,e=d3.event.pageY-d,g="<PATCH>",h=0;h<n.length;h++)var k=n[h],g=g+("<NODE componentmode='Node' id='"+k.id+"'><BOUNDS type='Node' left='"+15*(b+k.x)+"' top='"+15*(e+k.y)+"' width='"+k.width+"' height='"+k.height+"'/></NODE>");a.update(p,g+"</PATCH>")}y.state==UIState.AreaSelecting&&(c.select(".selection-area").remove(),
y.state=UIState.Idle)}).on("dblclick",function(){function b(a){g.empty();var c=e.find("#node_filter").val().toLowerCase();a=VVVV.NodeNames.concat(_(VVVV.ShaderCodeResources).map(function(a,b){return b.replace("%VVVV%/effects/","")}));a=_(_(a).filter(function(a){return 0<=VVVV.Helpers.translateOperators(a).toLowerCase().indexOf(c)})).sortBy(function(a){return a.toLowerCase().indexOf(c)});for(var d=0;d<a.length;d++)g.append($("<option>"+a[d]+"</option>"));g.find("option").first().attr("selected",!0)}
function c(){var b=e.find("#node_filter").val(),g=e.find("#new_node option:selected").val(),h="";g||!b.match(/\.fx$/)&&!b.match(/\.v4p$/)||(g=b);if(g){var k;(k=g.match(/^(.*\/([^\.]+))(\.vvvvjs)?\.fx$/))?(g=k[2]+" (EX9.Effect)",h=k[1]+".fx"):(k=g.match("([^.]+)(.vvvvjs)?.fx$"))?(g=k[1]+" (EX9.Effect)",h="%VVVV%/effects/"+k[1]+".fx"):g.match("[^/].v4p$")&&(h=g=b);s++;g="<PATCH>"+("<NODE componentmode='Hidden' id='"+s+"' nodename='"+g+"' systemname='"+g+"' "+(""!=h?"filename='"+h+"'":"")+">");g+="<BOUNDS type='Node' left='"+
15*d+"' top='"+15*f+"' width='100' height='100'/>"}else s++,g="<PATCH>"+("<NODE componentmode='Hidden' id='"+s+"' nodename='IOBox (String)' systemname='IOBox (String)'>"),g+="<BOUNDS type='Node' left='"+15*d+"' top='"+15*f+"' width='100' height='100'/>",g+="<PIN pinname='Input String' values='|"+b+"|'/>";a.update(p,g+"</NODE>");e.remove()}$("#node_selection",y.window.document).remove();var d=d3.event.pageX,f=d3.event.pageY,e=$('<div id="node_selection"><input type="text" id="node_filter"/></div>'),
g=$('<select id="new_node" size="8">');e.append(g);e.css("left",d);e.css("top",f);$("body",y.window.document).append(e);e.find("input").bind("paste",function(a){a.stopPropagation()});e.find("#node_filter").get(0).focus();b();e.find("#node_filter").keyup(function(a){if(13==a.which)c();else{if(40==a.which)return g.find("option:selected").first().next().attr("selected",!0),!1;if(38==a.which)return g.find("option:selected").first().prev().attr("selected",!0),!1;b()}});e.find("#new_node").click(c)}).on("mousedown",
function(){y.state==UIState.Idle&&(y.state=UIState.AreaSelecting,u=l=d3.event.pageX+1,w=z=d3.event.pageY+1,c.append("svg:rect").attr("class","selection-area").attr("stroke","#000").attr("stroke-dasharray","2,2").attr("stroke-width",1).attr("fill","rgba(0,0,0,0)").attr("transform","translate("+u+", "+w+")").attr("width",0).attr("height",0),e())}),k.on("click",function(){y.state=UIState.Idle;$(".resettable",y.window.document).remove();$("#node_selection",y.window.document).remove();e();r=void 0}),k=
function(a){t=a.shiftKey},$(y.window.document).keydown(k),$(y.window.document).keyup(k),$(y.window.document).keydown(function(b){if(46==b.which&&0<n.length){var d="<PATCH>";for(b=0;b<n.length;b++){var f=n[b],d=d+("<NODE id='"+n[b].id+"' deleteme='pronto'/>");_(f.inputPins).each(function(a){_(a.links).each(function(a){d+="<LINK deleteme='pronto' srcnodeid='"+a.fromPin.node.id+"' srcpinname='"+a.fromPin.pinname+"' dstnodeid='"+a.toPin.node.id+"' dstpinname='"+a.toPin.pinname+"'/>"})});_(f.outputPins).each(function(a){_(a.links).each(function(a){d+=
"<LINK deleteme='pronto' srcnodeid='"+a.fromPin.node.id+"' srcpinname='"+a.fromPin.pinname+"' dstnodeid='"+a.toPin.node.id+"' dstpinname='"+a.toPin.pinname+"'/>"})})}d+="</PATCH>";a.update(p,d);n=[]}else if(115!=b.which&&83!=b.which||!b.ctrlKey){if(73==b.which&&b.ctrlKey)return a.inspector?a.inspector.win.focus():a.openInspector("."),b.preventDefault(),!1;if(65==b.which&&b.ctrlKey)return e(),c.selectAll(".vvvv-node").each(function(a){n.push(a);d3.select(this).attr("class","vvvv-node selected")}),
b.preventDefault(),!1}else return a.save(p.nodename,p.toXML()),b.preventDefault(),!1}),$(y.window).resize(function(){p.windowWidth=$(this).width();p.windowHeight=$(this).height();p.boundingBox.width=Math.max(p.windowWidth,p.boundingBox.width);p.boundingBox.height=Math.max(p.windowHeight,p.boundingBox.height);p.afterUpdate()}));y.drawComplete();p.afterUpdate=function(){y.drawComplete();a.inspector&&window.setTimeout(a.inspector.update,100)};p.afterEvaluate=function(){g.filter(function(a){return a.isIOBox&&
VVVV.PinTypes[a.IOBoxInputPin().typeName].makeLabel}).each(function(a){VVVV.PinTypes[a.IOBoxInputPin().typeName].makeLabel(this,a)})}},1E3);this.close=function(){this.window.close()};this.drawComplete=function(){g&&g.remove();k&&k.remove();h||p.windowWidth==$(y.window).width()&&p.windowHeight==$(y.window).height()||y.window.resizeTo(p.windowWidth,p.windowHeight);c.attr("width",Math.max(p.windowWidth,p.boundingBox.width)).attr("height",Math.max(p.windowHeight,p.boundingBox.height));c.selectAll(".background").attr("width",
Math.max(p.windowWidth,p.boundingBox.width)).attr("height",Math.max(p.windowHeight,p.boundingBox.height));var b=c.append("svg:g").attr("class","link-group");g=c.selectAll("g.vvvv-node").data(p.nodeList).enter().append("svg:g").attr("class",function(a){var b="vvvv-node";a.isIOBox&&(b+=" vvvv-iobox");0<=n.indexOf(a)&&(b+=" selected");return b}).attr("id",function(a){return"vvvv-node-"+a.id}).attr("transform",function(a){return"translate("+a.x+","+a.y+")"});g.append("svg:rect").attr("class","vvvv-node-background").attr("height",
function(a){return a.getHeight()}).attr("width",function(a){return a.getWidth()}).attr("fill",function(a){return a.isComment()?"rgba(0,0,0,0)":a.not_implemented?"rgba(255,0,0,1)":"#cdcdcd"});g.append("svg:rect").attr("class","vvvv-node-pinbar").attr("height",function(a){return a.isIOBox?2:4}).attr("fill",function(a){return a.isIOBox?"#dddddd":"#9a9a9a"}).attr("width",function(a){return a.getWidth()});g.append("svg:rect").attr("class","vvvv-node-pinbar").attr("y",function(a){return a.isIOBox?a.getHeight()-
2:a.getHeight()-4}).attr("height",function(a){return a.isIOBox?2:4}).attr("fill",function(a){return a.isIOBox?"#dddddd":"#9a9a9a"}).attr("width",function(a){return a.getWidth()});g.append("svg:g").attr("class","descriptive-name-bg");g.append("svg:text").text(function(a){return a.invisiblePins["Descriptive Name"]?a.invisiblePins["Descriptive Name"].getValue(0):null}).attr("class","vvvv-node-descriptive-name").attr("shape-rendering","crispEdges").attr("dy",function(a){return a.getHeight()+12}).attr("dx",
2).attr("font-size",10).attr("font-family","Lucida Sans Unicode").attr("fill","white");g.selectAll("g.descriptive-name-bg").append("svg:rect").attr("fill",function(a){return void 0==a.invisiblePins["Descriptive Name"]||""==a.invisiblePins["Descriptive Name"].getValue(0)?"rgba(0,0,0,0)":"rgba(0,0,0,1)"}).attr("y",function(a){return a.getHeight()}).attr("width",5).attr("height",14);g.each(function(a){if(a.isIOBox&&VVVV.PinTypes[a.IOBoxInputPin().typeName].makeLabel){VVVV.PinTypes[a.IOBoxInputPin().typeName].makeLabel(this,
a);for(var b=a.IOBoxRows(),c=a.IOBoxInputPin().getSliceCount(),d=this,f=0;f<b;f++)(function(f){var e=d3.select(d).append("svg:rect").attr("width",a.getWidth()+2).attr("height",a.getHeight()/b-4).attr("y",12*f+2).attr("fill","rgba(0,0,0,0)");if(!h)e.on("contextmenu",function(a){if(void 0!=a.IOBoxInputPin().getValue(0)&&!a.IOBoxInputPin().isConnected()){$(".resettable",y.window.document).remove();var d=$("<input type='text'/>");$("body",y.window.document).append(d);d.css("position","absolute");d.css("left",
$(this).offset().left);d.css("top",$(this).offset().top+2);d.css("width",a.getWidth());d.css("height",a.getHeight()/b-4);VVVV.PinTypes[a.IOBoxInputPin().typeName].openInputBox(y.window,d,a.IOBoxInputPin(),f%c)}d3.event.stopPropagation();d3.event.preventDefault();return!1})})(f)}else d3.select(this).append("svg:text").text(function(a){return a.label()}).attr("class","vvvv-node-label").attr("shape-rendering","crispEdges").attr("dy",function(a,b){return 12*b+12}).attr("dx",4).attr("font-size",10).attr("font-family",
"Lucida Sans Unicode")});m=g.selectAll("g.vvvv-input-pin").data(function(a){return a.isSubpatch?_(a.inputPins).sortBy(function(a){return a.slavePin?a.slavePin.node.x:1}).map(function(a,b){return a}):_(a.inputPins).map(function(a,b){return a})}).enter().append("svg:g").attr("class","vvvv-input-pin").attr("transform",function(a,b){pinOffset=0;1<_(a.node.inputPins).size()&&(pinOffset=(a.node.getWidth()-4)/(_(a.node.inputPins).size()-1));a.y=0;a.x=b*pinOffset;return"translate("+a.x+", 0)"});m.append("svg:rect").attr("width",
4).attr("height",4).attr("fill",function(a){return a.node.isComment()?"rgba(0,0,0,0)":"#666666"}).on("mouseover",function(a,b){c.selectAll("#vvvv-node-"+a.node.id+" g.vvvv-input-pin").filter(function(a,c){return c==b}).each(function(){d3.select(this).append("svg:rect").attr("class","vvvv-input-pin-highlight").attr("width",4).attr("height",4).attr("fill","rgba(0,0,0,1)").attr("y",-4);d3.select(this).append("svg:text").text(function(a){return 1<a.getSliceCount()?a.pinname+"("+a.getSliceCount()+"): "+
a.getValue(0):a.pinname+": "+a.getValue(0)}).attr("dy",30).attr("font-size",10).attr("font-family","Lucida Sans Unicode").attr("fill","rgba(0,0,0,1)")})}).on("mouseout",function(a,b){c.selectAll("#vvvv-node-"+a.node.id+" g.vvvv-input-pin text").remove();c.selectAll("#vvvv-node-"+a.node.id+" g.vvvv-input-pin rect.vvvv-input-pin-highlight").remove()});q=g.selectAll("g.vvvv-output-pin").data(function(a){return _(a.outputPins).map(function(a,b){return a})}).enter().append("svg:g").attr("class","vvvv-output-pin").attr("transform",
function(a,b){pinOffset=0;1<_(a.node.outputPins).size()&&(pinOffset=(a.node.getWidth()-4)/(_(a.node.outputPins).size()-1));a.y=a.node.getHeight()-4;a.x=b*pinOffset;return"translate("+a.x+", "+a.y+")"});q.append("svg:rect").attr("width",4).attr("height",4).attr("fill",function(a){return a.node.isComment()?"rgba(0,0,0,0)":"#666666"}).on("mouseover",function(a,b){c.selectAll("#vvvv-node-"+a.node.id+" g.vvvv-output-pin").filter(function(a,c){return c==b}).each(function(){d3.select(this).append("svg:rect").attr("class",
"vvvv-output-pin-highlight").attr("width",4).attr("height",4).attr("fill","rgba(0,0,0,1)").attr("y",-4);d3.select(this).append("svg:text").text(function(a){return 1<a.getSliceCount()?a.pinname+"("+a.getSliceCount()+"): "+a.getValue(0):a.pinname+": "+a.getValue(0)}).attr("dy",30).attr("font-size",10).attr("font-family","Lucida Sans Unicode").attr("fill","rgba(0,0,0,1)")})}).on("mouseout",function(a,b){c.selectAll("#vvvv-node-"+a.node.id+" g.vvvv-output-pin text").remove();c.selectAll("#vvvv-node-"+
a.node.id+" g.vvvv-output-pin rect.vvvv-output-pin-highlight").remove()});k=b.selectAll("g.vvvv-link").data(p.linkList).enter().append("svg:g").attr("class","vvvv-link");k.append("svg:line").attr("stroke","rgba(0, 0, 0, 0)").attr("stroke-width",4).attr("x1",function(a){return a.fromPin.x+a.fromPin.node.x+2+0.5}).attr("y1",function(a){return a.fromPin.y+a.fromPin.node.y+4+0.5}).attr("x2",function(a){return a.toPin.x+a.toPin.node.x+2+0.5}).attr("y2",function(a){return a.toPin.y+a.toPin.node.y+0.5});
k.append("svg:line").attr("stroke","#000").attr("stroke-width",1).attr("x1",function(a){return a.fromPin.x+a.fromPin.node.x+2+0.5}).attr("y1",function(a){return a.fromPin.y+a.fromPin.node.y+4+0.5}).attr("x2",function(a){return a.toPin.x+a.toPin.node.x+2+0.5}).attr("y2",function(a){return a.toPin.y+a.toPin.node.y+0.5});$(".descriptive-name-bg rect",y.window.document).each(function(){$(this,y.window.document).attr("width",$(this,y.window.document).parent().next().get(0).getBBox().width+4)});h||(c.selectAll("g.vvvv-input-pin").on("contextmenu",
function(a,b){if(VVVV.PinTypes[a.typeName].openInputBox&&void 0!=a.getValue(0)){$(".resettable",y.window.document).remove();var c=$("<input type='text'/>");$("body",y.window.document).append(c);c.css("position","absolute");c.css("left",$(this).offset().left);c.css("top",$(this).offset().top-3);c.css("width",50);c.css("height",14);VVVV.PinTypes[a.typeName].openInputBox(y,c,a,0)}d3.event.stopPropagation();d3.event.preventDefault();return!1}),c.selectAll("g.vvvv-input-pin, g.vvvv-output-pin").on("click",
function(b,d){if(y.state!=UIState.Connecting){r=b;y.state=UIState.Connecting;c.append("svg:line").attr("class","vvvv-link current-link resettable").attr("stroke","#000").attr("stroke-width",1).attr("x1",b.x+b.node.x+2+0.5).attr("y1",b.y+b.node.y+2+0.5).attr("x2",b.x+b.node.x+2+0.5).attr("y2",b.y+b.node.y+2+0.5);var f=r.direction==PinDirection.Output?"input":"output",e=r.node.getUpstreamNodes();c.selectAll("g.vvvv-"+f+"-pin").filter(function(a){return a.typeName!=r.typeName&&("Node"!=r.typeName||VVVV.PinTypes[a.typeName].primitive&&
("Node"!=a.typeName||VVVV.PinTypes[r.typeName].primitive))||0<=e.indexOf(a.node)||a.node==r.node?!1:!0}).append("svg:rect").attr("class","vvvv-connection-highlight resettable").attr("width",4).attr("height",3).attr("fill","rgba(0,0,0,1)").attr("y",function(a){return a.direction==PinDirection.Input?-3:3})}else{if(r.direction==PinDirection.Input)var f=b,g=r;else f=r,g=b;if(f.typeName==g.typeName&&f.direction!=g.direction||"Node"==f.typeName&&!VVVV.PinTypes[g.typeName].primitive||"Node"==g.typeName&&
!VVVV.PinTypes[f.typeName].primitive){var h="<PATCH>";_(g.links).each(function(a){h+="<LINK deleteme='pronto' srcnodeid='"+a.fromPin.node.id+"' srcpinname='"+a.fromPin.pinname+"' dstnodeid='"+a.toPin.node.id+"' dstpinname='"+a.toPin.pinname+"'/>"});h+="<LINK createme='pronto' srcnodeid='"+f.node.id+"' srcpinname='"+f.pinname+"' dstnodeid='"+g.node.id+"' dstpinname='"+g.pinname+"'/>";h+="</PATCH>";a.update(p,h);c.select(".vvvv-link.current-link").remove();c.select(".vvvv-connection-highlight").remove();
y.state=UIState.Idle}p.afterUpdate()}d3.event.stopPropagation()}).on("mousedown",function(){d3.event.stopPropagation()}),c.selectAll("g.vvvv-link").on("contextmenu",function(b){a.update(p,"<PATCH><LINK deleteme='pronto' srcnodeid='"+b.fromPin.node.id+"' srcpinname='"+b.fromPin.pinname+"' dstnodeid='"+b.toPin.node.id+"' dstpinname='"+b.toPin.pinname+"'/></PATCH>");d3.event.preventDefault()}),g.on("mousedown",function(b){$(".resettable",y.window.document).remove();y.state=UIState.Moving;0>n.indexOf(b)&&
(t||e(),d3.select(this).attr("class","vvvv-node selected"),n.push(b));f=d3.event.pageX;d=d3.event.pageY;a.inspector&&a.inspector.setNode(b);d3.event.preventDefault();d3.event.stopPropagation();return!1}).on("contextmenu",function(b){b.isSubpatch?a.openPatch(b):b.openUIWindow&&b.openUIWindow();d3.event.preventDefault();d3.event.stopPropagation();return!1}))}};
VVVV.Editors.BrowserEditor.Inspector=function(b){function a(){d=void 0;$(c.win.document).find("#pins, #values").empty();$(c.win.document).find("#pins").append('<div class="row heading">Configuration</div>');$(c.win.document).find("#values").append('<div class="row heading"></div>');_(f.invisiblePins).each(function(a){h(a)});$(c.win.document).find("#pins").append('<div class="row heading">Input Pins</div>');$(c.win.document).find("#values").append('<div class="row heading"></div>');_(f.inputPins).each(function(a){h(a)});
$(c.win.document).find("#pins").append('<div class="row heading">Output Pins</div>');$(c.win.document).find("#values").append('<div class="row heading"></div>');_(f.outputPins).each(function(a){h(a)})}function h(a){var b=$('<a class="row pin" href="#">'+a.pinname+"</a>");$(c.win.document).find("#pins").append(b);b.click(function(b){$(c.win.document).find("a.pin.active").removeClass("active");$(this).addClass("active");VVVV.PinTypes[a.typeName].openInputBox&&e(a);b.preventDefault();return!1});VVVV.PinTypes[a.typeName].openInputBox&&
a.direction!=PinDirection.Output&&!a.isConnected()&&void 0!=a.getValue(0)?(b=$('<div class="row value"><div style="height:100%">'+a.getValue(0)+"</div></div>"),b.find("div").click(function(){VVVV.PinTypes[a.typeName].openInputBox(c.win,$(this),a,0)})):b=$('<div class="row value readonlyvalue"><div style="height:100%">'+a.getValue(0)+"</div></div>");"Color"==a.typeName&&b.find("div").css("background-color","rgba("+_(a.getValue(0).split(",")).map(function(a){return parseInt(255*a)}).join(",")+")");
$(c.win.document).find("#values").append(b)}function e(a){var b=d!=a;d=a;var f=a.getSliceCount(),e=$('<div class="row heading"><input type="text" value="'+f+'"/ size="3"/> Slices</div>');a.direction!=PinDirection.Input&&e.find("input").attr("disabled",!0);var h=$(c.win.document).find("#values .row").first();0<h.length?h.replaceWith(e):$(c.win.document).find("#values").append(e);e.find("input").change(function(a){for(var b=Math.max(1,parseInt($(this).val())),c=d.getSliceCount();c<b;c++)d.setValue(c,
VVVV.PinTypes[d.typeName].defaultValue());d.setSliceCount(b);d.node.parentPatch.afterUpdate();a.preventDefault();return!1});for(e=e=0;e<f;e++)if(h=$(c.win.document).find("#values .row").eq(e+1),b||!h.children().first().hasClass("pininputbox")){if(VVVV.PinTypes[a.typeName].openInputBox&&a.direction!=PinDirection.Output&&!a.isConnected()&&void 0!=a.getValue(0)){var n=$('<div class="row value"><div style="height:100%">'+a.getValue(e)+"</div></div>");(function(b){n.find("div").click(function(){VVVV.PinTypes[a.typeName].openInputBox(c.win,
$(this),a,b)})})(e)}else n=$('<div class="row value readonlyvalue"><div style="height:100%">'+a.getValue(e)+"</div></div>");0<h.length?h.replaceWith(n):$(c.win.document).find("#values").append(n);"Color"==a.typeName&&n.find("div").css("background-color","rgba("+_(a.getValue(e).split(",")).map(function(a){return parseInt(255*a)}).join(",")+")")}e++;for(h=$(c.win.document).find("#values .row");e<h.length;e++)h.eq(e).remove()}this.win=window.open(b+"/inspektor.html","inspektor","location=no, width=250, height=600, toolbar=no");
var f,d;insw=this.win;var c=this;this.update=function(){f&&(d?e(d):a())};this.setNode=function(b){f=b;a()};this.close=function(){this.win.close()}};
VVVV.Editors.BrowserEditor.Interface=function(){function b(){return"Are you sure you want to leave? Unsaved changes in your patches will be lost."}var a=[],h={};this.inspector=void 0;this.enable=function(f,d){d=d||{};this.addPatch(f);this.openPatch(f,d.selector);if(!d.selector){var c=this;$(window).bind("beforeunload",b);$(window).unload(function(){c.disable()});this.openInspector(VVVV.Root);a[0].window?d&&d.success&&d.success():d&&d.error&&d.error()}};this.openInspector=function(a,b){if(!this.inspector){this.inspector=
new VVVV.Editors.BrowserEditor.Inspector(a);var c=this;$(this.inspector.win).bind("beforeunload",function(){console.log("closing inspektor");c.inspector=void 0})}};var e=[];this.addPatch=function(a){for(var b=a.id,c=a;void 0!=(c=c.parentPatch);)b+="-"+c.id;if(!(0<=e.indexOf(b)))for(e.push(b),a.editor=this,b=VVVV.Helpers.prepareFilePath(a.nodename,a.parentPatch),void 0==h[b]&&(h[b]=[]),h[b].push(a),a=a.getSubPatches(),b=0;b<a.length;b++)this.addPatch(a[b])};this.removePatch=function(a){for(var b=a.getSubPatches(),
c=0;c<b.length;c++)this.removePatch(b[c]);b=VVVV.Helpers.prepareFilePath(a.nodename,a.parentPatch);h[b].splice(h[b].indexOf(a),1);0==h[b].length&&delete h[b];console.log(h)};this.openPatch=function(b,d){a.push(new VVVV.Editors.BrowserEditor.PatchWindow(b,this,d))};this.update=function(a,b){for(var c=VVVV.Helpers.prepareFilePath(a.nodename,a.parentPatch),e=h[c].length,m=0;m<e;m++)h[c][m].doLoad(b),h[c][m].afterUpdate()};this.disable=function(){for(var e=0;e<a.length;e++)a[e].close();this.inspector&&
this.inspector.close();$(window).unbind("beforeunload",b)};this.save=function(a,b){var c=$("<a>save</a>");$("body").append(c);c.attr("href","data:application/octet-stream;charset=utf-8,"+encodeURIComponent(b));c.attr("download",a);c[0].click();c.remove()};this.sendUndo=function(){}};VVVV.VVVViewer=function(b,a){(new VVVV.Editors.BrowserEditor.Interface).enable(b,{selector:a})};VVVV.Editors.edit=VVVV.Editors.BrowserEditor.Interface;VVVV.Themes=VVVV.Themes||{};
VVVV.Themes.Tron={scaleX:1.2,scaleY:1.8,categoryColors:{Value:"#78B4A8",Animation:"#51de3a","3d":"#78B4A8",Boolean:"#78B4A8",Complex:"#78B4A8","2d":"#78B4A8",Spreads:"#78B4A8",String:"#d54c70",EX9:"#d6bf00",Canvas:"#d6bf00",HTML5:"#d6bf00",Transform:"#ba4b36","default":"#AAAAAA"},chart:function(b){},background:function(b){b.attr("fill","#666666")},node:function(b){b.attr("x",-1).attr("width",function(a){return a.getWidth()*VVVV.Themes.Tron.scaleX+2}).attr("rx",1).attr("ry",1).attr("stroke","rgba(127, 190, 183, 1.0)").attr("stroke-width",
1).attr("fill",function(a){return a.isComment()?"rgba(0,0,0,0)":a.not_implemented?"rgba(255,0,0,1)":"rgba(127, 190, 183, 0.6)"})},inputPinBar:function(b){b.attr("height",2).attr("fill","rgba(0,0,0,0)")},outputPinBar:function(b){b.attr("y",function(a){return a.getHeight()*VVVV.Theme.scaleY-2}).attr("height",2).attr("fill","rgba(0,0,0,0)")},descriptiveNameText:function(b){b.attr("shape-rendering","crispEdges").attr("dy",function(a){return a.getHeight()*VVVV.Theme.scaleY+12}).attr("dx",2).attr("font-size",
10).attr("font-family","Lucida Sans Unicode").attr("fill","white")},descriptiveNameBackground:function(b){b.attr("fill",function(a){return void 0==a.invisiblePins["Descriptive Name"]||""==a.invisiblePins["Descriptive Name"].getValue(0)?"rgba(0,0,0,0)":"rgba(0,0,0,1)"}).attr("y",function(a){return a.getHeight()*VVVV.Theme.scaleY}).attr("width",5).attr("height",14)},nodeLabel:function(b){b.attr("fill","white").attr("shape-rendering","crispEdges").attr("dy",function(a,b){return 18*b+19}).attr("dx",4).attr("font-size",
11).attr("font-family","Lucida Sans Unicode")},inputPin:function(b){b.attr("y",-2.5).attr("x",0.5).attr("width",4).attr("height",4).attr("fill",function(a){return a.node.isComment()?"rgba(0,0,0,0)":"white"}).attr("stroke","#666").attr("stroke-width",1)},inputPinHover:function(b){b.attr("width",4).attr("height",4).attr("fill","rgba(0,0,0,1)").attr("y",-6)},inputPinValue:function(b){b.attr("dy",30).attr("font-size",10).attr("font-family","Lucida Sans Unicode").attr("fill","rgba(1,1,1,1)")},outputPin:function(b){b.attr("y",
2.5).attr("x",0.5).attr("width",4).attr("height",4).attr("fill",function(a){return a.node.isComment()?"rgba(0,0,0,0)":"white"}).attr("stroke","#666").attr("stroke-width",1)},outputPinHover:function(b){b.attr("width",4).attr("height",4).attr("fill","rgba(1,1,1,1)").attr("y",6)},outputPinValue:function(b){b.attr("dy",30).attr("font-size",10).attr("font-family","Lucida Sans Unicode").attr("fill","rgba(1,1,1,1)")},connectablePin:function(b){b.attr("width",4).attr("height",3).attr("fill","rgba(1,1,1,1)").attr("y",
function(a){return a.direction==PinDirection.Input?-3:3})},link:function(b){b.append("svg:path").attr("stroke","rgba(0, 0, 0, 0)").attr("fill","rgba(0,0,0,0)").attr("stroke-width",4).attr("d",function(a){var b=(a.toPin.node.y-a.fromPin.node.y-a.fromPin.node.getHeight())*VVVV.Theme.scaleY/5;0>b&&(b=30);return"M"+(a.fromPin.x+a.fromPin.node.x*VVVV.Theme.scaleX+2+0.5)+","+(a.fromPin.y+a.fromPin.node.y*VVVV.Theme.scaleY+4+0.5)+" C"+(a.fromPin.x+a.fromPin.node.x*VVVV.Theme.scaleX+2+0.5)+","+(a.fromPin.y+
a.fromPin.node.y*VVVV.Theme.scaleY+4+b)+" "+(a.toPin.x+a.toPin.node.x*VVVV.Theme.scaleX+2+0.5)+","+(a.toPin.y+a.toPin.node.y*VVVV.Theme.scaleY-b)+" "+(a.toPin.x+a.toPin.node.x*VVVV.Theme.scaleX+2+0.5)+","+(a.toPin.y+a.toPin.node.y*VVVV.Theme.scaleY+0.5)});b.append("svg:path").attr("stroke","#FFF").attr("fill","rgba(0,0,0,0)").attr("stroke-width",0.5).attr("d",function(a){var b=(a.toPin.node.y-a.fromPin.node.y-a.fromPin.node.getHeight())*VVVV.Theme.scaleY/5;0>b&&(b=30);return"M"+(a.fromPin.x+a.fromPin.node.x*
VVVV.Theme.scaleX+2+0.5)+","+(a.fromPin.y+a.fromPin.node.y*VVVV.Theme.scaleY+4+0.5)+" C"+(a.fromPin.x+a.fromPin.node.x*VVVV.Theme.scaleX+2+0.5)+","+(a.fromPin.y+a.fromPin.node.y*VVVV.Theme.scaleY+4+b)+" "+(a.toPin.x+a.toPin.node.x*VVVV.Theme.scaleX+2+0.5)+","+(a.toPin.y+a.toPin.node.y*VVVV.Theme.scaleY-b)+" "+(a.toPin.x+a.toPin.node.x*VVVV.Theme.scaleX+2+0.5)+","+(a.toPin.y+a.toPin.node.y*VVVV.Theme.scaleY+0.5)})},currentLink:function(b){b.attr("stroke","#FFF").attr("stroke-width",1)}};
VVVV.Theme=VVVV.Themes.Tron;
